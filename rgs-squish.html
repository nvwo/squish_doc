<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- Mirrored from rgs-squish.html by HTTrack Website Copier/3.x [XR&CO'2013], Wed, 06 Jul 2022 13:29:00 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>6.3. Squish API</title><link rel="stylesheet" href="manual.css" type="text/css"></link><meta name="generator" content="DocBook XSL Stylesheets V1.73.2"></meta><link rel="start" href="index-noframes.html" title="Squish Manual"></link><link rel="up" href="api.man.html" title="Chapter 6. API Reference Manual"></link><link rel="prev" href="rgs-scripteq.html" title="6.2. Equivalent Script API"></link><link rel="next" href="rgs-qtconvenience.html" title="6.4. Qt Convenience API"></link><style xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" type="text/css" media="screen">
        div.toc * { margin-left: 6px; margin-right: auto; max-width: 75em; }
        div.toc span { margin-left: 0px; }
        * { margin-left: auto; margin-right: auto; max-width: 75em; }
        body { margin-left: 6px; margin-right: 6px; }
        table th { padding: .5ex }
        table td { padding: .5ex }
    </style><script xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format">
        function keyPress() {
            var e = window.event;
            if ( e == undefined ) {
                return;
            }
            /* ### does not properly scroll, yet
            if ( e.keyCode == 32 ) {
            var l = document.links;
            for ( var i = 0; i < l.length; i++ ) {
                if ( l[i].innerText == "Next" ) {
                location.href = l[i].href;
                }
            }
            } else
                */
                if ( e.keyCode == 0x08 ) {
            var l = document.links;
            for ( var i = 0; i < l.length; i++ ) {
                if ( l[i].innerText == "Prev" ) {
                location.href = l[i].href;
                }
            }
            }
        }
        document.onkeypress = keyPress;
    </script></head><body><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="rgs-squish"></a>6.3. Squish API</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="rgs-squish.html#rgss-cfp">6.3.1. Constructors, Functions and Properties</a></span></dt><dt><span class="section"><a href="rgs-squish.html#api.functions-and-properties">6.3.2. Functions and Properties (macOS)</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-objh">6.3.3. Object Access Functions</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-sync-funcs">6.3.4. Synchronization Functions</a></span></dt><dt><span class="section"><a href="rgs-squish.html#interaction.functions">6.3.5. Interaction Functions</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-debugging">6.3.6. Debugging Functions</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-conversions">6.3.7. Conversion Functions</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-teststatements">6.3.8. Verification Functions</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-createvvp">6.3.9. Script-based Creation of Visual Verification Points</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-testdata">6.3.10. Test Data Functions</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-objmap">6.3.11. Object Map Functions</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-appcontext">6.3.12. Application Context</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-image-object">6.3.13. <code class="code">QImage</code> Object</a></span></dt><dt><span class="section"><a href="rgs-squish.html#script-image-object">6.3.14. Image Object</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-screen-object">6.3.15. <code class="code">Screen</code> Object</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-toplevelwindow-object">6.3.16. <code class="code">ToplevelWindow</code> Object</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-info">6.3.17. <code class="code">squishinfo</code> Object</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgs-testinteraction">6.3.18. <code class="code">testInteraction</code> Functions</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgs-testsettings">6.3.19. <code class="code">testSettings</code> Object</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgs-remotesystem">6.3.20. <code class="code">RemoteSystem</code> Object</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rg-user.interface.types">6.3.21. User Interface Types</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-misc">6.3.22. Miscellaneous Functions</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-misc-low-level">6.3.23. Low-Level Functions</a></span></dt></dl></div><p>
This section introduces the APIs that <span class="emphasis"><em>Squish</em></span> provides in addition to
the standard features of the scripting languages it supports. The
<span class="emphasis"><em>Squish</em></span> APIs provide the facilities that test engineers need to test
GUI applications, and offer a wide range of functionality, from
interacting with AUT objects, to recording information in test logs,
performing verifications, controlling the AUT, and more.
</p><p>
Here are some quick links to the Squish API functions (not including the
Squish objects or the toolkit-specific convenience functions):
</p><div class="informaltable"><table border="0"><colgroup><col></col><col></col><col></col></colgroup><tbody><tr valign="top"><td valign="top">
<div class="itemizedlist"><ul type="disc" compact><li><p><a class="xref" href="rgs-squish.html#QImage.save-function"><code class="function">QImage.save</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext-function"><code class="function">applicationContext</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContextList-function"><code class="function">applicationContextList</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#attachToApplication-function"><code class="function">attachToApplication</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#cast-function"><code class="function">cast</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#className-function"><code class="function">className</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#createVisualVP-function"><code class="function">createVisualVP</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#currentApplicationContext-function"><code class="function">currentApplicationContext</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#defaultApplicationContext-function"><code class="function">defaultApplicationContext</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#doubleClick-function"><code class="function">doubleClick</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#findAllOcrText-function"><code class="function">findAllOcrText</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#findFile-function"><code class="function">findFile</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#findImage-function"><code class="function">findImage</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#findObject-function"><code class="function">findObject</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#findOcrText-function"><code class="function">findOcrText</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#findAllObjects-function"><code class="function">findAllObjects</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#getClipboardText-function"><code class="function">getClipboardText</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#getOcrText-function"><code class="function">getOcrText</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#highlightObject-function"><code class="function">highlightObject</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#isNull-function"><code class="function">isNull</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#keyPress-function"><code class="function">keyPress</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#keyRelease-function"><code class="function">keyRelease</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#mouseClick-function"><code class="function">mouseClick</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#mouseMove-function"><code class="function">mouseMove</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#mousePress-function"><code class="function">mousePress</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#mouseRelease-function"><code class="function">mouseRelease</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#nativeMouseClick-function"><code class="function">nativeMouseClick</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#nativeType-function"><code class="function">nativeType</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#object.children-function"><code class="function">object.children</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#object.convertTo-function"><code class="function">object.convertTo</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#object.createNull-function"><code class="function">object.createNull</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#object.exists-function"><code class="function">object.exists</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#object.globalBounds-function"><code class="function">object.globalBounds</code></a></p></li></ul></div>
</td><td valign="top">
<div class="itemizedlist"><ul type="disc" compact><li><p><a class="xref" href="rgs-squish.html#object.grabScreenshot-function"><code class="function">object.grabScreenshot</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#object.parent-function"><code class="function">object.parent</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#object.properties-function"><code class="function">object.properties</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#object.topLevelObjects-function"><code class="function">object.topLevelObjects</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#objectMap.add-function"><code class="function">objectMap.add</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#objectMap.load-function"><code class="function">objectMap.load</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#objectMap.realName-function"><code class="function">objectMap.realName</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#objectMap.symbolicName-function"><code class="function">objectMap.symbolicName</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#objectMap.symbolicNames-function"><code class="function">objectMap.symbolicNames</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#saveDesktopScreenshot-function"><code class="function">saveDesktopScreenshot</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#saveObjectSnapshot-function"><code class="function">saveObjectSnapshot</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#sendNativeEvent-function"><code class="function">sendNativeEvent</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#setApplicationContext-function"><code class="function">setApplicationContext</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#setClipboardText-function"><code class="function">setClipboardText</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#snooze-function"><code class="function">snooze</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#source-function"><code class="function">source</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#startApplication-function"><code class="function">startApplication</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#tapObject-function"><code class="function">tapObject</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.attachFile-function"><code class="function">test.attachFile</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.breakpoint-function"><code class="function">test.breakpoint</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.compare-function"><code class="function">test.compare</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.compareTextFiles-function"><code class="function">test.compareTextFiles</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.compareXMLFiles-function"><code class="function">test.compareXMLFiles</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.compareJSONFiles-function"><code class="function">test.compareJSONFiles</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.endSection-function"><code class="function">test.endSection</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.exception-function"><code class="function">test.exception</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.fail-function"><code class="function">test.fail</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.imagePresent-function"><code class="function">test.imagePresent</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.fatal-function"><code class="function">test.fatal</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.fixateResultContext-function"><code class="function">test.fixateResultContext</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.log-function"><code class="function">test.log</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.ocrTextPresent-function"><code class="function">test.ocrTextPresent</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.pass-function"><code class="function">test.pass</code></a></p></li></ul></div>
</td><td valign="top">
<div class="itemizedlist"><ul type="disc" compact><li><p><a class="xref" href="rgs-squish.html#test.restoreResultContext-function"><code class="function">test.restoreResultContext</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.resultCount-function"><code class="function">test.resultCount</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.skip-function"><code class="function">test.skip</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.stackTrace-function"><code class="function">test.stackTrace</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.startSection-function"><code class="function">test.startSection</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.startVideoCapture-function"><code class="function">test.startVideoCapture</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.stopVideoCapture-function"><code class="function">test.stopVideoCapture</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.verify-function"><code class="function">test.verify</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.vp-function"><code class="function">test.vp</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.xvp-function"><code class="function">test.xvp</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.vpWithObject-function"><code class="function">test.vpWithObject</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.warning-function"><code class="function">test.warning</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.xcompare-function"><code class="function">test.xcompare</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.xfail-function"><code class="function">test.xfail</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.xpass-function"><code class="function">test.xpass</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#test.xverify-function"><code class="function">test.xverify</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#testData.create-function"><code class="function">testData.create</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#testData.dataset-function"><code class="function">testData.dataset</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#testData.datasetExcel-function"><code class="function">testData.datasetExcel</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#testData.exists-function"><code class="function">testData.exists</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#testData.field-function"><code class="function">testData.field</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#testData.fieldNames-function"><code class="function">testData.fieldNames</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#testData.get-function"><code class="function">testData.get</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#testData.put-function"><code class="function">testData.put</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#testData.remove-function"><code class="function">testData.remove</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#typeName-function"><code class="function">typeName</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#waitFor-function"><code class="function">waitFor</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#waitForApplicationLaunch-function"><code class="function">waitForApplicationLaunch</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#waitForImage-function"><code class="function">waitForImage</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#waitForObjectExists-function"><code class="function">waitForObjectExists</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#waitForObjectItem-function"><code class="function">waitForObjectItem</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#waitForOcrText-function"><code class="function">waitForOcrText</code></a></p></li></ul></div>
</td></tr></tbody></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Squish API Function Parameters"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"><a id="squishapi.function.parameters"></a><span class="emphasis"><em>Squish</em></span> API Function Parameters</th></tr><tr><td align="left" valign="top"><p>
For all of the <span class="emphasis"><em>Squish</em></span> API functions that take an
<em class="parameter"><code>objectOrName</code></em> argument, this argument can be a
reference to an object or the name of an object.
</p></td></tr></table></div><p>
Some of the <span class="emphasis"><em>Squish</em></span> API functions can take a
<em class="parameter"><code>modifierState</code></em> argument which indicates which
special keys are pressed at the time of a mouse click. And some of the
functions can also take a <em class="parameter"><code>mouseButton</code></em> argument
which indicates which mouse button was clicked.
</p><p>
The <em class="parameter"><code>modifierState</code></em> can be 0 (<code class="code">Modifier.None</code>,
the default), or the following:
<code class="code">Modifier.Alt</code>,
<code class="code">Modifier.Control</code>,
<code class="code">Modifier.Shift</code>.
If more than one modifier is used, they must be
<code class="code">OR</code>-d together, for example,
<code class="code">Modifier.Alt|Modifier.Shift</code>. The form shown here works for
Python and JavaScript. For Perl and Ruby replace the period with two
colons, e.g., <code class="code">Modifier::Control</code>, and for Tcl use the
<code class="code">enum</code> function, e.g., <code class="code">enum Modifier Control</code>.
</p><p>
The <em class="parameter"><code>mouseButton</code></em> can be any one of:
<code class="code">MouseButton.LeftButton</code>,
<code class="code">MouseButton.MiddleButton</code>,
<code class="code">MouseButton.RightButton</code>.
</p><p>
For Perl use this: <code class="code">MouseButton::LeftButton</code>, etc.
</p><p>
For Ruby use this: <code class="code">MouseButton::LEFT_BUTTON</code>, etc.
</p><p>
For Tcl use this: <code class="code">enum MouseButton LeftButton</code>, etc.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>
Windows test suites also support two more possible mouse button specifiers,
<code class="code">MouseButton.PrimaryButton</code> and
<code class="code">MouseButton.SecondaryButton</code>. These values respect the global
Windows setting which can be use to swap the mouse buttons. If the buttons are
not swapped (the default), the left button is the primary button. Otherwise,
the right button is the primary button.
</p></td></tr></table></div><p>
Many of the APIs' functions apply to particular objects, so being able
to identify the object of interest is particularly important.
</p><p>
<span class="emphasis"><em>Squish</em></span> provides several naming schemes, but the ones normally used are
symbolic names and real names. Symbolic names are the most robust in the
face of AUT changes, but real names can sometimes be more convenient to
use. See <a class="xref" href="ug-accessing-objects.html" title="5.1. How to Identify and Access Objects">How to Identify and Access Objects (Section 5.1)</a> for more about names.
</p><p>
For Qt programs the easiest and most reliable way of identifying an
object in code is to set an object name in C++ for all the objects of
interest (using the <a class="ulink" href="https://doc.qt.io/qt-5/qobject.html#objectName-prop" target="_blank">
QObject::setObjectName</a> method), and then in test scripts use a
real (multi-property) name specifying the object's
<code class="code">objectName</code> and its <code class="code">type</code>. For example:
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
textEdit = findObject("{objectName='ConfigEditor' type='QTextEdit'}")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var textEdit = findObject("{objectName='ConfigEditor' type='QTextEdit'}");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
my $textEdit = findObject("{objectName='ConfigEditor' type='QTextEdit'}");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
textEdit = findObject("{objectName='ConfigEditor' type='QTextEdit'}")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set textEdit [findObject "{objectName='ConfigEditor' type='QTextEdit'}"]
</pre></div><p>
In practice it would be tedious to give every single widget a unique
object name (and currently only Qt supports it), so this approach is
most often used when there are two or more identical widgets in the same
form. For those toolkits that don't have object names we can use
introspection when there are two or more identical widgets. (Examples of
both approaches are given in the <a class="xref" href="users-guide.html" title="Chapter 5. User Guide">User Guide (Chapter 5)</a>.)
</p><p>
The most common situation is where we need to identify unnamed objects.
This can be done using symbolic names or by matching an object's unique
set of property values. The necessary information can be obtained using
the <span class="application">Spy</span> tool (<a class="xref" href="ug-editdebug.html#uged-spy" title="5.21.3. How to Use the Spy">How to Use the Spy (Section 5.21.3)</a>). This tool can provide an
object's symbolic name and its property-based (real) name. Another
approach is to create a dummy test, interact with the objects of
interest and then look in <span class="emphasis"><em>Squish</em></span>'s object map to see the names that
<span class="emphasis"><em>Squish</em></span> uses, and copy any that are needed.
</p><p>
Here's an example that shows both approaches for finding an unnamed
object of type <code class="code">QTextEdit</code>. The object is in a
<code class="code">QMainWindow</code> whose title is "My App":
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# symbolic name
textEdit = waitForObject(":MyApp_QTextEdit")
# real (multi-property) name
textEdit = waitForObject("{type='QTextEdit' unnamed='1' " +
        "visible='1' window=':MyApp_MainWindow'}")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// symbolic name
var textEdit = waitForObject(":MyApp_QTextEdit");
// real (multi-property) name
var textEdit = waitForObject("{type='QTextEdit' unnamed='1' " +
        "visible='1' window=':MyApp_MainWindow'}");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# symbolic name
my $textEdit = waitForObject(":MyApp_QTextEdit");
# real (multi-property) name
my $textEdit = waitForObject("{type='QTextEdit' unnamed='1' " .
        "visible='1' window=':MyApp_MainWindow'}");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# symbolic name
textEdit = waitForObject(":MyApp_QTextEdit")
# real (multi-property) name
textEdit = waitForObject("{type='QTextEdit' unnamed='1' " +
        "visible='1' window=':MyApp_MainWindow'}")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# symbolic name
set textEdit [waitForObject ":MyApp_QTextEdit"]
# real (multi-property) name
set textEdit [waitForObject "{type='QTextEdit' unnamed='1' \
        visible='1' window=':MyApp_MainWindow'}"]
</pre></div><p>
The <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a> function waits for the
identified object to be ready (visible and enabled) and then returns a
reference to it.
</p><p>
On the whole it is best to use symbolic names since they are more robust
in the face of AUT changes, since they only require us to update the <a class="xref" href="rg-objectmap.html" title="7.11. Object Map">Object Map (Section 7.11)</a> rather than our test script code if an object's
properties change. (Note that for most GUI toolkits the
<code class="code">type</code> property is mandatory when using real names.)
</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-cfp"></a>6.3.1. Constructors, Functions and Properties</h3></div></div></div><p>
<span class="emphasis"><em>Squish</em></span> objects blend in seamlessly with the scripting language's
native objects. This means that you can use standard language features
to construct objects of the wrapped types, invoke member functions, and
get, set, and iterate over properties on these objects.
</p><p>
Here are some simple examples; many more examples are shown in
the <a class="xref" href="users-guide.html" title="Chapter 5. User Guide">User Guide (Chapter 5)</a>.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# create an object of type QPoint
point = QPoint(10, 20)

# read a widget's width property
width = widget.width

# set widget's y-coordinate property
widget.y = 240

# call a member function
widget.setWindowTitle("My Widget")

# call a static function
QApplication.setOverrideCursor(Qt.WaitCursor)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// create an object of type QPoint
var point = new QPoint(10, 20);

// read a widget's width property
var width = widget.width;

// set widget's y-coordinate property
widget.y = 240;

// call a member function
widget.setWindowTitle("My Widget");

// call a static function
QApplication.setOverrideCursor(Qt.WaitCursor);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# create an object of type QPoint
my $point = new QPoint(10, 20);

# read a widget's width property
my $width = widget-&gt;width;

# set widget's y-coordinate property
$widget-&gt;y(240);

# call a member function
$widget-&gt;setWindowTitle("My Widget");

# call a static function
QApplication::setOverrideCursor(Qt::WaitCursor);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# create an object of type QPoint
point = QPoint.new(10, 20)

# read a widget's width property
width = widget.width

# set widget's y-coordinate property
widget.y = 240

# call a member function
widget.setWindowTitle("My Widget")

# call a static function
QApplication.setOverrideCursor(Qt::WAIT_CURSOR)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# create an object of type QPoint
set point [construct QPoint 10 20]

# read a widget's width property
set width [property get $widget width]

# set widget's y-coordinate property
property set $widget y 240

# call a member function
invoke $widget setWindowTitle "My Widget"

# call a static function
invoke QApplication setOverrideCursor [enum Qt WaitCursor]
</pre></div><p>
For Tcl we must use the <code class="code">enum</code> function to get enum values.
(See <a class="xref" href="rgs-tcl.html" title="6.15. Tcl Notes">Tcl Notes (Section 6.15)</a>.)
</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="api.functions-and-properties"></a>6.3.2. Functions and Properties (macOS)</h3></div></div></div><p>
The function names in the scripting language API use the following
convention: each colon (<span class="type">:</span>) in the selector name is replaced
by an underscore (<span class="type">_</span>). So, for example, the
<code class="code">+stringWithCString:encoding:</code> selector becomes the script
function <code class="code">stringWithCString_encoding_</code> (note the underscore
at the end of the function).
</p><p>
Here are some examples to illustrate the usage.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# create an object of type NSString and initialize it with a value
s = NSString.stringWithUTF8String_("Ambient")

# read an object's intValue property
n = acontrol.intValue

# set an object's intValue property
acontrol.intValue = 33

# call an instance method
s.characterAtIndex_(1)

# call a class method
s = NSString.stringWithCString_encoding_("Zenith", 4)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// create an object of type NSString and initialize it with a value
var s = NSString.stringWithUTF8String_("Ambient");

// read an object's intValue property
var n = acontrol.intValue;

// set an object's intValue property
acontrol.intValue = 33;

// call an instance method
s.characterAtIndex_(1);

// call a class method
s = NSString.stringWithCString_encoding_("Zenith", 4);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# create an object of type NSString and initialize it with a value
my $s = NSString::stringWithUTF8String_("Ambient");

# read an object's intValue property
my $n = $acontrol-&gt;intValue;

# set an object's intValue property
$acontrol-&gt;intValue(33);

# call an instance method
$s-&gt;characterAtIndex_(1);

# call a class method
$s = NSString::stringWithCString_encoding_("Zenith", 4);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# create an object of type NSString and initialize it with a value
s = NSString.stringWithUTF8String_("Ambient");

# read an object's intValue property
n = acontrol.intValue

# set an object's intValue property
acontrol.intValue = 33

# call an instance method
s.characterAtIndex_(1)

# call a class method
s = NSString.stringWithCString_encoding_("Zenith", 4)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# create an object of type NSString and initialize it with a value
set s [invoke NSString stringWithUTF8String_ "Ambient"]

# read an object's intValue property
set n [property get $acontrol intValue]

# set an object's intValue property
property set $acontrol intValue 33

# call an instance method
invoke $s characterAtIndex_ 1

# call a class method
set s [invoke NSString stringWithCString_encoding_ "Zenith" 4]
</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-objh"></a>6.3.3. Object Access Functions</h3></div></div></div><div class="funcsynopsis"><a id="findObject-function"></a><p><code class="funcdef">Object <b class="fsfunc">findObject</b>(</code><var class="pdparam">objectName</var><code>)</code>;</p></div><p>
This function finds and returns (a reference to) the object identified
by the symbolic or real (multi-property) name
<em class="parameter"><code>objectName</code></em> or raises a <code class="code">LookupError</code>
exception if no such object can be found. The given name can also be a native
script dictionary (resp. hash) value. This function is best used for
non-visible objects. For visible objects it is much better to use the
<a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a> function instead.
</p><div class="funcsynopsis"><a id="findAllObjects-function"></a><p><code class="funcdef">SequenceOfObjects <b class="fsfunc">findAllObjects</b>(</code><var class="pdparam">objectName</var><code>)</code>;</p></div><p>
This function finds and returns a list of object references identified
by the symbolic or real (multi-property) name <em class="parameter"><code>objectName</code></em>.
Because it can return multiple object references, the name must not contain the
occurrence property. The given name can also be a native script dictionary
(resp. hash) value.
</p><div class="funcsynopsis"><a id="object.children-function"></a><p><code class="funcdef">SequenceOfObjects <b class="fsfunc">object.children</b>(</code><var class="pdparam">object</var><code>)</code>;</p></div><p>
This function takes an <em class="parameter"><code>object</code></em> reference (as
returned by the <a class="xref" href="rgs-squish.html#findObject-function"><code class="function">findObject</code></a> function or by
the <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a> function), and returns a
list of the <em class="parameter"><code>object</code></em>'s child objects. The return type
is scripting language-specific, e.g., a tuple in Python, and an array in
the other languages. Examples are given below.
</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning:  Order/contents of child-list is fragile! "><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png"></img></td><th align="left"> Order/contents of child-list is fragile! </th></tr><tr><td align="left" valign="top"><p> Test Cases that rely on the order of the children encountered
in this list, may find that the order changes (or even possibly, new children
appear in the list) due to many different factors, such as:
</p><div class="itemizedlist"><ul type="disc"><li><p> Enhancements to <span class="emphasis"><em>Squish</em></span> </p></li><li><p> Updates to the toolkit libraries </p></li><li><p> Changes in the AUT </p></li></ul></div><p>
</p></td></tr></table></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
obj = waitForObject(":MyWidget")
children = object.children(obj)
# iterate over tuple
for child in children:
    ...
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var obj = waitForObject(":MyWidget");
var children = object.children(obj);
// iterate over array
for (var i = 0; i &lt; children.length; ++i) {
    var child = children[i];
    ...
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
my $obj = waitForObject(":MyWidget");
my @children = object::children($obj);
# iterate over array
foreach $child (@children) {
    ...
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
obj = waitForObject(":MyWidget")
children = Squish::Object.children(obj)
# iterate over array
for child in children
    # ...
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set obj [waitForObject ":MyWidget"]
set children [object children $obj]
foreach child $children {
    ...
}
</pre></div><div class="funcsynopsis"><a id="object.convertTo-function"></a><p><code class="funcdef">Object <b class="fsfunc">object.convertTo</b>(</code><var class="pdparam">object</var>, <var class="pdparam">typeName</var><code>)</code>;</p></div><p>
This function converts the given <em class="parameter"><code>object</code></em> to an
object of the type specified by the <em class="parameter"><code>typeName</code></em>
string. (A suitable object can be obtained using the <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a> function or the <a class="xref" href="rgs-squish.html#findObject-function"><code class="function">findObject</code></a> function.) For example:
</p><pre class="programlisting">
font = object.convertTo(variant, "QFont")
</pre><p>
In this example, if <code class="code">variant</code> is a variable of type
<code class="code">QVariant</code> and it holds a <code class="code">QFont</code> object, the
underlying <code class="code">QFont</code> object will be returned. If the
<em class="parameter"><code>object</code></em> is invalid or null or if the
<em class="parameter"><code>typeName</code></em> is unrecognized or if the conversion
isn't possible (e.g., <code class="code">QFont</code> to <code class="code">int</code>), a
catchable exception will be raised.
</p><p>
This function can also do other kinds of conversions, e.g.,
<code class="code">int</code> to <code class="code">String</code>. See also, the <a class="xref" href="rgs-squish.html#cast-function"><code class="function">cast</code></a> function which can be used for downcasting
(which <code class="code">object.convertTo</code> cannot do).
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note:  Note for Qt5 Users "><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"><a id="object.convertTo-qt5-note"></a> Note for Qt5 Users </th></tr><tr><td align="left" valign="top"><p>In Qt5, Squish can extract pointers to custom
<code class="classname">QObject</code>-derived classes from
<code class="classname">QVariant</code> and cast them to the correct type - provided the
custom class is registered with <a class="ulink" href="https://doc.qt.io/qt-5/qmetatype.html#qRegisterMetaType" target="_blank">QMetaType</a>.
The "magic" is to not
<code class="code">object.convertTo(myVariant, "CustomClassName")</code> as the above
example suggests (which is valid for other cases), but instead to use
<code class="code">object.convertTo(myVariant, "QObject")</code>.
</p></td></tr></table></div><div class="funcsynopsis"><a id="object.createNull-function"></a><p><code class="funcdef">Object <b class="fsfunc">object.createNull</b>(</code><var class="pdparam">type</var><code>)</code>;</p></div><p>
This function creates a null pointer or object with the specified
<em class="parameter"><code>type</code></em> as type.
</p><pre class="programlisting">
widget = object.createNull(QWidget)
</pre><div class="funcsynopsis"><a id="object.exists-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">object.exists</b>(</code><var class="pdparam">objectName</var><code>)</code>;</p></div><p>
This function returns a true value if the object with the symbolic or
real (multi-property) name <em class="parameter"><code>objectName</code></em> exists;
otherwise it returns a false value. The given name can also be a native script
dictionary (resp. hash) value.
</p><p>
If you know that a particular object exists and you just want to access
it (for example, to examine its properties or to perform an action on it
or with it), then use the <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a>
function if the object is visible; or use the <a class="xref" href="rgs-squish.html#findObject-function"><code class="function">findObject</code></a> function if the object is hidden.
</p><div class="funcsynopsis"><a id="object.parent-function"></a><p><code class="funcdef">Object <b class="fsfunc">object.parent</b>(</code><var class="pdparam">object</var><code>)</code>;</p></div><p>
This function takes an <em class="parameter"><code>object</code></em> reference (as
returned by the <a class="xref" href="rgs-squish.html#findObject-function"><code class="function">findObject</code></a> function or by
the <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a> function), and returns the
parent object.
</p><p>
If the given object has no parent, the function returns a null value -
the exact type of which depending on the scripting language (i.e.
<code class="literal">None</code> in Python, <code class="literal">null</code> in
JavaScript, <code class="literal">nil</code> in Ruby etc.).
</p><div class="funcsynopsis"><a id="object.properties-function"></a><p><code class="funcdef">KeyValueMap <b class="fsfunc">object.properties</b>(</code><var class="pdparam">object</var><code>)</code>;</p></div><p>
This function takes an <em class="parameter"><code>object</code></em> reference (as
returned by the <a class="xref" href="rgs-squish.html#findObject-function"><code class="function">findObject</code></a> function or by
the <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a> function), and returns a
key–value map that holds all of the
<em class="parameter"><code>object</code></em>'s properties. The keys are property names
and the values are the property values. The return type is scripting
language-specific, e.g., a Python dict, a JavaScript Object, or a Perl
hash. Examples are given below.
</p><p>
For Tcl the data is written to an array whose name must be given as an
additional parameter. The same array should not be used in a second or
subsequent call unless you call <code class="code">array unset</code>
on it before each use.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
widget = waitForObject(":MyWidget")
properties = object.properties(widget)
# Best to use .iteritems(), .iterkeys(), or .itervalues() in Python 2
for name, value in properties.iteritems():
    test.log("%s = %s" % (name, value))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var widget = waitForObject(":MyWidget");
var properties = object.properties(widget);
for (var name in properties) {
    test.log(name + " = " + properties[name]);
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
my $widget = waitForObject(":MyWidget");
my %properties = object::properties($widget);
while (($name, $value) = each(%properties)) {
    test::log("$name = $value");
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
widget = waitForObject(":MyWidget")
properties = Squish::Object.properties(widget)
properties.each {|key, value| Test.log("#{key} = #{value}")}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set widget [waitForObject ":MyWidget"]
object properties $widget properties
foreach key [array names properties] {
    set value [toString $properties($key)]
    test log "$key = $value"
}
</pre></div><div class="funcsynopsis"><a id="object.globalBounds-function"></a><p><code class="funcdef">ScreenRectangle <b class="fsfunc">object.globalBounds</b>(</code><var class="pdparam">object</var><code>)</code>;</p></div><p>
This function takes an <em class="parameter"><code>object</code></em> reference (as returned by
the <a class="xref" href="rgs-squish.html#findObject-function"><code class="function">findObject</code></a> function or by the <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a> function), and returns the bounding
rectangle for the object in screen coordinates.  These values are identical to
what Squish uses during object highlight. The values may however not be
identical to toolkit specific geometry information since Squish may further
limit the global bounding rectangle to what is really visible on screen (i.e.
if parts of an object are clipped away by one of its parent objects).
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var obj = waitForObject(":MyWidget");
var rect = object.globalBounds(obj);
test.verify(rect.width &gt; 200);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
y $obj = waitForObject(":MyWidget");
my $rect = object::globalBounds($obj);
test::verify($rect-&gt;width &gt; 200);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
obj = waitForObject(":MyWidget")
rect = object.globalBounds(obj)
test.verify(rect.width &gt; 200)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
obj = waitForObject(":MyWidget")
rect = Squish::Object.globalBounds(obj)
Test.verify(rect.width &gt; 200)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set obj [waitForObject ":MyWidget"]
set rect [object globalBounds $obj]
test verify [expr [property get $rect width] &gt; 200]
</pre></div><div class="funcsynopsis"><a id="object.grabScreenshot-function"></a><p><code class="funcdef">Image <b class="fsfunc">object.grabScreenshot</b>(</code><var class="pdparam">object</var>, <var class="pdparam">[parameterMap]</var><code>)</code>;</p></div><p>
This function takes an <em class="parameter"><code>object</code></em> reference (as returned by
the <a class="xref" href="rgs-squish.html#findObject-function"><code class="function">findObject</code></a> function or by the <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a> function), and returns a screenshot of its
current visual as an <a class="xref" href="rgs-squish.html#script-image-object" title="6.3.14. Image Object">Image Object (Section 6.3.14)</a>.
</p><p>
The screenshot behavior can be configured through entries passed via the
optional <em class="parameter"><code>parameterMap</code></em> argument.
</p><div class="itemizedlist"><ul type="disc"><li><p><em class="parameter"><code>delay</code></em> - The delay before taking the
screenshot in milliseconds. The default value is <code class="constant">1000</code>
(1 second) to allow the AUT to react to the latest inputs and reach a stable
state before taking a screenshot. Reducing it to <code class="constant">0</code> may
be useful to improve the test execution time, especially in case of a series
of consecutive <code class="code">grabScreenshot()</code> calls.
</p></li></ul></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var obj = waitForObject(":MyWidget");
var img = object.grabScreenshot(obj, {delay: 0});
test.attachImage(img);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
y $obj = waitForObject(":MyWidget");
my $img = object::grabScreenshot($obj, {"delay" =&gt; 0});
test::attachImage($img);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
obj = waitForObject(":MyWidget")
img = object.grabScreenshot(obj, {"delay": 0})
test.attachImage(img)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
obj = waitForObject(":MyWidget")
img = Squish::Object.grabScreenshot(obj, {"delay" =&gt; 0})
Test.attachImage(img)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set obj [waitForObject ":MyWidget"]
set img [object grabScreenshot $obj {delay 0}]
test attachImage $img
</pre></div><div class="funcsynopsis"><a id="object.topLevelObjects-function"></a><p><code class="funcdef">SequenceOfObjects <b class="fsfunc">object.topLevelObjects</b>(</code><code>)</code>;</p></div><p>
This function returns a list of all of the AUT's top-level objects.
The return type is scripting language-specific, e.g., a tuple in Python,
and an array in the other languages. Examples are given below.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
topLevels = object.topLevelObjects()
# iterate over tuple
for obj in topLevels:
    children = object.children(obj)
    ...
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var topLevels = object.topLevelObjects();
// iterate over array
for (var i = 0; i &lt; topLevels.length; ++i) {
    var obj = topLevels[i];
    var children = object.children(obj)
    ...
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
my @topLevels = object::topLevelObjects();
# iterate over array
foreach $obj (@topLevels) {
    my @children = object::children(obj)
    ...
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
topLevels = Squish::Object.topLevelObjects()
# iterate over array
for obj in topLevels
    children = Squish::Object.children(obj)
    #...
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set topLevels [object topLevelObjects]
foreach obj $topLevels {
    set children [object children $obj]
    ...
}
</pre></div><div class="funcsynopsis"><a id="findImage-function"></a><p><code class="funcdef">ScreenRectangle <b class="fsfunc">findImage</b>(</code><var class="pdparam">imageFile</var>, <var class="pdparam">[parameterMap]</var>, <var class="pdparam">[searchRegion]</var><code>)</code>;</p></div><p>
This function will perform a search of the template image as stored
in <em class="parameter"><code>imageFile</code></em> on the display also showing the
currently running application. On success the location of the found
image is returned as a
<a class="xref" href="rgs-squish.html#rgss-screenrectangle-object" title="6.3.21.3. UiTypes.ScreenRectangle Class">ScreenRectangle</a>. Functions
like <code class="code">mouseClick()</code> or <code class="code">tapObject()</code> can then
emulate a user interaction on the detected location.
</p><p>The search for the sub-image is performed left to right, top to
bottom. The first successful match is returned. For selection of other
matches use the <code class="code">occurrence</code> parameter as described
below.</p><p>All available screens making up the desktop will be searched. At
least on Windows and X11-based systems. For searches on multi-screen
setup on macOS please inquire with technical support.
</p><p>
The search behavior can be configured through entries passed
via the optional <em class="parameter"><code>parameterMap</code></em> argument.
</p><div class="itemizedlist"><ul type="disc"><li><p><em class="parameter"><code>occurrence</code></em> - The occurrence
index. By default the first match (with index 1) will be returned.
Index values 2 and higher will select consecutive matches as far as
available.</p></li><li><p><em class="parameter"><code>tolerant</code></em> - Boolean switch
that enables tolerant image search mode. In this mode some differences
between the template image and the desktop screenshot are allowed. The
default value is the value of
<a class="xref" href="rgs-squish.html#testSettings.imageSearchTolerant-property">testSettings.imageSearchTolerant</a> property.
</p></li><li><p><em class="parameter"><code>threshold</code></em> - Threshold on the
correlation between template image and a desktop screenshot,
expressed as a percentage. A correlation higher than the threshold is
considered a match against the template image. Usable values for this
parameter usually fall between <code class="constant">99.0</code> and
<code class="constant">100.0</code>. The default value is the value of the
<a class="xref" href="rgs-squish.html#testSettings.imageSearchThreshold-property">testSettings.imageSearchThreshold</a> property.
This parameter is ignored if the <code class="code">tolerant</code> parameter is
set to <code class="code">false</code>.</p></li><li><p><em class="parameter"><code>multiscale</code></em> - Boolean switch
that enables scaled image search mode. In this mode the template image
is expanded into a series of images of different sizes. Those image
are subsequently used as template images for the image search. The
default value is the value of the
<a class="xref" href="rgs-squish.html#testSettings.imageSearchMultiscale-property">testSettings.imageSearchMultiscale</a> property.
This parameter is ignored if the <code class="code">tolerant</code> parameter is
set to <code class="code">false</code>.</p></li><li><p><em class="parameter"><code>minScale</code></em> - Lower bound on the
template image series sizes, expressed as a percentage. The resized
template image sizes will span between <code class="code">minScale</code> and
<code class="code">maxScale</code> of the original image size. The default value
is the value of the
<a class="xref" href="rgs-squish.html#testSettings.imageSearchMinScale-property">testSettings.imageSearchMinScale</a> property.
This parameter is ignored if either the <code class="code">tolerant</code> or the
<code class="code">multiscale</code> parameters are set to <code class="code">false</code>.
</p></li><li><p><em class="parameter"><code>maxScale</code></em> Upper bound on the
template image series sizes, expressed as a percentage. The resized
template image sizes will span between <code class="code">minScale</code> and
<code class="code">maxScale</code> of the original image size. The default value
is the value of the
<a class="xref" href="rgs-squish.html#testSettings.imageSearchMaxScale-property">testSettings.imageSearchMaxScale</a> property.
This parameter is ignored if either the <code class="code">tolerant</code> or the
<code class="code">multiscale</code> parameters are set to <code class="code">false</code>.
</p></li></ul></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Click on icon.png
mouseClick( findImage("icon.png") )
# Click on second occurrence of icon.png
mouseClick( findImage("icon.png", {"occurrence": 2}) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Click on icon.png
mouseClick( findImage("icon.png") );
// Click on second occurrence of icon.png
mouseClick( findImage("icon.png", {"occurrence": 2}) );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Click on icon.png
mouseClick( findImage("icon.png") );
# Click on second occurrence of icon.png
mouseClick( findImage("icon.png", {"occurrence" =&gt; 2}) );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Click on icon.png
mouseClick( findImage("icon.png") )
# Click on second occurrence of icon.png
mouseClick( findImage("icon.png", {"occurrence" =&gt; 2}) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Click on icon.png
invoke mouseClick [waitForImage "icon.png"]
# Click on second occurrence of icon.png
invoke mouseClick [waitForImage "icon.png" {occurrence 2 timeout 10000}]
</pre></div><p>
This function will perform a single check of the screen
content only. If it fails to find the sub-image an exception will be
thrown. A call is useful in case a) the presence of the sub-image is
almost certain or b) a quick check of the presence is wanted. In all
other cases the <a class="xref" href="rgs-squish.html#waitForImage-function"><code class="function">waitForImage</code></a> function is
preferred for timing-independent look-ups.
</p><p>The matching algorithm performs a pixel-by-pixel color value
comparison. The screen content and sub-image content therefore have to
match 100% unless the tolerant search mode is enabled.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Click on icon.png
mouseClick( findImage("icon.png", {'tolerant': True,
                                   'threshold': 99.7,
                                   'multiscale': True,
                                   'minScale': 100.0,
                                   'maxScale': 150.0}) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Click on icon.png
mouseClick( findImage("icon.png", {tolerant: true,
                                   threshold: 99.7,
                                   multiscale: true,
                                   minScale: 100.0,
                                   maxScale: 150.0}) );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Click on icon.png
mouseClick( findImage("icon.png", {tolerant =&gt; true,
                                   threshold =&gt; 99.7,
                                   multiscale =&gt; true,
                                   minScale =&gt; 100.0,
                                   maxScale =&gt; 150.0}) );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Click on icon.png
mouseClick( findImage("icon.png", {"tolerant" =&gt; true,
                                   "threshold" =&gt; 99.7,
                                   "multiscale" =&gt; true,
                                   "minScale" =&gt; 100.0,
                                   "maxScale" =&gt; 150.0}) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Check whether icon.png is displayed on screen
invoke mouseClick [ findImage "icon.png" {tolerant true \
                                          threshold 99.7 \
                                          multiscale true \
                                          minScale 100.0 \
                                          maxScale 150.0} ]
</pre></div><p>
In case a searchRegion is specified as the last argument, the search
is performed only within the area corresponding to it. The search
region can be an AUT object, a ScreenRectangle object or an array of
such objects. It can also be a special string value "all", in which
case all top-level objects are used.
</p><p>The searchRegion can also be an <a class="xref" href="rgs-squish.html#script-image-object" title="6.3.14. Image Object">Image</a> object. In such case no new screenshots
are taken and the specified image is used instead. Currently it is not
possible to limit the search scope to a portion of an <code class="code">Image</code>
object; please use the <a class="xref" href="rgs-squish.html#Image.copy-function"><code class="function">Image.copy</code></a> to cut
the relevant section.</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Find icon.png on the MyWidget object
findImage("icon.png", {}, waitForObject( names.MyWidget ) )

# Find icon.png on multiple objects
findImage("icon.png", {}, [ waitForObject( names.MyWidget ),
                            waitForObject( names.MyOtherWidget ) ] )

# Find icon.png on the left half of the MyWidget object
bounds = object.globalBounds( waitForObject( names.MyWidget ) )
bounds.width = bounds.width / 2
findImage("icon.png", {}, bounds )

# Find icon.png in the specified area
findImage("icon.png", {}, UiTypes.ScreenRectangle( 100, 100, 200, 300 ) )

# Find icon.png on all top-level objects
findImage("icon.png", {}, "all" )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Find icon.png on the MyWidget object
findImage("icon.png", {}, waitForObject( names.MyWidget ) );

// Find icon.png on multiple objects
findImage("icon.png", {}, [ waitForObject( names.MyWidget ),
                            waitForObject( names.MyOtherWidget ) ] );

// Find icon.png on the left half of the MyWidget object
var bounds = object.globalBounds( waitForObject( names.MyWidget ) );
bounds.width = bounds.width / 2
findImage("icon.png", {}, bounds );

// Find icon.png in the specified area
findImage("icon.png", {}, UiTypes.ScreenRectangle( 100, 100, 200, 300 ) );

// Find icon.png on all top-level objects
findImage("icon.png", {}, "all" );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Find icon.png on the MyWidget object
findImage("icon.png", {}, waitForObject( names::MyWidget ) );

# Find icon.png on multiple objects
findImage("icon.png", {}, ( waitForObject( names::MyWidget ),
                            waitForObject( names::MyOtherWidget ) ) );

# Find icon.png on the left half of the MyWidget object
my $bounds = object::globalBounds( waitForObject( names::MyWidget ) );
$bounds-&gt;width = $bounds-&gt;width / 2;
findImage("icon.png", {}, bounds );

# Find icon.png in the specified area
findImage("icon.png", {}, new UiTypes::ScreenRectangle( 100, 100, 200, 300 ) );

# Find icon.png on all top-level objects
findImage("icon.png", {}, "all" )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Find icon.png on the MyWidget object
findImage("icon.png", {}, waitForObject( names.MyWidget ) );

# Find icon.png on multiple objects
findImage("icon.png", {}, [ waitForObject( names.MyWidget ),
                            waitForObject( names.MyOtherWidget ) ] );

# Find icon.png on the left half of the MyWidget object
bounds = Squish::Object.globalBounds( waitForObject( names.MyWidget ) );
bounds.width = bounds.width / 2
findImage("icon.png", {}, bounds );

# Find icon.png in the specified area
findImage("icon.png", {}, UiTypes::ScreenRectangle.new( 100, 100, 200, 300 ) );

# Find icon.png on all top-level objects
findImage("icon.png", {}, "all" );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Find icon.png on the MyWidget object
findImage "icon.png" {} [ waitForObject $names::MyWidget ]

# Find icon.png on multiple objects
findImage "icon.png" {} { [ waitForObject $names::MyWidget ],
                          [ waitForObject $names::MyOtherWidget ] }

# Find icon.png on the left half of the MyWidget object
set bounds [object globalBounds [ waitForObject $names::MyWidget ] ]
property set $bounds width [ expr [ property get $bounds width ] / 2 ]
findImage "icon.png" {} $bounds

# Find icon.png in the specified area
findImage "icon.png" {} [ construct ScreenRectangle 100 100 200 300 ]

# Find icon.png on all top-level objects
findImage "icon.png" {} "all"
</pre></div><div class="funcsynopsis"><a id="getOcrText-function"></a><p><code class="funcdef">String <b class="fsfunc">getOcrText</b>(</code><var class="pdparam">[parameterMap]</var>, <var class="pdparam">[searchRegion]</var><code>)</code>;</p></div><p>
This function will perform optical character recognition on the
display also showing the currently running application and return all
text lines.
</p><p>
The OCR will be performed over all available screens making up
the desktop. At least on Windows and X11-based systems. For OCR on
multi-screen setup on macOS please inquire with technical support.
</p><p>
The search behavior can be configured through entries passed
via the optional <em class="parameter"><code>parameterMap</code></em> argument.
</p><div class="itemizedlist"><ul type="disc"><li><p><em class="parameter"><code>language</code></em> - The language hint
for OCR engine. Use an empty string to use the OCR engine defaults.
The default value is the value of
<a class="xref" href="rgs-squish.html#testSettings.defaultOcrLanguage-property">testSettings.defaultOcrLanguage</a> property.
</p></li><li><p><em class="parameter"><code>profiles</code></em> - An array of OCR
engine specific profile names. This parameter is used only with
engines that support profiles.
</p></li><li><p><em class="parameter"><code>options</code></em> - A map of
engine-specific option names and values. These options are passed to
the OCR engine after loading the specified profiles.
</p></li><li><p><em class="parameter"><code>scaleFactor</code></em> - Image up-scale
factor. The source image is upscaled by that factor before it is
passed to the OCR engine. The default value is
<code class="constant">3.5</code>. It can be set to a lower value to improve
the OCR performance in case the text is rendered with a large font.
</p></li></ul></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Get all text using German language hint
test.log( getOcrText( { "language": "German" } ) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Get all text using German language hint
test.log( getOcrText( { language: "German" } ) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Get all text using German language hint
test::log( getOcrText( { language =&gt; "German" } ) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Get all text using German language hint
Test.log( getOcrText( { "language" =&gt; "German" } ) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Get all text using German language hint
test log [ getOcrText { language "German" } ]
</pre></div><p>
In case a searchRegion is specified as the last argument, the OCR
is performed only within the area corresponding to it. The search
region can be an AUT object, a ScreenRectangle object or an array of
such objects. It can also be a special string value "all", in which
case all top-level objects are used.
</p><p>The searchRegion can also be an <a class="xref" href="rgs-squish.html#script-image-object" title="6.3.14. Image Object">Image</a> object. In such case no new screenshots
are taken and the specified image is used instead. Currently it is not
possible to limit the OCR scope to a portion of an <code class="code">Image</code>
object; please use the <a class="xref" href="rgs-squish.html#Image.copy-function"><code class="function">Image.copy</code></a> to cut
the relevant section.</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Find all text on the MyWidget object
test.log( getOcrText( {}, waitForObject( names.MyWidget ) )

# Find all text on multiple objects
test.log( getOcrText( {}, [ waitForObject( names.MyWidget ),
                            waitForObject( names.MyOtherWidget ) ] ) )

# Find all text on the left half of the MyWidget object
bounds = object.globalBounds( waitForObject( names.MyWidget ) )
bounds.width = bounds.width / 2
test.log( getOcrText( {}, bounds ) )

# Find all text in the specified area
test.log( getOcrText( {}, UiTypes.ScreenRectangle( 100, 100, 200, 300 ) ) )

# Find all text on all top-level objects
test.log( getOcrText( {}, "all" ) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
# Find all text on the MyWidget object
test.log( getOcrText( {}, waitForObject( names.MyWidget ) ) );

// Find all text on multiple objects
test.log( getOcrText( {}, [ waitForObject( names.MyWidget ),
                            waitForObject( names.MyOtherWidget ) ] ) );

// Find all text on the left half of the MyWidget object
var bounds = object.globalBounds( waitForObject( names.MyWidget ) );
bounds.width = bounds.width / 2
test.log( getOcrText( {}, bounds ) );

// Find all text in the specified area
test.log( getOcrText( {}, new UiTypes.ScreenRectangle( 100, 100, 200, 300 ) ) );

// Find all text on all top-level objects
test.log( getOcrText( {}, "all" ) );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Find all text on the MyWidget object
test::log( getOcrText( {}, waitForObject( names::MyWidget ) ) );

# Find all text on multiple objects
test::log( getOcrText( {}, ( waitForObject( names::MyWidget ),
                            waitForObject( names::MyOtherWidget ) ) ) );

# Find all text on the left half of the MyWidget object
my $bounds = object::globalBounds( waitForObject( names::MyWidget ) );
$bounds-&gt;width = $bounds-&gt;width / 2;
test::log( getOcrText( {}, bounds ) );

# Find all text in the specified area
test::log( getOcrText( {}, new UiTypes::ScreenRectangle( 100, 100, 200, 300 ) ) );

# Find all text on all top-level objects
test::log( getOcrText( {}, "all" ) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Find all text on the MyWidget object
Test.log( getOcrText( {}, waitForObject( names.MyWidget ) ) );

# Find all text on multiple objects
Test.log( getOcrText( {}, [ waitForObject( names.MyWidget ),
                            waitForObject( names.MyOtherWidget ) ] ) );

# Find all text on the left half of the MyWidget object
bounds = Squish::Object.globalBounds( waitForObject( names.MyWidget ) );
bounds.width = bounds.width / 2
Test.log( getOcrText( {}, bounds ) );

# Find all text in the specified area
Test.log( getOcrText( {}, UiTypes::ScreenRectangle.new( 100, 100, 200, 300 ) ) );

# Find all text on all top-level objects
Test.log( getOcrText( {}, "all" ) );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Find all text on the MyWidget object
test log [ getOcrText {} [ waitForObject $names::MyWidget ] ]

# Find all text on multiple objects
test log [ getOcrText {} { [ waitForObject $names::MyWidget ],
                           [ waitForObject $names::MyOtherWidget ] } ]

# Find all text on the left half of the MyWidget object
set bounds [object globalBounds [ waitForObject $names::MyWidget ] ]
property set $bounds width [ expr [ property get $bounds width ] / 2 ]
test log [ getOcrText {} $bounds ]

# Find all text in the specified area
test log [ getOcrText {} [ construct ScreenRectangle 100 100 200 300 ] ]

# Find all text on all top-level objects
test log [ getOcrText {} "all" ]
</pre></div><div class="funcsynopsis"><a id="findOcrText-function"></a><p><code class="funcdef">ScreenRectangle <b class="fsfunc">findOcrText</b>(</code><var class="pdparam">text</var>, <var class="pdparam">[parameterMap]</var>, <var class="pdparam">[searchRegion]</var><code>)</code>;</p></div><p>
This function will perform optical character recognition on the
display also showing the currently running application and search for
the specific text within the result set. It will return a ScreenRectangle
object corresponding to the location of the text.
</p><p>
The OCR will be performed over all available screens making up
the desktop. At least on Windows and X11-based systems. For OCR on
multi-screen setup on macOS please inquire with technical support.
</p><p>
The search behavior can be configured through entries passed
via the optional <em class="parameter"><code>parameterMap</code></em> argument.
</p><div class="itemizedlist"><ul type="disc"><li><p><em class="parameter"><code>occurrence</code></em> - The occurrence
index. By default the first text match (with index 1) will be
returned. Index values 2 and higher will select consecutive matches as
far as available.</p></li><li><p><em class="parameter"><code>language</code></em> - The language hint
for OCR engine. Use an empty string to use the OCR engine defaults.
The default value is the value of
<a class="xref" href="rgs-squish.html#testSettings.defaultOcrLanguage-property">testSettings.defaultOcrLanguage</a> property.
</p></li><li><p><em class="parameter"><code>profiles</code></em> - An array of OCR
engine specific profile names. This parameter is used only with
engines that support profiles.
</p></li><li><p><em class="parameter"><code>options</code></em> - A map of
engine-specific option names and values. These options are passed to
the OCR engine after loading the specified profiles.
</p></li><li><p><em class="parameter"><code>scaleFactor</code></em> - Image up-scale
factor. The source image is upscaled by that factor before it is
passed to the OCR engine. The default value is
<code class="constant">3.5</code>. It can be set to a lower value to improve
the OCR performance in case the text is rendered with a large font.
</p></li></ul></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Click on text
mouseClick( findOcrText( "Test Text" ) )
# Click on text in German
mouseClick( findOcrText( "Test Text", { "language": "German" } ) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Click on text
mouseClick( findOcrText( "Test Text" ) );
// Click on text in German
mouseClick( findOcrText( "Test Text", { language: "German" } ) );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Click on text
mouseClick( findOcrText( "Test Text" ) );
# Click on text in German
mouseClick( findOcrText( "Test Text", { "language" =&gt; "German" } ) );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Click on text
mouseClick( findOcrText( "Test Text" ) )
# Click on text in German
mouseClick( findOcrText( "Test Text", { "language" =&gt; "German" } ) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Click on text
invoke mouseClick[ findOcrText "Test Text" ]
# Click on text in German
invoke mouseClick[ findOcrText "Test Text" { language "German" } ]
</pre></div><p>
This function will perform a single OCR of the screen
content only. If it fails to find the specified text an exception will
be thrown. A call is useful in case a) the presence of the text is
almost certain or b) a quick check of the presence is wanted. In all
other cases the <a class="xref" href="rgs-squish.html#waitForOcrText-function"><code class="function">waitForOcrText</code></a> function is
preferred for timing-independent look-ups.
</p><p>
In case a searchRegion is specified as the last argument, the OCR
is performed only within the area corresponding to it. The search
region can be an AUT object, a ScreenRectangle object or an array of
such objects. It can also be a special string value "all", in which
case all top-level objects are used.
</p><p>The searchRegion can also be an <a class="xref" href="rgs-squish.html#script-image-object" title="6.3.14. Image Object">Image</a> object. In such case no new screenshots
are taken and the specified image is used instead. Currently it is not
possible to limit the OCR scope to a portion of an <code class="code">Image</code>
object; please use the <a class="xref" href="rgs-squish.html#Image.copy-function"><code class="function">Image.copy</code></a> to cut
the relevant section.</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Click on text on the MyWidget object
mouseClick( findOcrText( "Click me", {}, waitForObject( names.MyWidget ) )

# Click on text on multiple objects
mouseClick( findOcrText( "Click me", {}, [ waitForObject( names.MyWidget ),
                                                   waitForObject( names.MyOtherWidget ) ] ) )

# Click on text on the left half of the MyWidget object
bounds = object.globalBounds( waitForObject( names.MyWidget ) )
bounds.width = bounds.width / 2
mouseClick( findOcrText( "Click me", {}, bounds ) )

# Click on text in the specified area
mouseClick( findOcrText( "Click me", {}, UiTypes.ScreenRectangle( 100, 100, 200, 300 ) ) )

# Click on text on all top-level objects
mouseClick( findOcrText( "Click me", {}, "all" ) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
# Click on text on the MyWidget object
mouseClick( findOcrText( "Click me", {}, waitForObject( names.MyWidget ) ) );

// Click on text on multiple objects
mouseClick( findOcrText( "Click me", {}, [ waitForObject( names.MyWidget ),
                                                   waitForObject( names.MyOtherWidget ) ] ) );

// Click on text on the left half of the MyWidget object
var bounds = object.globalBounds( waitForObject( names.MyWidget ) );
bounds.width = bounds.width / 2
mouseClick( findOcrText( "Click me", {}, bounds ) );

// Click on text in the specified area
mouseClick( findOcrText( "Click me", {}, new UiTypes.ScreenRectangle( 100, 100, 200, 300 ) ) );

// Click on text on all top-level objects
mouseClick( findOcrText( "Click me", {}, "all" ) );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Click on text on the MyWidget object
mouseClick( findOcrText( "Click me", {}, waitForObject( names::MyWidget ) ) );

# Click on text on multiple objects
mouseClick( findOcrText( "Click me", {}, ( waitForObject( names::MyWidget ),
                                                   waitForObject( names::MyOtherWidget ) ) ) );

# Click on text on the left half of the MyWidget object
my $bounds = object::globalBounds( waitForObject( names::MyWidget ) );
$bounds-&gt;width = $bounds-&gt;width / 2;
mouseClick( findOcrText( "Click me", {}, bounds ) );

# Click on text in the specified area
mouseClick( findOcrText( "Click me", {}, new UiTypes::ScreenRectangle( 100, 100, 200, 300 ) ) );

# Click on text on all top-level objects
mouseClick( findOcrText( "Click me", {}, "all" ) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Click on text on the MyWidget object
mouseClick( findOcrText( "Click me", {}, waitForObject( names.MyWidget ) ) );

# Click on text on multiple objects
mouseClick( findOcrText( "Click me", {}, [ waitForObject( names.MyWidget ),
                                                   waitForObject( names.MyOtherWidget ) ] ) );

# Click on text on the left half of the MyWidget object
bounds = Squish::Object.globalBounds( waitForObject( names.MyWidget ) );
bounds.width = bounds.width / 2
mouseClick( findOcrText( "Click me", {}, bounds ) );

# Click on text in the specified area
mouseClick( findOcrText( "Click me", {}, UiTypes::ScreenRectangle.new( 100, 100, 200, 300 ) ) );

# Click on text on all top-level objects
mouseClick( findOcrText( "Click me", {}, "all" ) );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Click on text on the MyWidget object
invoke mouseClick [ findOcrText "Click me" {} [ waitForObject $names::MyWidget ] ]

# Click on text on multiple objects
invoke mouseClick [ findOcrText "Click me" {} { [ waitForObject $names::MyWidget ],
                                                        [ waitForObject $names::MyOtherWidget ] } ]

# Click on text on the left half of the MyWidget object
set bounds [object globalBounds [ waitForObject $names::MyWidget ] ]
property set $bounds width [ expr [ property get $bounds width ] / 2 ]
invoke mouseClick [ findOcrText "Click me" {} $bounds ]

# Click on text in the specified area
invoke mouseClick [ findOcrText "Click me" {} [ construct ScreenRectangle 100 100 200 300 ] ]

# Click on text on all top-level objects
invoke mouseClick [ findOcrText "Click me" {} "all" ]
</pre></div><div class="funcsynopsis"><a id="findAllOcrText-function"></a><p><code class="funcdef">SequenceOfObjects <b class="fsfunc">findAllOcrText</b>(</code><var class="pdparam">text</var>, <var class="pdparam">[parameterMap]</var>, <var class="pdparam">[searchRegion]</var><code>)</code>;</p></div><p>
This function will perform optical character recognition on the
display also showing the currently running application and search for
the specific text within the result set. It will return a sequence of
ScreenRectangle objects corresponding to the locations of the
specified text.
</p><p>
The OCR will be performed over all available screens making up
the desktop. At least on Windows and X11-based systems. For OCR on
multi-screen setup on macOS please inquire with technical support.
</p><p>
The search behavior can be configured through entries passed
via the optional <em class="parameter"><code>parameterMap</code></em> argument.
</p><div class="itemizedlist"><ul type="disc"><li><p><em class="parameter"><code>language</code></em> - The language hint
for OCR engine. Use an empty string to use the OCR engine defaults.
The default value is the value of
<a class="xref" href="rgs-squish.html#testSettings.defaultOcrLanguage-property">testSettings.defaultOcrLanguage</a> property.
</p></li><li><p><em class="parameter"><code>profiles</code></em> - An array of OCR
engine specific profile names. This parameter is used only with
engines that support profiles.
</p></li><li><p><em class="parameter"><code>options</code></em> - A map of
engine-specific option names and values. These options are passed to
the OCR engine after loading the specified profiles.
</p></li><li><p><em class="parameter"><code>scaleFactor</code></em> - Image up-scale
factor. The source image is upscaled by that factor before it is
passed to the OCR engine. The default value is
<code class="constant">3.5</code>. It can be set to a lower value to improve
the OCR performance in case the text is rendered with a large font.
</p></li></ul></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Check whether 'Test Text' is displayed on screen 3 times
test.compare( len( findAllOcrText( "Test Text", { "language": "German" } ) ), 3 )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Check whether 'Test Text' is displayed on screen 3 times
test.compare( findAllOcrText( "Test Text", { "language": "German" } ).length, 3 )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Check whether 'Test Text' is displayed on screen 3 times
my @locations = findAllOcrText( "Test Text", { language =&gt; "German" } );
test::compare( scalar @locations, 3 )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Check whether 'Test Text' is displayed on screen 3 times
Test.compare( findAllOcrText( "Test Text", { "language" =&gt; "German" } ).length, 3 );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Check whether 'Test Text' is displayed on screen 3 times
test compare [ llength [ findAllOcrText "Test Text" { language "German" } ] ] 3
</pre></div><p>
In case a searchRegion is specified as the last argument, the OCR
is performed only within the area corresponding to it. The search
region can be an AUT object, a ScreenRectangle object or an array of
such objects. It can also be a special string value "all", in which
case all top-level objects are used.
</p><p>The searchRegion can also be an <a class="xref" href="rgs-squish.html#script-image-object" title="6.3.14. Image Object">Image</a> object. In such case no new screenshots
are taken and the specified image is used instead. Currently it is not
possible to limit the OCR scope to a portion of an <code class="code">Image</code>
object; please use the <a class="xref" href="rgs-squish.html#Image.copy-function"><code class="function">Image.copy</code></a> to cut
the relevant section.</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Check whether 'Test Text' is displayed on MyWidget 3 times
test.compare( len( findAllOcrText( "Test Text", {}, waitForObject( names.MyWidget ) ) ), 3 )

# Check whether 'Test Text' is displayed on multiple widgets 3 times
test.compare( len( findAllOcrText( "Test Text", {}, [ waitForObject( names.MyWidget ),
                                                               waitForObject( names.MyOtherWidget ) ] ) ), 3 )

# Check whether 'Test Text' is displayed on the left half of the MyWidget object
bounds = object.globalBounds( waitForObject( names.MyWidget ) )
bounds.width = bounds.width / 2
test.compare( len( findAllOcrText( "Test Text", {}, bounds ) ), 3 )

# Check whether 'Test Text' is displayed on the specified area
test.compare( len( findAllOcrText( "Test Text", {}, UiTypes.ScreenRectangle( 100, 100, 200, 300 ) ) ), 3 )

# Check whether 'Test Text' is displayed on all top-level objects
test.compare( len( findAllOcrText( "Test Text", {}, "all" ) ), 3 )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Check whether 'Test Text' is displayed on MyWidget 3 times
test.compare( findAllOcrText( "Test Text", {}, waitForObject( names.MyWidget ) ).length , 3 )

// Check whether 'Test Text' is displayed on multiple widgets 3 times
test.compare( findAllOcrText( "Test Text", {}, [ waitForObject( names.MyWidget ),
                                                          waitForObject( names.MyOtherWidget ) ] ).length, 3 )

// Check whether 'Test Text' is displayed on the left half of the MyWidget object
bounds = object.globalBounds( waitForObject( names.MyWidget ) )
bounds.width = bounds.width / 2
test.compare( findAllOcrText( "Test Text", {}, bounds ) .length, 3 )

// Check whether 'Test Text' is displayed on the specified area
test.compare( findAllOcrText( "Test Text", {}, UiTypes.ScreenRectangle( 100, 100, 200, 300 ) ).length, 3 )

// Check whether 'Test Text' is displayed on all top-level objects
test.compare( findAllOcrText( "Test Text", {}, "all" ).length, 3 )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Check whether 'Test Text' is displayed on MyWidget 3 times
my @locations = findAllOcrText( "Test Text", {}, waitForObject( names::MyWidget ) );
test::compare( scalar @locations, 3 )

# Check whether 'Test Text' is displayed on multiple widgets 3 times
my @locations = findAllOcrText( "Test Text", {}, ( waitForObject( names::MyWidget ),
                                                            waitForObject( names::MyOtherWidget ) ) );
test::compare( scalar @locations, 3 )

# Check whether 'Test Text' is displayed on the left half of the MyWidget object
my $bounds = object::globalBounds( waitForObject( names::MyWidget ) );
$bounds-&gt;width = $bounds-&gt;width / 2;
my @locations = findAllOcrText( "Test Text", {}, $bounds );
test::compare( scalar @locations, 3 )

# Check whether 'Test Text' is displayed on the specified area
my @locations = findAllOcrText( "Test Text", {}, new UiTypes::ScreenRectangle( 100, 100, 200, 300 ) );
test::compare( scalar @locations, 3 )

# Check whether 'Test Text' is displayed on all top-level objects
my @locations = findAllOcrText( "Test Text", {}, "all" );
test::compare( scalar @locations, 3 )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Check whether 'Test Text' is displayed on MyWidget 3 times
Test.compare( findAllOcrText( "Test Text", {}, waitForObject( names.MyWidget ) ).length, 3 );

# Check whether 'Test Text' is displayed on multiple widgets 3 times
Test.compare( findAllOcrText( "Test Text", {}, [ waitForObject( names.MyWidget ),
                                                          waitForObject( names.MyOtherWidget ) ] ).length, 3 );

# Check whether 'Test Text' is displayed on the left half of the MyWidget object
bounds = Squish::Object.globalBounds( waitForObject( names.MyWidget ) );
bounds.width = bounds.width / 2
Test.compare( findAllOcrText( "Test Text", {}, bounds ).length, 3 );

# Check whether 'Test Text' is displayed on the specified area
Test.compare( findAllOcrText( "Test Text", {}, UiTypes::ScreenRectangle.new( 100, 100, 200, 300 ) ).length, 3 );

# Check whether 'Test Text' is displayed on all top-level objects
Test.compare( findAllOcrText( "Test Text", {}, "all" ).length, 3 );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Check whether 'Test Text' is displayed on MyWidget 3 times
test compare [ llength [ findAllOcrText "Test Text" {} [ waitForObject $names::MyWidget ] ] ] 3

# Check whether 'Test Text' is displayed on multiple widgets 3 times
test compare [ llength [ findAllOcrText "Test Text" {} { [ waitForObject $names::MyWidget ],
                                                                  [ waitForObject $names::MyOtherWidget ] } ] ] 3

# Check whether 'Test Text' is displayed on the left half of the MyWidget object
set bounds [object globalBounds [ waitForObject $names::MyWidget ] ]
property set $bounds width [ expr [ property get $bounds width ] / 2 ]
test compare [ llength [ findAllOcrText "Test Text" {} $bounds ] ] 3

# Check whether 'Test Text' is displayed on the specified area
test compare [ llength [ findAllOcrText "Test Text" {} [ construct ScreenRectangle 100 100 200 300 ] ] ] 3

# Check whether 'Test Text' is displayed on all top-level objects
test compare [ llength [ findAllOcrText "Test Text" {} "all" ] ] 3
</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-sync-funcs"></a>6.3.4. Synchronization Functions</h3></div></div></div><div class="funcsynopsis"><a id="waitFor-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">waitFor</b>(</code><var class="pdparam">condition</var><code>)</code>;</p></div><p>
The <em class="parameter"><code>condition</code></em> is a piece of code to evaluate, passed as
a string or as a function reference, and that is expected to return a Boolean
value.
The <code class="code">waitFor</code> function loops one or more times, and on each
iteration it executes the <em class="parameter"><code>condition</code></em> code and
reads its return value. After each execution, if the
<em class="parameter"><code>condition</code></em> code's return value is
<code class="code">true</code>, <code class="code">waitFor</code> will finish and return
<code class="code">true</code>. Otherwise, the <code class="code">waitFor</code> function will
perform another iteration, that is, execute the
<em class="parameter"><code>condition</code></em> code again, and again check its return
value, repeating endlessly—or until the
<em class="parameter"><code>condition</code></em> code returns <code class="code">true</code>, in
which case <code class="code">waitFor</code> will finish and return
<code class="code">true</code>.
</p><p>
This function is designed as a quick and easy way to poll for a
condition in the AUT, where each <em class="parameter"><code>condition</code></em>
execution takes a very short time (typically a fraction of a second),
and always returns <code class="code">true</code> or <code class="code">false</code>. This is
useful if you want to synchronize your script execution to a certain
state in the AUT.
</p><p>
See <a class="xref" href="ugs-synchpoints.html" title="5.11. How to Create and Use Synchronization Points">How to Create and Use Synchronization Points (Section 5.11)</a> for examples of use.
</p><div class="funcsynopsis"><p><code class="funcdef">Boolean <b class="fsfunc">waitFor</b>(</code><var class="pdparam">condition</var>, <var class="pdparam">timeoutMSec</var><code>)</code>;</p></div><p>
The <em class="parameter"><code>condition</code></em> is a piece of code to evaluate, passed as
a string or as a function reference, and that is expected to return a Boolean
value.
The <code class="code">waitFor</code> function loops one or more times, and
on each iteration it executes the <em class="parameter"><code>condition</code></em> code
and reads its return value. After each execution, if the
<em class="parameter"><code>condition</code></em> code's return value is
<code class="code">true</code>, <code class="code">waitFor</code> will finish and return
<code class="code">true</code>. If the <em class="parameter"><code>condition</code></em> code returned
<code class="code">false</code>, the <code class="code">waitFor</code> function checks to see if
the time it has been running has exceeded the
<em class="parameter"><code>timeoutMSec</code></em>—if it has,
<code class="code">waitFor</code> finishes and returns <code class="code">false</code>;
otherwise it does another iteration, starting with another execution of
the <em class="parameter"><code>condition</code></em> code.
</p><p>
This function is designed as a quick and easy way to poll for a
condition in the AUT, where each <em class="parameter"><code>condition</code></em>
execution takes a very short time (typically a fraction of a second),
and always returns <code class="code">true</code> or <code class="code">false</code>. This is
useful if you want to synchronize your script execution to a certain
state in the AUT.
</p><p>
See <a class="xref" href="ugs-synchpoints.html" title="5.11. How to Create and Use Synchronization Points">How to Create and Use Synchronization Points (Section 5.11)</a> for examples of use.
</p><div class="funcsynopsis"><a id="waitForApplicationLaunch-function"></a><p><code class="funcdef">ApplicationContext <b class="fsfunc">waitForApplicationLaunch</b>(</code><var class="pdparam"></var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">ApplicationContext <b class="fsfunc">waitForApplicationLaunch</b>(</code><var class="pdparam">timeoutSecs</var><code>)</code>;</p></div><p>
Waits for a new application to start up, which <span class="emphasis"><em>Squish</em></span> then hooks into.
If the hooking succeeds it returns an <span class="type">ApplicationContext</span>
object representing the application that was started. This is used by
<span class="emphasis"><em>Squish</em></span> for test scripts which access multiple applications which are
started by the AUT. (See also, <a class="xref" href="rgs-squish.html#rgss-appcontext" title="6.3.12. Application Context">Application Context (Section 6.3.12)</a>.)
</p><p>
The optional parameter <em class="parameter"><code>timeoutSecs</code></em> (an integer number of
seconds) can be specified to tell <span class="emphasis"><em>Squish</em></span> how long it should be prepared to
wait for the application to appear before throwing an error. If specified, this
value overrides <span class="application">squishrunner</span>'s default AUT timeout. If not specified the
<span class="application">squishserver</span>'s default is used—this is 20 seconds, unless it has been
changed; see <a class="xref" href="ide.dialogs.html#ide.squish.server.settings.dialog" title="8.3.22. Squish Server Settings dialog">Squish Server Settings dialog (Section 8.3.22)</a>.
</p><div class="funcsynopsis"><a id="waitForObject-function"></a><p><code class="funcdef">Object <b class="fsfunc">waitForObject</b>(</code><var class="pdparam">objectOrName</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Object <b class="fsfunc">waitForObject</b>(</code><var class="pdparam">objectOrName</var>, <var class="pdparam">timeoutMSec</var><code>)</code>;</p></div><p>
Waits until the <em class="parameter"><code>objectOrName</code></em> object is accessible
(i.e., it exists and is <span class="property">visible</span> and
<span class="property">enabled</span>). It returns a reference to
the object if successful or raises a (catchable)
<code class="code">LookupError</code> exception on failure, i.e., if the function
times out.
The function waits for the time defined by the <a class="xref" href="rgs-squish.html#testSettings.waitForObjectTimeout-property">testSettings.waitForObjectTimeout</a> property or if the
optional <em class="parameter"><code>timeoutMSec</code></em> parameter is used, that many
milliseconds. This function is useful if you want to synchronize your script
execution.
</p><p>
The given name can also be a native script dictionary (resp. hash) value.
</p><p>
This function is only suitable for objects that are (or become) visible; for
non-visible objects consider using the <a class="xref" href="rgs-squish.html#waitForObjectExists-function"><code class="function">waitForObjectExists</code></a> function instead. And if you only want
to know if an object exists, use the <a class="xref" href="rgs-squish.html#object.exists-function"><code class="function">object.exists</code></a>
function.
</p><p> Additional processing can be done on waited-for objects in a
user-defined callback function. See <a class="xref" href="api.special.functions.html#waitUntilObjectReady-function"><code class="function">waitUntilObjectReady</code></a> for more details. </p><div class="funcsynopsis"><a id="waitForObjectExists-function"></a><p><code class="funcdef">Object <b class="fsfunc">waitForObjectExists</b>(</code><var class="pdparam">objectOrName</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Object <b class="fsfunc">waitForObjectExists</b>(</code><var class="pdparam">objectOrName</var>, <var class="pdparam">timeoutMSec</var><code>)</code>;</p></div><p>
Waits until the <em class="parameter"><code>objectOrName</code></em> object exists.
The given name can be a native script dictionary (resp. hash) value.
It returns a reference to the object if successful or raises a (catchable)
<code class="code">LookupError</code> exception on failure, i.e., if the function
times out.
The function waits for the time defined by the <a class="xref" href="rgs-squish.html#testSettings.waitForObjectTimeout-property">testSettings.waitForObjectTimeout</a> property or if the
optional <em class="parameter"><code>timeoutMSec</code></em> parameter is used, that many
milliseconds.
</p><div class="funcsynopsis"><a id="waitForObjectItem-function"></a><p><code class="funcdef">Object <b class="fsfunc">waitForObjectItem</b>(</code><var class="pdparam">objectOrName</var>, <var class="pdparam">itemOrIndex</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Object <b class="fsfunc">waitForObjectItem</b>(</code><var class="pdparam">objectOrName</var>, <var class="pdparam">itemOrIndex</var>, <var class="pdparam">timeoutMSec</var><code>)</code>;</p></div><p>
Waits until the <em class="parameter"><code>objectOrName</code></em> object is accessible
(i.e., it exists and is <span class="property">visible</span> and
<span class="property">enabled</span>), and contains an item that
is identified by the <em class="parameter"><code>itemOrIndex</code></em> and that is
itself accessible.
</p><p>
The given name can also be a native script dictionary (resp. hash) value.
</p><p>
This function is typically used to access items inside containers
such as lists, tables, and trees.
</p><p>The <em class="parameter"><code>itemOrIndex</code></em> for a table can be a
<code class="code">row/column</code> string like <code class="code">"4/21"</code>. In a tree, it can be a
period <code class="code">(.)</code>-separated path string such as
<code class="code">Mammals.Felines.Cats</code>. In a list where strings may appear multiple
times, a specific item can be selected by appending <code class="code">(_)</code> followed by
the item's occurrence index, to the non-unique string. For example,
<code class="code">"itemtext_3"</code> would retrieve the third item in the list which
contains the "<code class="code">itemtext</code>" string. </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important: Delimiter signs need to be escaped!"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"></img></td><th align="left">Delimiter signs need to be escaped!</th></tr><tr><td align="left" valign="top"><p>
When passing string literals to the <code class="code">waitForObjectItem()</code> function
which actually contain characters mentioned in the previous paragraph (<code class="code">(/)</code>,
<code class="code">(.)</code> and <code class="code">(_)</code>), these characters need to be escaped by
<code class="code">(\\)</code> (two backslashes) to make <code class="code">waitForObjectItem()</code>
function work properly.
Without escaping, the <code class="code">waitForObjectItem()</code> function would truncate
a given string passed as <em class="parameter"><code>itemOrIndex</code></em>,
treating anything which follows after a recognized
delimiter as being either 'row/col', 'index' or 'path' parameter!
</p></td></tr></table></div><p>
The return value depends on the Squish edition:
</p><div class="itemizedlist"><ul type="disc"><li><p>Java, Qt and Windows: The return value is a reference to the
<span class="emphasis"><em>item</em></span>. (The reference can be used with other
<span class="emphasis"><em>Squish</em></span> functions.)</p></li><li><p>Web and other <span class="emphasis"><em>Squish</em></span> editions: The return value is a
reference to the object identified by <em class="parameter"><code>objectOrName</code></em>
(not the item).</p></li></ul></div><p>
The function raises a (catchable) <code class="code">LookupError</code> exception on
failure, i.e., if it times out.
</p><p>
The function waits for the time defined by the <a class="xref" href="rgs-squish.html#testSettings.waitForObjectTimeout-property">testSettings.waitForObjectTimeout</a> property or if the
optional <em class="parameter"><code>timeoutMSec</code></em> parameter is used, that many
milliseconds.
</p><p> Additional processing can be done on the object items before
this function returns, by providing a user-defined callback function.
See <a class="xref" href="api.special.functions.html#waitUntilObjectItemReady-function"><code class="function">waitUntilObjectItemReady</code></a> for
details. </p><div class="funcsynopsis"><a id="waitForImage-function"></a><p><code class="funcdef">ScreenRectangle <b class="fsfunc">waitForImage</b>(</code><var class="pdparam">imageFile</var>, <var class="pdparam">[parameterMap]</var>, <var class="pdparam">[searchRegion]</var><code>)</code>;</p></div><p>
This function waits for an image as specified
by <em class="parameter"><code>imageFile</code></em> to appear on the screen, by repeatedly calling
<a class="xref" href="rgs-squish.html#findImage-function"><code class="function">findImage</code></a> until a <em class="parameter"><code>timeout</code></em> is
reached. In case of success, the location of the image as found on the screen will be
returned as a <a class="xref" href="rgs-squish.html#rgss-screenrectangle-object" title="6.3.21.3. UiTypes.ScreenRectangle Class">ScreenRectangle</a>. Interaction functions like
<a class="xref" href="rgs-squish.html#mouseClick-function"><code class="function">mouseClick</code></a>, <a class="xref" href="rgs-squish.html#doubleClick-function"><code class="function">doubleClick</code></a>
or <a class="xref" href="rgs-squish.html#tapObject-function"><code class="function">tapObject</code></a>  can be used to click or tap on the
detected location.
</p><p> The behavior of the search can be customized through additional
parameters passed to the optional <em class="parameter"><code>parameterMap</code></em> of
key-value pairs, where a key can be one of these:

</p><div class="itemizedlist"><ul type="disc"><li><p> <em class="parameter"><code>interval</code></em> - Number of
milliseconds to wait in between image search retries. The default is
1000 (1 second). </p></li><li><p> <em class="parameter"><code>timeout</code></em> - Amount of time in
milliseconds to search for an image before reporting that the image is
not found. The default is 20000 (20 seconds). </p></li><li><p><em class="parameter"><code>occurrence</code></em> - The occurrence
index. By default the first match (with index 1) will be returned.
Index values 2 and higher will select consecutive matches as far as
available.</p></li><li><p><em class="parameter"><code>tolerant</code></em> - Boolean switch
that enables tolerant image search mode. In this mode some differences
between the template image and the desktop screenshot are allowed. The
default value is the value of
<a class="xref" href="rgs-squish.html#testSettings.imageSearchTolerant-property">testSettings.imageSearchTolerant</a> property.
</p></li><li><p><em class="parameter"><code>threshold</code></em> - Threshold on the
correlation between template image and a desktop screenshot,
expressed as a percentage. A correlation higher than the threshold is
considered a match against the template image. Usable values for this
parameter usually fall between <code class="constant">99.0</code> and
<code class="constant">100.0</code>. The default value is the value of the
<a class="xref" href="rgs-squish.html#testSettings.imageSearchThreshold-property">testSettings.imageSearchThreshold</a> property.
This parameter is ignored if the <code class="code">tolerant</code> parameter is
set to <code class="code">false</code>.</p></li><li><p><em class="parameter"><code>multiscale</code></em> - Boolean switch
that enables scaled image search mode. In this mode the template image
is expanded into a series of images of different sizes. Those image
are subsequently used as template images for the image search. The
default value is the value of the
<a class="xref" href="rgs-squish.html#testSettings.imageSearchMultiscale-property">testSettings.imageSearchMultiscale</a> property.
This parameter is ignored if the <code class="code">tolerant</code> parameter is
set to <code class="code">false</code>.</p></li><li><p><em class="parameter"><code>minScale</code></em> - Lower bound on the
template image series sizes, expressed as a percentage. The resized
template image sizes will span between <code class="code">minScale</code> and
<code class="code">maxScale</code> of the original image size. The default value
is the value of the
<a class="xref" href="rgs-squish.html#testSettings.imageSearchMinScale-property">testSettings.imageSearchMinScale</a> property.
This parameter is ignored if either the <code class="code">tolerant</code> or the
<code class="code">multiscale</code> parameters are set to <code class="code">false</code>.
</p></li><li><p><em class="parameter"><code>maxScale</code></em> Upper bound on the
template image series sizes, expressed as a percentage. The resized
template image sizes will span between <code class="code">minScale</code> and
<code class="code">maxScale</code> of the original image size. The default value
is the value of the
<a class="xref" href="rgs-squish.html#testSettings.imageSearchMaxScale-property">testSettings.imageSearchMaxScale</a> property.
This parameter is ignored if either the <code class="code">tolerant</code> or the
<code class="code">multiscale</code> parameters are set to <code class="code">false</code>.
</p></li></ul></div><p>
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Click on icon.png
mouseClick(waitForImage("icon.png"))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Click on icon.png
mouseClick(waitForImage("icon.png"));
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Click on icon.png
mouseClick(waitForImage("icon.png"));
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Click on icon.png
mouseClick(waitForImage("icon.png"))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Click on icon.png
invoke mouseClick [waitForImage "icon.png"]
</pre></div><p>By default this function will repeatedly grab the screen content
until successful or until 20 seconds have passed. Longer (or shorter)
waiting periods can be set in milliseconds via a <code class="code">timeout</code>
value passed through the <em class="parameter"><code>parameterMap</code></em>. In order
to perform a single image search, use the
<a class="xref" href="rgs-squish.html#findImage-function"><code class="function">findImage</code></a> function.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Click on second icon.png, wait maximum 10 seconds
mouseClick(waitForImage("icon.png", {"occurrence": 2, "timeout": 10000})
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Click on second icon.png, wait maximum 10 seconds
mouseClick(waitForImage("icon.png", {occurrence: 2, timeout: 10000}));
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Click on second icon.png, wait maximum 10 seconds
mouseClick(waitForImage("icon.png", {"occurrence" =&gt; 2, "timeout" =&gt; 10000}));
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Click on second icon.png, wait maximum 10 seconds
mouseClick(waitForImage("icon.png", {"occurrence" =&gt; 2, "timeout" =&gt; 10000}))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Click on second icon.png, wait maximum 10 seconds
invoke mouseClick [waitForImage "icon.png" {occurrence 2 timeout 10000}]
</pre></div><p>The matching algorithm performs a pixel-by-pixel color value
comparison. The screen content and sub-image content therefore have to
match 100% unless the tolerant search mode is enabled.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Click on icon.png, found with tolerance of 99.7
mouseClick(waitForImage("icon.png", {'tolerant': True,
                                     'threshold': 99.7,
                                     'multiscale': True,
                                     'minScale': 100.0,
                                     'maxScale': 150.0})
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Click on icon.png, found with tolerance of 99.7
mouseClick(waitForImage("icon.png", {tolerant: true,
                                     threshold: 99.7,
                                     multiscale: true,
                                     minScale: 100.0,
                                     maxScale: 150.0}));
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Click on icon.png, found with tolerance of 99.7
mouseClick(waitForImage("icon.png", {tolerant =&gt; true,
                                     threshold =&gt; 99.7,
                                     multiscale =&gt; true,
                                     minScale =&gt; 100.0,
                                     maxScale =&gt; 150.0}));
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Click on icon.png, found with tolerance of 99.7
mouseClick(waitForImage("icon.png", {"tolerant" =&gt; true,
                                     "threshold" =&gt; 99.7,
                                     "multiscale" =&gt; true,
                                     "minScale" =&gt; 100.0,
                                     "maxScale" =&gt; 150.0}))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Click on icon.png, found with tolerance of 99.7
invoke mouseClick [waitForImage "icon.png" {tolerant true \
                                            threshold 99.7 \
                                            multiscale true \
                                            minScale 100.0 \
                                            maxScale 150.0}]
</pre></div><p>
In case a searchRegion is specified as the last argument, the search
is performed only within the area corresponding to it. The search
region can be an AUT object, a ScreenRectangle object or an array of
such objects. It can also be a special string value "all", in which
case all top-level objects are used.
</p><p>The searchRegion can also be an <a class="xref" href="rgs-squish.html#script-image-object" title="6.3.14. Image Object">Image</a> object. In such case no new screenshots
are taken and the specified image is used instead. Currently it is not
possible to limit the search scope to a portion of an <code class="code">Image</code>
object; please use the <a class="xref" href="rgs-squish.html#Image.copy-function"><code class="function">Image.copy</code></a> to cut
the relevant section. Since the <code class="code">Image</code> object specified
as the search region cannot possibly change overtime, this function
will not perform the image search repetitively and will return the
results immediately.</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Find icon.png on the MyWidget object
waitForImage("icon.png", {}, waitForObject( names.MyWidget ) )

# Find icon.png on multiple objects
waitForImage("icon.png", {}, [ waitForObject( names.MyWidget ),
                               waitForObject( names.MyOtherWidget ) ] )

# Find icon.png on the left half of the MyWidget object
bounds = object.globalBounds( waitForObject( names.MyWidget ) )
bounds.width = bounds.width / 2
waitForImage("icon.png", {}, bounds )

# Find icon.png in the specified area
waitForImage("icon.png", {}, UiTypes.ScreenRectangle( 100, 100, 200, 300 ) )

# Find icon.png on all top-level objects
waitForImage("icon.png", {}, "all" )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Find icon.png on the MyWidget object
waitForImage("icon.png", {}, waitForObject( names.MyWidget ) );

// Find icon.png on multiple objects
waitForImage("icon.png", {}, [ waitForObject( names.MyWidget ),
                               waitForObject( names.MyOtherWidget ) ] );

// Find icon.png on the left half of the MyWidget object
var bounds = object.globalBounds( waitForObject( names.MyWidget ) );
bounds.width = bounds.width / 2
waitForImage("icon.png", {}, bounds );

// Find icon.png in the specified area
waitForImage("icon.png", {}, UiTypes.ScreenRectangle( 100, 100, 200, 300 ) );

// Find icon.png on all top-level objects
waitForImage("icon.png", {}, "all" );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Find icon.png on the MyWidget object
waitForImage("icon.png", {}, waitForObject( names::MyWidget ) );

# Find icon.png on multiple objects
waitForImage("icon.png", {}, ( waitForObject( names::MyWidget ),
                               waitForObject( names::MyOtherWidget ) ) );

# Find icon.png on the left half of the MyWidget object
my $bounds = object::globalBounds( waitForObject( names::MyWidget ) );
$bounds-&gt;width = $bounds-&gt;width / 2;
waitForImage("icon.png", {}, bounds );

# Find icon.png in the specified area
waitForImage("icon.png", {}, new UiTypes::ScreenRectangle( 100, 100, 200, 300 ) );

# Find icon.png on all top-level objects
waitForImage("icon.png", {}, "all" )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Find icon.png on the MyWidget object
waitForImage("icon.png", {}, waitForObject( names.MyWidget ) );

# Find icon.png on multiple objects
waitForImage("icon.png", {}, [ waitForObject( names.MyWidget ),
                               waitForObject( names.MyOtherWidget ) ] );

# Find icon.png on the left half of the MyWidget object
bounds = Squish::Object.globalBounds( waitForObject( names.MyWidget ) );
bounds.width = bounds.width / 2
waitForImage("icon.png", {}, bounds );

# Find icon.png in the specified area
waitForImage("icon.png", {}, UiTypes::ScreenRectangle.new( 100, 100, 200, 300 ) );

# Find icon.png on all top-level objects
waitForImage("icon.png", {}, "all" );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Find icon.png on the MyWidget object
waitForImage "icon.png" {} [ waitForObject $names::MyWidget ]

# Find icon.png on multiple objects
waitForImage "icon.png" {} { [ waitForObject $names::MyWidget ],
                             [ waitForObject $names::MyOtherWidget ] }

# Find icon.png on the left half of the MyWidget object
set bounds [object globalBounds [ waitForObject $names::MyWidget ] ]
property set $bounds width [ expr [ property get $bounds width ] / 2 ]
waitForImage "icon.png" {} $bounds

# Find icon.png in the specified area
waitForImage "icon.png" {} [ construct ScreenRectangle 100 100 200 300 ]

# Find icon.png on all top-level objects
waitForImage "icon.png" {} "all"
</pre></div><div class="funcsynopsis"><a id="waitForOcrText-function"></a><p><code class="funcdef">ScreenRectangle <b class="fsfunc">waitForOcrText</b>(</code><var class="pdparam">text</var>, <var class="pdparam">[parameterMap]</var>, <var class="pdparam">[searchRegion]</var><code>)</code>;</p></div><p>
This function will perform optical character recognition on the
display also showing the currently running application and search for
the specific text within the result set. It will return a ScreenRectangle
object corresponding to the location of the text.
</p><p>
The OCR will be performed over all available screens making up
the desktop. At least on Windows and X11-based systems. For OCR on
multi-screen setup on macOS please inquire with technical support.
</p><p>
The search behavior can be configured through entries passed
via the optional <em class="parameter"><code>parameterMap</code></em> argument.
</p><div class="itemizedlist"><ul type="disc"><li><p> <em class="parameter"><code>interval</code></em> - Minimal number of
milliseconds to wait in between OCR search retries. The default is
1000 (1 second). The actual interval between separate OCR attempts is
dependent on OCR engine performance, and may be significantly longer.
</p></li><li><p> <em class="parameter"><code>timeout</code></em> - Amount of time in
milliseconds to search for the specified text before reporting that
the text is not found. The default is 20000 (20 seconds).
</p></li><li><p><em class="parameter"><code>occurrence</code></em> - The occurrence
index. By default the first text match (with index 1) will be
returned. Index values 2 and higher will select consecutive matches as
far as available.</p></li><li><p><em class="parameter"><code>language</code></em> - The language hint
for OCR engine. Use an empty string to use the OCR engine defaults.
The default value is the value of
<a class="xref" href="rgs-squish.html#testSettings.defaultOcrLanguage-property">testSettings.defaultOcrLanguage</a> property.
</p></li><li><p><em class="parameter"><code>profiles</code></em> - An array of OCR
engine specific profile names. This parameter is used only with
engines that support profiles.
</p></li><li><p><em class="parameter"><code>options</code></em> - A map of
engine-specific option names and values. These options are passed to
the OCR engine after loading the specified profiles.
</p></li><li><p><em class="parameter"><code>scaleFactor</code></em> - Image up-scale
factor. The source image is upscaled by that factor before it is
passed to the OCR engine. The default value is
<code class="constant">3.5</code>. It can be set to a lower value to improve
the OCR performance in case the text is rendered with a large font.
</p></li></ul></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Click on second 'Hier klicken' occurrence, wait maximum 10 seconds
mouseClick(waitForOcrText("Hier klicken", {"occurrence": 2, "language": "German"})
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Click on second 'Hier klicken' occurrence, wait maximum 10 seconds
mouseClick(waitForOcrText("Hier klicken", {occurrence: 2, language: "German"}));
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Click on second 'Hier klicken' occurrence, wait maximum 10 seconds
mouseClick(waitForOcrText("Hier klicken", {"occurrence" =&gt; 2, "language" =&gt; "German"}));
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Click on second 'Hier klicken' occurrence, wait maximum 10 seconds
mouseClick(waitForOcrText("Hier klicken", {"occurrence" =&gt; 2, "language" =&gt; "German"}))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Click on second 'Hier klicken' occurrence, wait maximum 10 seconds
invoke mouseClick [waitForOcrText "Hier klicken" {occurrence 2 language "German"}]
</pre></div><p>By default this function will repeatedly grab the screen content
until successful or until 20 seconds have passed. Longer (or shorter)
waiting periods can be set in milliseconds via a <code class="code">timeout</code>
value passed through the <em class="parameter"><code>parameterMap</code></em>. In order
to perform a single OCR search, use the
<a class="xref" href="rgs-squish.html#findOcrText-function"><code class="function">findOcrText</code></a> function.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Click on second 'Click me' occurrence, wait maximum 10 seconds
mouseClick(waitForOcrText("Click me", {"occurrence": 2, "timeout": 10000})
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Click on second 'Click me' occurrence, wait maximum 10 seconds
mouseClick(waitForOcrText("Click me", {occurrence: 2, timeout: 10000}));
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Click on second 'Click me' occurrence, wait maximum 10 seconds
mouseClick(waitForOcrText("Click me", {"occurrence" =&gt; 2, "timeout" =&gt; 10000}));
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Click on second 'Click me' occurrence, wait maximum 10 seconds
mouseClick(waitForOcrText("Click me", {"occurrence" =&gt; 2, "timeout" =&gt; 10000}))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Click on second 'Click me' occurrence, wait maximum 10 seconds
invoke mouseClick [waitForOcrText "Click me" {occurrence 2 timeout 10000}]
</pre></div><p>
In case a searchRegion is specified as the last argument, the OCR
is performed only within the area corresponding to it. The search
region can be an AUT object, a ScreenRectangle object or an array of
such objects. It can also be a special string value "all", in which
case all top-level objects are used.
</p><p>The searchRegion can also be an <a class="xref" href="rgs-squish.html#script-image-object" title="6.3.14. Image Object">Image</a> object. In such case no new screenshots
are taken and the specified image is used instead. Currently it is not
possible to limit the OCR scope to a portion of an <code class="code">Image</code>
object; please use the <a class="xref" href="rgs-squish.html#Image.copy-function"><code class="function">Image.copy</code></a> to cut
the relevant section. Since the <code class="code">Image</code> object specified
as the search region cannot possibly change overtime, this function
will not perform the OCR repetitively and will return the results
immediately.</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Click on text on the MyWidget object
mouseClick( waitForOcrText( "Click me", {}, waitForObject( names.MyWidget ) )

# Click on text on multiple objects
mouseClick( waitForOcrText( "Click me", {}, [ waitForObject( names.MyWidget ),
                                              waitForObject( names.MyOtherWidget ) ] ) )

# Click on text on the left half of the MyWidget object
bounds = object.globalBounds( waitForObject( names.MyWidget ) )
bounds.width = bounds.width / 2
mouseClick( waitForOcrText( "Click me", {}, bounds ) )

# Click on text in the specified area
mouseClick( waitForOcrText( "Click me", {}, UiTypes.ScreenRectangle( 100, 100, 200, 300 ) ) )

# Click on text on all top-level objects
mouseClick( waitForOcrText( "Click me", {}, "all" ) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
# Click on text on the MyWidget object
mouseClick( waitForOcrText( "Click me", {}, waitForObject( names.MyWidget ) ) );

// Click on text on multiple objects
mouseClick( waitForOcrText( "Click me", {}, [ waitForObject( names.MyWidget ),
                                              waitForObject( names.MyOtherWidget ) ] ) );

// Click on text on the left half of the MyWidget object
var bounds = object.globalBounds( waitForObject( names.MyWidget ) );
bounds.width = bounds.width / 2
mouseClick( waitForOcrText( "Click me", {}, bounds ) );

// Click on text in the specified area
mouseClick( waitForOcrText( "Click me", {}, new UiTypes.ScreenRectangle( 100, 100, 200, 300 ) ) );

// Click on text on all top-level objects
mouseClick( waitForOcrText( "Click me", {}, "all" ) );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Click on text on the MyWidget object
mouseClick( waitForOcrText( "Click me", {}, waitForObject( names::MyWidget ) ) );

# Click on text on multiple objects
mouseClick( waitForOcrText( "Click me", {}, ( waitForObject( names::MyWidget ),
                                              waitForObject( names::MyOtherWidget ) ) ) );

# Click on text on the left half of the MyWidget object
my $bounds = object::globalBounds( waitForObject( names::MyWidget ) );
$bounds-&gt;width = $bounds-&gt;width / 2;
mouseClick( waitForOcrText( "Click me", {}, bounds ) );

# Click on text in the specified area
mouseClick( waitForOcrText( "Click me", {}, new UiTypes::ScreenRectangle( 100, 100, 200, 300 ) ) );

# Click on text on all top-level objects
mouseClick( waitForOcrText( "Click me", {}, "all" ) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Click on text on the MyWidget object
mouseClick( waitForOcrText( "Click me", {}, waitForObject( names.MyWidget ) ) );

# Click on text on multiple objects
mouseClick( waitForOcrText( "Click me", {}, [ waitForObject( names.MyWidget ),
                                              waitForObject( names.MyOtherWidget ) ] ) );

# Click on text on the left half of the MyWidget object
bounds = Squish::Object.globalBounds( waitForObject( names.MyWidget ) );
bounds.width = bounds.width / 2
mouseClick( waitForOcrText( "Click me", {}, bounds ) );

# Click on text in the specified area
mouseClick( waitForOcrText( "Click me", {}, UiTypes::ScreenRectangle.new( 100, 100, 200, 300 ) ) );

# Click on text on all top-level objects
mouseClick( waitForOcrText( "Click me", {}, "all" ) );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Click on text on the MyWidget object
invoke mouseClick [ waitForOcrText "Click me" {} [ waitForObject $names::MyWidget ] ]

# Click on text on multiple objects
invoke mouseClick [ waitForOcrText "Click me" {} { [ waitForObject $names::MyWidget ],
                                                   [ waitForObject $names::MyOtherWidget ] } ]

# Click on text on the left half of the MyWidget object
set bounds [object globalBounds [ waitForObject $names::MyWidget ] ]
property set $bounds width [ expr [ property get $bounds width ] / 2 ]
invoke mouseClick [ waitForOcrText "Click me" {} $bounds ]

# Click on text in the specified area
invoke mouseClick [ waitForOcrText "Click me" {} [ construct ScreenRectangle 100 100 200 300 ] ]

# Click on text on all top-level objects
invoke mouseClick [ waitForOcrText "Click me" {} "all" ]
</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="interaction.functions"></a>6.3.5. Interaction Functions</h3></div></div></div><div class="funcsynopsis"><a id="doubleClick-function"></a><p><code class="funcdef"><b class="fsfunc">doubleClick</b>(</code><var class="pdparam">screenPoint</var>, <var class="pdparam">modifierState</var>, <var class="pdparam">button</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">doubleClick</b>(</code><var class="pdparam">screenRectangle</var>, <var class="pdparam">modifierState</var>, <var class="pdparam">button</var><code>)</code>;</p></div><p>
This function performs a mouse double click at the position specified by
<em class="parameter"><code>screenPoint</code></em> or at the center of the rectangle specified
by <em class="parameter"><code>screenRectangle</code></em>. Both positions are in screen global
coordinates. The optional <em class="parameter"><code>modifierState</code></em> and
<em class="parameter"><code>button</code></em> arguments specify keyboard modifiers and the
mouse button that are held down during the click. See <a class="xref" href="rgs-squish.html#squishapi.function.parameters" title="Squish API Function Parameters"><span class="emphasis"><em>Squish</em></span> API Function Parameters</a> for a list of valid modifierState
and button values.
</p><div class="funcsynopsis"><a id="keyPress-function"></a><p><code class="funcdef"><b class="fsfunc">keyPress</b>(</code><var class="pdparam">key</var><code>)</code>;</p></div><p>
This function performs a key press of the specified <em class="parameter"><code>key</code></em>
keyboard key. This <em class="parameter"><code>key</code></em> argument is either a single
character or a special key which is written between angle brackets (&lt;&gt;).
E.g. <code class="code">"&lt;Ctrl&gt;"</code> for the control key,
<code class="code">"&lt;Alt&gt;"</code> for the alt key, <code class="code">"&lt;Shift&gt;"</code>,
<code class="code">"&lt;Return&gt;"</code> for the enter key and <code class="code">"&lt;Tab&gt;"</code>
for the tab key.
</p><div class="funcsynopsis"><a id="keyRelease-function"></a><p><code class="funcdef"><b class="fsfunc">keyRelease</b>(</code><var class="pdparam">key</var><code>)</code>;</p></div><p>
This function performs a key release of the specified <em class="parameter"><code>key</code></em>
keyboard key. This <em class="parameter"><code>key</code></em> argument is either a single
character or a special key which is written between angle brackets (&lt;&gt;),
see <a class="xref" href="rgs-squish.html#keyPress-function"><code class="function">keyPress</code></a>.
</p><div class="funcsynopsis"><a id="mouseClick-function"></a><p><code class="funcdef"><b class="fsfunc">mouseClick</b>(</code><var class="pdparam">screenPoint</var>, <var class="pdparam">modifierState</var>, <var class="pdparam">button</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mouseClick</b>(</code><var class="pdparam">screenRectangle</var>, <var class="pdparam">modifierState</var>, <var class="pdparam">button</var><code>)</code>;</p></div><p>
This function performs a mouse click at the position specified by
<em class="parameter"><code>screenPoint</code></em> or at the center of the rectangle specified
by <em class="parameter"><code>screenRectangle</code></em>. Both positions are in screen global
coordinates. The optional <em class="parameter"><code>modifierState</code></em> and
<em class="parameter"><code>button</code></em> arguments specify keyboard modifiers and the
mouse button that are held down during the click. See <a class="xref" href="rgs-squish.html#squishapi.function.parameters" title="Squish API Function Parameters"><span class="emphasis"><em>Squish</em></span> API Function Parameters</a> for a list of valid modifierState
and button values.
</p><div class="funcsynopsis"><a id="mouseMove-function"></a><p><code class="funcdef"><b class="fsfunc">mouseMove</b>(</code><var class="pdparam">x</var>, <var class="pdparam">y</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mouseMove</b>(</code><var class="pdparam">objectOrName</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mouseMove</b>(</code><var class="pdparam">objectOrName</var>, <var class="pdparam">x</var>, <var class="pdparam">y</var><code>)</code>;</p></div><p>
This function moves the mouse to position <em class="parameter"><code>x</code></em> and
<em class="parameter"><code>y</code></em> relative to the top-left of the
<em class="parameter"><code>objectOrName</code></em> widget if one is specified, or
relative to the current screen otherwise.
</p><p>
If no coordinates are specified, the mouse is moved to the middle of the
<em class="parameter"><code>objectOrName</code></em> widget.
</p><p>
This function is useful if you want to trigger events that need the
mouse to be at a particular position. For example, tooltips normally
only appear when the mouse is over a certain area.
</p><div class="funcsynopsis"><a id="mousePress-function"></a><p><code class="funcdef"><b class="fsfunc">mousePress</b>(</code><var class="pdparam"></var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mousePress</b>(</code><var class="pdparam">mouseButton</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mousePress</b>(</code><var class="pdparam">mouseButton</var>, <var class="pdparam">modifierState</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mousePress</b>(</code><var class="pdparam">x</var>, <var class="pdparam">y</var>, <var class="pdparam">mouseButton</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mousePress</b>(</code><var class="pdparam">x</var>, <var class="pdparam">y</var>, <var class="pdparam">mouseButton</var>, <var class="pdparam">modifierState</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mousePress</b>(</code><var class="pdparam">objectOrName</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mousePress</b>(</code><var class="pdparam">objectOrName</var>, <var class="pdparam">mouseButton</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mousePress</b>(</code><var class="pdparam">objectOrName</var>, <var class="pdparam">mouseButton</var>, <var class="pdparam">modifierState</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mousePress</b>(</code><var class="pdparam">objectOrName</var>, <var class="pdparam">x</var>, <var class="pdparam">y</var>, <var class="pdparam">mouseButton</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mousePress</b>(</code><var class="pdparam">objectOrName</var>, <var class="pdparam">x</var>, <var class="pdparam">y</var>, <var class="pdparam">mouseButton</var>, <var class="pdparam">modifierState</var><code>)</code>;</p></div><p>
This function performs a mouse press. All the parameters are optional,
but either both or neither of the coordinates (x,y) must be present.
</p><p>
If <em class="parameter"><code>x</code></em> and <em class="parameter"><code>y</code></em> coordinates are
given, the press takes place at those coordinates, either relative to the
<em class="parameter"><code>objectOrName</code></em> object if one is specified, or
relative to the current screen otherwise. If no coordinates are given
the press takes place on the middle of the
<em class="parameter"><code>objectOrName</code></em> object if one is specified, or
wherever the mouse happens to be otherwise.
</p><p>
By default <code class="code">MouseButton.LeftButton</code> is used, but this can be
changed by specifying the optional <em class="parameter"><code>mouseButton</code></em>
argument. Similarly a default modifier state of no modifiers is used,
but this can be changed by specifying the
<em class="parameter"><code>modifierState</code></em> argument. See <a class="xref" href="rgs-squish.html#squishapi.function.parameters" title="Squish API Function Parameters"><span class="emphasis"><em>Squish</em></span> API Function Parameters</a> for which values are valid for
the <em class="parameter"><code>mouseButton</code></em> argument and for the
<em class="parameter"><code>modifierState</code></em> argument.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>
When executing tests on Windows systems, <code class="code">MouseButton.PrimaryButton</code>
is used by default instead of <code class="code">MouseButton.LeftButton</code>. This means
that <span class="emphasis"><em>Squish</em></span> will perform a click with the right mouse button in case Windows
was configured to have swapped mouse buttons.
</p></td></tr></table></div><p>
There is a toolkit-specific version of this function that may have
different arguments:
<a class="xref" href="rgs-windowsconvenienceapi.html#win-mousePress-function"><code class="function">mousePress</code></a> (Windows).
</p><div class="funcsynopsis"><a id="mouseRelease-function"></a><p><code class="funcdef"><b class="fsfunc">mouseRelease</b>(</code><var class="pdparam"></var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mouseRelease</b>(</code><var class="pdparam">mouseButton</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mouseRelease</b>(</code><var class="pdparam">mouseButton</var>, <var class="pdparam">modifierState</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mouseRelease</b>(</code><var class="pdparam">x</var>, <var class="pdparam">y</var>, <var class="pdparam">mouseButton</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mouseRelease</b>(</code><var class="pdparam">x</var>, <var class="pdparam">y</var>, <var class="pdparam">mouseButton</var>, <var class="pdparam">modifierState</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mouseRelease</b>(</code><var class="pdparam">objectOrName</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mouseRelease</b>(</code><var class="pdparam">objectOrName</var>, <var class="pdparam">mouseButton</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mouseRelease</b>(</code><var class="pdparam">objectOrName</var>, <var class="pdparam">mouseButton</var>, <var class="pdparam">modifierState</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mouseRelease</b>(</code><var class="pdparam">objectOrName</var>, <var class="pdparam">x</var>, <var class="pdparam">y</var>, <var class="pdparam">mouseButton</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">mouseRelease</b>(</code><var class="pdparam">objectOrName</var>, <var class="pdparam">x</var>, <var class="pdparam">y</var>, <var class="pdparam">mouseButton</var>, <var class="pdparam">modifierState</var><code>)</code>;</p></div><p>
This function performs a mouse release. All the parameters are optional
excepting that either both or neither of the coordinates must be present.
</p><p>
If <em class="parameter"><code>x</code></em> and <em class="parameter"><code>y</code></em> coordinates are
given, the release takes place at those coordinates, either relative to the
<em class="parameter"><code>objectOrName</code></em> object if one is specified, or
relative to the current screen otherwise. If no coordinates are given
the release takes place on the middle of the
<em class="parameter"><code>objectOrName</code></em> object if one is specified, or
wherever the mouse happens to be otherwise.
</p><p>
By default <code class="code">MouseButton.LeftButton</code> is used, but this can be
changed by specifying the optional <em class="parameter"><code>mouseButton</code></em>
argument. Similarly a default modifier state of no modifiers is used,
but this can be changed by specifying the
<em class="parameter"><code>modifierState</code></em> argument. See <a class="xref" href="rgs-squish.html#squishapi.function.parameters" title="Squish API Function Parameters"><span class="emphasis"><em>Squish</em></span> API Function Parameters</a> for which values are valid for
the <em class="parameter"><code>mouseButton</code></em> argument and for the
<em class="parameter"><code>modifierState</code></em> argument.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>
When executing tests on Windows systems, <code class="code">MouseButton.PrimaryButton</code>
is used by default instead of <code class="code">MouseButton.LeftButton</code>. This means
that <span class="emphasis"><em>Squish</em></span> will perform a click with the right mouse button in case Windows
was configured to have swapped mouse buttons.
</p></td></tr></table></div><p>
There is a toolkit-specific version of this function that may have
different arguments:
<a class="xref" href="rgs-windowsconvenienceapi.html#win-mouseRelease-function"><code class="function">mouseRelease</code></a> (Windows).
</p><div class="funcsynopsis"><a id="tapObject-function"></a><p><code class="funcdef"><b class="fsfunc">tapObject</b>(</code><var class="pdparam">screenPoint</var>, <var class="pdparam">modifierState</var>, <var class="pdparam">button</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">tapObject</b>(</code><var class="pdparam">screenRectangle</var>, <var class="pdparam">modifierState</var>, <var class="pdparam">button</var><code>)</code>;</p></div><p>
This function performs a touch tap at the position specified by
<em class="parameter"><code>screenPoint</code></em> or at the center of the rectangle specified
by <em class="parameter"><code>screenRectangle</code></em>. Both positions are in screen global
coordinates. The optional <em class="parameter"><code>modifierState</code></em> and
<em class="parameter"><code>button</code></em> arguments specify keyboard modifiers and the
mouse button that are held down during the click. See <a class="xref" href="rgs-squish.html#squishapi.function.parameters" title="Squish API Function Parameters"><span class="emphasis"><em>Squish</em></span> API Function Parameters</a> for a list of valid modifierState
and button values.
</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-debugging"></a>6.3.6. Debugging Functions</h3></div></div></div><div class="funcsynopsis"><a id="className-function"></a><p><code class="funcdef">str <b class="fsfunc">className</b>(</code><var class="pdparam">object</var><code>)</code>;</p></div><p>
This function returns the <em class="parameter"><code>object</code></em>'s class name as
a string.
(A suitable object can be obtained using the <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a> function or the
<a class="xref" href="rgs-squish.html#findObject-function"><code class="function">findObject</code></a> function.)
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Python-specific"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Python-specific</th></tr><tr><td align="left" valign="top"><p>
This function is only available to Python test scripts; for other script
languages use the <a class="xref" href="rgs-squish.html#typeName-function"><code class="function">typeName</code></a> function.
</p></td></tr></table></div><div class="funcsynopsis"><a id="highlightObject-function"></a><p><code class="funcdef"><b class="fsfunc">highlightObject</b>(</code><var class="pdparam">objectOrName</var>, <var class="pdparam">[msec]</var><code>)</code>;</p></div><p>
This function highlights the screen position of the object specified
by <em class="parameter"><code>objectOrName</code></em> through a red rectangle. Such a
visual confirmation can be useful if there is doubt about whether
an object found via <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a>,
<a class="xref" href="rgs-squish.html#waitForImage-function"><code class="function">waitForImage</code></a> and related functions is the
correct object.
</p><p>
The red overlay will remain on the screen for 3 seconds unless
overridden by the optional <em class="parameter"><code>timeout</code></em> parameter.
</p><div class="funcsynopsis"><a id="isNull-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">isNull</b>(</code><var class="pdparam">object</var><code>)</code>;</p></div><p>
This function returns a true value if the <em class="parameter"><code>object</code></em>
is null (e.g., a null-pointer in C++); otherwise it returns a false
value.
(A suitable object can be obtained using the <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a> function or the
<a class="xref" href="rgs-squish.html#findObject-function"><code class="function">findObject</code></a> function.)
</p><div class="funcsynopsis"><a id="typeName-function"></a><p><code class="funcdef">String <b class="fsfunc">typeName</b>(</code><var class="pdparam">object</var><code>)</code>;</p></div><p>
This function returns the <em class="parameter"><code>object</code></em>'s class name as
a string.
(A suitable object can be obtained using the <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a> function or the
<a class="xref" href="rgs-squish.html#findObject-function"><code class="function">findObject</code></a> function.)
For objects that are created in test scripts, this is their
actual type name. For widgets and other application objects, <span class="emphasis"><em>Squish</em></span>
tries to return the correct type name, and if that isn't possible,
returns "Object", the name of <span class="emphasis"><em>Squish</em></span>'s generic object type, instead.
</p><p>
JavaScript, Perl, Ruby, and Tcl scripts should always return the correct
type name. Python scripts usually return "Object" for application
objects, but <span class="emphasis"><em>Squish</em></span>'s API for Python includes the <a class="xref" href="rgs-squish.html#className-function"><code class="function">className</code></a> function, which returns the correct class
name of the object it is given, whether that object is created in a test
script or is an application object.
</p><div class="funcsynopsis"><a id="test.breakpoint-function"></a><p><code class="funcdef"><b class="fsfunc">test.breakpoint</b>(</code><var class="pdparam"></var><code>)</code>;</p></div><p>
This function will cause the debugger to stop at this position.
</p><div class="funcsynopsis"><a id="test.attachFile-function"></a><p><code class="funcdef"><b class="fsfunc">test.attachFile</b>(</code><var class="pdparam">pathToFile</var>, <var class="pdparam">message</var><code>)</code>;</p></div><p>
This function will copy the file referenced by <em class="parameter"><code>pathToFile</code></em> into the
test report directory specified when starting Squish and create an entry
in the test report pointing to the file copy if the report generator supports
this. The optional <em class="parameter"><code>message</code></em> allows to specify a short
description of the attachment and will be included in the report as well.
</p><p>
The <em class="parameter"><code>pathToFile</code></em> can specify the file to attach using an
absolute or a relative path. In the case that a relative is being used it'll be
appended to the current working directory of the script interpreter running the
test.
</p><p>
Currently only the XML3, the HTML and the JSON report generators have dedicated
support for attachments. Other generators can be used with test.attachFile, but
will only generate a normal log message including the path to the attached file
and the provided <em class="parameter"><code>message</code></em>.
</p><p>
The copied file will appear in an attachments subdirectory that is going
to be inside a directory named after the testcase. In turn the testcase
directory will be inside a directory named after the suite, which is placed
in the test report directory. The name of the copied file will match the
file name of the originally specified file. If a file of that name already
exists in the report directory a number will be added to make the file name
unique.
</p><p>
For report generators that do not require specifying a test report directory
but rather take a file (like xml2, xml or xmljunit) you can either specify
<code class="option">--resultdir</code> when <a class="link" href="rg-cmdline.html#rg-squishrunner-cli--testsuite" title="7.4.3.3. squishrunner --testsuite: Running tests in batch mode">invoking squishrunner</a> to
specify the test report directory or Squish will fall back to generate the
attachments directory inside the testcase that is currently being executed when
test.attachFile is being invoked.
</p><div class="funcsynopsis"><a id="test.attachDesktopScreenshot-function"></a><p><code class="funcdef"><b class="fsfunc">test.attachDesktopScreenshot</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><p>
This function will create a screenshot of the desktop from the system where the
currently active AUT is running and store that in the test report directory. In
addition an entry is being logged in the test report indicating the path of the
screenshot file as well as including the specified <em class="parameter"><code>message</code></em>.
</p><p>
The screenshot will be stored in the lossless PNG format under the
same attachments subdirectory as files attached using the <a class="xref" href="rgs-squish.html#test.attachFile-function"><code class="function">test.attachFile</code></a> function and thus the same
restrictions and comments regarding the used report generator apply for this
function too.
</p><p>
This API is a shorthand for <code class="code">test.attachImage(grabDesktopScreenshot(),
message)</code>.
</p><div class="funcsynopsis"><a id="test.attachImage-function"></a><p><code class="funcdef"><b class="fsfunc">test.attachImage</b>(</code><var class="pdparam">image</var>, <var class="pdparam">message</var><code>)</code>;</p></div><p>
This function will store the specified image in the test report directory. In
addition an entry is being logged in the test report indicating the path of the
image file as well as including the specified <em class="parameter"><code>message</code></em>.
</p><p>
The image will be stored in the lossless PNG format under the
same attachments subdirectory as files attached using the <a class="xref" href="rgs-squish.html#test.attachFile-function"><code class="function">test.attachFile</code></a> function and thus the same
restrictions and comments regarding the used report generator apply for this
function too.
</p><div class="funcsynopsis"><a id="test.startVideoCapture-function"></a><p><code class="funcdef"><b class="fsfunc">test.startVideoCapture</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><p>
This function will start the desktop video capture on the system where the application under test
is running. The video file will be stored as part of the test report and logged in the test report
using the specified <em class="parameter"><code>message</code></em>. The <em class="parameter"><code>message</code></em> is optional:
if it is not specified, a default message containing the application name will be added to the report.
</p><p>
At any point in the script, there can be only one video capture for a given application context.
Attempting to start another video capture on the same application context will result in an error.
</p><p>
The video capture will be stopped when the application under test terminates or is disconnected
from, either through the test script commands or as part of the ending of the test case. In case
of sudden, unexpected terminations of the application under test, the video file
may be incomplete.
</p><p>
The video capture can be explicitly terminated at any point after starting it using the
<a class="xref" href="rgs-squish.html#test.stopVideoCapture-function"><code class="function">test.stopVideoCapture</code></a>.
</p><p>
If video capture is enabled for all applications through <code class="option">--enable-video-capture</code>
commandline option, then this function will only add a log message to the test report (see also
<a class="xref" href="rg-cmdline.html#rg-squishrunner-cli-playback--enable-video-capture" title="7.4.3.8. Playback option --enable-video-capture">Playback option <code class="option">--enable-video-capture</code> (Section 7.4.3.8)</a>).
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>
The video capture feature has some technical limitations. Please refer to the page
<a class="ulink" href="https://kb.froglogic.com/squish/known-issues/video-capture-limitations/" target="_blank">Known Video Capture Limitations</a> in our Knowledge Base for more information.
</p></td></tr></table></div><div class="funcsynopsis"><a id="test.stopVideoCapture-function"></a><p><code class="funcdef"><b class="fsfunc">test.stopVideoCapture</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><p>
This function will stop the desktop video capture on the system where the application under test
is running. The end of the video capture will be logged in the test report using the specified
<em class="parameter"><code>message</code></em>.The <em class="parameter"><code>message</code></em> is optional: if it is not
specified, a default message containing the application name will be added to the report.
</p><p>
Attempting to stop video capture where no capture is currently active will result in an exception
being thrown. Starting the video capture is done through <a class="xref" href="rgs-squish.html#test.startVideoCapture-function"><code class="function">test.startVideoCapture</code></a>,
or by enabling it on the commandline using <code class="option">--enable-video-capture"</code> option
(see also <a class="xref" href="rg-cmdline.html#rg-squishrunner-cli-playback--enable-video-capture" title="7.4.3.8. Playback option --enable-video-capture">Playback option <code class="option">--enable-video-capture</code> (Section 7.4.3.8)</a>).
</p><p>
  If video capture is enabled for all applications through <code class="option">--enable-video-capture</code>
  commandline option, then this function will only add a log message to the test report. The video
  capture will be terminated automatically when the application has been terminated.
</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-conversions"></a>6.3.7. Conversion Functions</h3></div></div></div><div class="funcsynopsis"><a id="cast-function"></a><p><code class="funcdef">Object <b class="fsfunc">cast</b>(</code><var class="pdparam">object</var>, <var class="pdparam">type</var><code>)</code>;</p></div><p>
Casts the <em class="parameter"><code>object</code></em> to the given
<em class="parameter"><code>type</code></em> and returns a reference to that object, or
to a new copy of the object if the <em class="parameter"><code>object</code></em> is of
an immutable type. (A suitable object can be obtained using the <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a> function or the <a class="xref" href="rgs-squish.html#findObject-function"><code class="function">findObject</code></a> function.) The desired
<em class="parameter"><code>type</code></em> can be specified either by name (as a
string) or by using a type object.
</p><p>
For mutable objects the <em class="parameter"><code>object</code></em> itself is
modified.
</p><p>
If the cast fails the object reference is returned unchanged.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Python-specific: Type
Conversions"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"><a id="python.specific.type.conversions"></a>Python-specific: Type
Conversions</th></tr><tr><td align="left" valign="top"><p>
Python programmers should be aware that integer type conversions such as
<code class="code">int(x)</code> will <span class="emphasis"><em>not</em></span> work; use <code class="code">x =
cast(x, int)</code> or <code class="code">x = cast(x, "int")</code> instead. Or if
you prefer, do <code class="code">import __builtin__</code> (Python 2) or
<code class="code">import builtins</code> (Python 3), and then use <code class="code">x =
__builtin__.int(x)</code> (Python 2) or <code class="code">x = builtins.int(x) (Python 3)
</code>. (This is necessary because <span class="emphasis"><em>Squish</em></span> implements its own <code class="code">int</code>
object in Python.)
</p></td></tr></table></div><p>
This function makes it possible to downcast (e.g., from
<code class="code">QWidget</code> to <code class="code">QTextEdit</code>).
See <a class="xref" href="ugs-eventhandlers.html#ugseh-object" title="5.10.3. Event Handlers for Specific Objects">Event Handlers for Specific Objects (Section 5.10.3)</a> for an example of use.
See also the <a class="xref" href="rgs-squish.html#object.convertTo-function"><code class="function">object.convertTo</code></a>
function.
</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-teststatements"></a>6.3.8. Verification Functions</h3></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="rgs-squish.html#bracketing-function-calls">6.3.8.1. Ensuring that functions are always called pairwise</a></span></dt><dt><span class="section"><a href="rgs-squish.html#grouping-testresults-into-sections-api">6.3.8.2.  Grouping test results into sections </a></span></dt><dt><span class="section"><a href="rgs-squish.html#comparing-files-api">6.3.8.3.  Comparing Files </a></span></dt></dl></div><p>
The compare, verify, and exception functions are used to record the
results of tests applied to a running AUT in <span class="emphasis"><em>Squish</em></span>'s test log as
passes or fails. The other functions can be used to programmatically
record any kind of test results in the test log. (See also, the <a class="xref" href="ide.views.html#ide.verification.point.creator.view" title="8.2.22. Verification Point Creator view">Verification Point Creator view (Section 8.2.22)</a> and <a class="xref" href="ug-vps.html" title="5.22. How to Create and Use Verification Points">How to Create and Use Verification Points (Section 5.22)</a>.)
</p><div class="funcsynopsis"><a id="grabDesktopScreenshot-function"></a><p><code class="funcdef"><b class="fsfunc">grabDesktopScreenshot</b>(</code><code>)</code>;</p></div><p>
This function grabs an image of the screen the AUT is running on and
returns it as a <a class="xref" href="rgs-squish.html#script-image-object" title="6.3.14. Image Object">Image Object (Section 6.3.14)</a>.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var img = grabDesktopScreenshot();
test.attachImage(img);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
my $img = grabDesktopScreenshot();
test::attachImage($img);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
img = grabDesktopScreenshot()
test.attachImage(img)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
img = grabDesktopScreenshot()
Test.attachImage(img)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set img [grabDesktopScreenshot]
test attachImage $img
</pre></div><div class="funcsynopsis"><a id="saveDesktopScreenshot-function"></a><p><code class="funcdef"><b class="fsfunc">saveDesktopScreenshot</b>(</code><var class="pdparam">filename</var><code>)</code>;</p></div><p>
This function grabs an image of the screen the AUT is
running on and stores it on the computer where the Squish
IDE (or squishrunner) is executing.
</p><p>
If no path is specified the file gets stored in the working
directory of the squishrunner process. (The default working
directory of squishrunner is the path of the test case that
it is currently executing.)
</p><p>
If a relative path is specified it is relative to the working
directory of the squishrunner process. (The default working
directory of squishrunner is the path of the test case that
it is currently executing.)
</p><p>
If an absolute path is specified that path is used as is.
</p><p> The filename should have a suffix denoting the image
format to be used. Here's an example of use that is legal in JavaScript,
Python, Ruby, and Perl:
</p><pre class="programlisting">
saveDesktopScreenshot("screen.png");
</pre><p>And for Tcl:</p><pre class="programlisting">
saveDesktopScreenshot "screen.png"
</pre><p>
The available formats vary, but will always include at least the
following:
</p><div class="itemizedlist"><ul type="disc" compact><li><p><code class="code">.bmp</code> — Windows Bitmap</p></li><li><p><code class="code">.png</code> — Portable Network Graphics</p></li><li><p><code class="code">.ppm</code> — Portable Pixmap</p></li><li><p><code class="code">.xbm</code> — X11 Bitmap (monochrome)</p></li><li><p><code class="code">.xpm</code> — X11 Pixmap</p></li></ul></div><p>
This API is a shorthand for calling
<a class="xref" href="rgs-squish.html#grabDesktopScreenshot-function"><code class="function">grabDesktopScreenshot</code></a> followed by a call
to <a class="xref" href="rgs-squish.html#Image.save-function"><code class="function">Image.save</code></a> on the resulting image.
</p><div class="funcsynopsis"><a id="saveObjectSnapshot-function"></a><p><code class="funcdef"><b class="fsfunc">saveObjectSnapshot</b>(</code><var class="pdparam">objectNameOrReference</var>, <var class="pdparam">snapshotImageFile.xml</var><code>)</code>;</p></div><p>
This function grabs a snapshot of an object and saves it to the specified file
in the xml format. The object snapshot is a state of an object, including all
of its properties and its children with children's properties.
</p><p>
If a relative path of the snapshot is specified, it is relative to the working
directory of the squishrunner process. (The default working
directory of squishrunner is the path of the test case that
it is currently executing.)
</p><p>
If an absolute path is specified that path is used as is.
</p><p>
What is actually saved in the snapshot can be customized by making changes to
another .xml file located in
<code class="filename">SQUISHDIR/etc/&lt;edition&gt;_snapshot_filter.xml</code>,
where &lt;edition&gt; is the <span class="emphasis"><em>Squish</em></span> edition you are using,
such as <code class="literal">java</code>, <code class="literal">qt</code>, <code class="literal">web</code>,
<code class="literal">windows</code>, <code class="literal">mac</code>, <code class="literal">ios</code>, or
<code class="literal">android</code>. With this, you can exclude certain classes or
properties of classes, and decide if the real name or the symbolic name should
be included in the output.
</p><p>Here's an example of use that is legal in JavaScript, Python, Ruby, and Perl:
</p><pre class="programlisting">
saveObjectSnapshot( objectNameOrReference, "objectSnapshot.xml" );
</pre><p>And for Tcl:</p><pre class="programlisting">
saveObjectSnapshot objectNameOrReference "objectSnapshot.xml"
</pre><div class="funcsynopsis"><a id="test.compare-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">test.compare</b>(</code><var class="pdparam">value1</var>, <var class="pdparam">value2</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Boolean <b class="fsfunc">test.compare</b>(</code><var class="pdparam">value1</var>, <var class="pdparam">value2</var>, <var class="pdparam">message</var><code>)</code>;</p></div><p>
This function compares <em class="parameter"><code>value1</code></em> and
<em class="parameter"><code>value2</code></em>, and if they are equal, a test result of
type PASS is added to the test log and this function returns a true
value. Otherwise a test result of type FAIL is added to the test log and
a false value is returned.
</p><p>
If the optional <em class="parameter"><code>message</code></em> parameter (of type
string—e.g., a comment, bug number, or test plan reference)
is present, it will be added to the test result no matter whether the
test passed or failed.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.breakOnFailure-property">testSettings.breakOnFailure</a> property
can be used to make the debugger stop in case the verification fails.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.throwOnFailure-property">testSettings.throwOnFailure</a> property
can be used to make this function raise a script exception in case
the verification fails.
</p><div class="funcsynopsis"><a id="test.exception-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">test.exception</b>(</code><var class="pdparam">code</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Boolean <b class="fsfunc">test.exception</b>(</code><var class="pdparam">code</var>, <var class="pdparam">message</var><code>)</code>;</p></div><p>
This function
executes the code passed as a string in <em class="parameter"><code>code</code></em>,
expecting it to raise an exception. If an exception is raised a test
result of type PASS is added to the test log and
this function returns a true value. Otherwise a test result of
type FAIL is added to the test log and a false value is returned.
</p><p>
If the optional <em class="parameter"><code>message</code></em> parameter (of type
string—e.g., a comment, bug number, or test plan reference)
is present, it will be added to the test result no matter whether the
test passed or failed.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.breakOnFailure-property">testSettings.breakOnFailure</a> property
can be used to make the debugger stop in case the given code did not raise an exception.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.throwOnFailure-property">testSettings.throwOnFailure</a> property
can be used to make this function raise a script exception in case the
given code did not raise an exception.
</p><div class="funcsynopsis"><a id="test.fail-function"></a><p><code class="funcdef"><b class="fsfunc">test.fail</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">test.fail</b>(</code><var class="pdparam">message</var>, <var class="pdparam">detail</var><code>)</code>;</p></div><p>
This function unconditionally adds a FAIL entry to <span class="emphasis"><em>Squish</em></span>'s test log
with the given <em class="parameter"><code>message</code></em> string, and with the
<em class="parameter"><code>detail</code></em> string, if one is given.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.breakOnFailure-property">testSettings.breakOnFailure</a> property
can be used to make the debugger stop at this function.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.throwOnFailure-property">testSettings.throwOnFailure</a> property
can be used to make this function additionally raise a script exception.
</p><div class="funcsynopsis"><a id="test.fatal-function"></a><p><code class="funcdef"><b class="fsfunc">test.fatal</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">test.fatal</b>(</code><var class="pdparam">message</var>, <var class="pdparam">detail</var><code>)</code>;</p></div><p>
This function unconditionally adds a FATAL entry to <span class="emphasis"><em>Squish</em></span>'s test log
with the given <em class="parameter"><code>message</code></em> string, and with the
<em class="parameter"><code>detail</code></em> string, if one is given.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.breakOnFailure-property">testSettings.breakOnFailure</a> property
can be used to make the debugger stop at this function.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.throwOnFailure-property">testSettings.throwOnFailure</a> property
can be used to make this function additionally raise a script exception.
</p><div class="funcsynopsis"><a id="test.log-function"></a><p><code class="funcdef"><b class="fsfunc">test.log</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">test.log</b>(</code><var class="pdparam">message</var>, <var class="pdparam">detail</var><code>)</code>;</p></div><p>
This function unconditionally adds a LOG entry to <span class="emphasis"><em>Squish</em></span>'s test log
with the given <em class="parameter"><code>message</code></em> string, and with the
<em class="parameter"><code>detail</code></em> string, if one is given.
</p><div class="funcsynopsis"><a id="test.pass-function"></a><p><code class="funcdef"><b class="fsfunc">test.pass</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">test.pass</b>(</code><var class="pdparam">message</var>, <var class="pdparam">detail</var><code>)</code>;</p></div><p>
This function unconditionally adds a PASS entry to <span class="emphasis"><em>Squish</em></span>'s test log
with the given <em class="parameter"><code>message</code></em> string, and with the
<em class="parameter"><code>detail</code></em> string, if one is given.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Python-specific"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Python-specific</th></tr><tr><td align="left" valign="top"><p>
Since <code class="code">pass</code> is a reserved word in Python, the Python version
of this function is called <code class="code">test.passes</code>.
</p></td></tr></table></div><div class="funcsynopsis"><a id="test.resultCount-function"></a><p><code class="funcdef"><b class="fsfunc">test.resultCount</b>(</code><var class="pdparam">resultCategory</var><code>)</code>;</p></div><p>
This function returns the number of results of the given
<em class="parameter"><code>resultCategory</code></em> of the current test case. The
<em class="parameter"><code>resultCategory</code></em> must be one of the strings:
<code class="code">"errors"</code>,
<code class="code">"fails"</code>,
<code class="code">"fatals"</code>,
<code class="code">"passes"</code>,
<code class="code">"testcases"</code>,
<code class="code">"tests"</code>,
<code class="code">"warnings"</code>,
<code class="code">"xfails"</code>, or
<code class="code">"xpasses"</code>.
</p><p>The result counts are only gathered for the currently running
test case.</p><div class="funcsynopsis"><a id="test.verify-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">test.verify</b>(</code><var class="pdparam">condition</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Boolean <b class="fsfunc">test.verify</b>(</code><var class="pdparam">condition</var>, <var class="pdparam">message</var><code>)</code>;</p></div><p>
This function evaluates the <em class="parameter"><code>condition</code></em> and if it
evaluates to a true value (e.g., <code class="code">true</code> or 1), a test result
of type <span class="guilabel">PASS</span> is added to the test log. Otherwise a result of type <span class="guilabel">FAIL</span>
is added to the test log. In either case the function returns the result
of evaluating the <em class="parameter"><code>condition</code></em>, (i.e., a true value
on <span class="guilabel">PASS</span> and a false value on <span class="guilabel">FAIL</span>).
</p><p>
If the optional <em class="parameter"><code>message</code></em> parameter (of type
string—e.g., a comment, bug number, or test plan reference)
is present, it will be added to the test result whether the test passed
or failed.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.breakOnFailure-property">testSettings.breakOnFailure</a> property
can be used to make the debugger stop in case the verification fails.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.throwOnFailure-property">testSettings.throwOnFailure</a> property
can be used to make this function raise a script exception in case the
verification fails.
</p><div class="funcsynopsis"><a id="test.vp-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">test.vp</b>(</code><var class="pdparam">name</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Boolean <b class="fsfunc">test.vp</b>(</code><var class="pdparam">name</var>, <var class="pdparam">message</var><code>)</code>;</p></div><p>
This function executes the verification point called
<em class="parameter"><code>name</code></em>.
If the verification point's comparison succeeds, a test result
of type <span class="guilabel">PASS</span> is added to the test
log and this function returns a true
value. Otherwise a result of type <span class="guilabel">FAIL</span> is added to the test
log and a false value is returned.
</p><p> If the verification point refers to an object that is not found,
the function will return a false value, and possibly pop up an object not found
dialog, if Squish is configured that way.
</p><p>
If the optional <em class="parameter"><code>message</code></em> parameter (of type
string—e.g., a comment, bug number, or test plan reference)
is present, it will be added to the test result whether the test passed
or failed.
</p><p> In the event of a <span class="guilabel">FAIL</span>, the testcase proceeds to
the next test statement unless <span class="application">squishrunner</span> is configured to
<code class="option">--abortOnFail</code>.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.breakOnFailure-property">testSettings.breakOnFailure</a> property
can be used to make the debugger stop in case the verification fails.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.throwOnFailure-property">testSettings.throwOnFailure</a> property
can be used to make this function raise a script exception in case the
verification fails.
</p><div class="funcsynopsis"><a id="test.vpWithObject-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">test.vpWithObject</b>(</code><var class="pdparam">name</var>, <var class="pdparam">objectNameOrReference</var><code>)</code>;</p></div><p>
This function executes the verification point called
<em class="parameter"><code>name</code></em> where comparison will be performed with the
<em class="parameter"><code>objectNameOrReference</code></em> instead of an object present in the
VP file. If the verification point's comparison succeeds, a test result of type
<span class="guilabel">PASS</span> is added to the test log and this function returns a
true value. Otherwise a result of type <span class="guilabel">FAIL</span> is added to the
test log and a false value is returned. If the VP contains/verifies
more than a single object, <code class="function">test.vpWithObject()</code>
will log an <span class="guilabel">ERROR</span>.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.breakOnFailure-property">testSettings.breakOnFailure</a> property
can be used to make the debugger stop in case the verification fails.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.throwOnFailure-property">testSettings.throwOnFailure</a> property
can be used to make this function raise a script exception in case the
verification fails.
</p><div class="funcsynopsis"><a id="test.warning-function"></a><p><code class="funcdef"><b class="fsfunc">test.warning</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">test.warning</b>(</code><var class="pdparam">message</var>, <var class="pdparam">detail</var><code>)</code>;</p></div><p>
This function unconditionally adds a WARNING entry to <span class="emphasis"><em>Squish</em></span>'s test
log with the given <em class="parameter"><code>message</code></em> string, and with the
<em class="parameter"><code>detail</code></em> string, if one is given.
</p><div class="funcsynopsis"><a id="test.skip-function"></a><p><code class="funcdef"><b class="fsfunc">test.skip</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">test.skip</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><p>
    This function skips further execution of the current script test case, or
    the current BDD scenario (or BDD scenario outline iteration), by
    throwing an exception and adding a SKIPPED entry to <span class="emphasis"><em>Squish</em></span>'s test
    log with the given <em class="parameter"><code>message</code></em> string.
    If the test case logged verification failures before the skip, it is still
    considered failed.
</p><div class="funcsynopsis"><a id="test.xcompare-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">test.xcompare</b>(</code><var class="pdparam">value1</var>, <var class="pdparam">value2</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Boolean <b class="fsfunc">test.xcompare</b>(</code><var class="pdparam">value1</var>, <var class="pdparam">value2</var>, <var class="pdparam">message</var><code>)</code>;</p></div><p>
This function is used to handle expected failures in test scripts. To
test for bugs that should be fixed one day.
</p><p>
The function compares <em class="parameter"><code>value1</code></em> and
<em class="parameter"><code>value2</code></em>, and if they are <span class="emphasis"><em>not</em></span>
equal, a test result of type XFAIL (eXpected FAILure) is added to the
test log and this function returns a false value. Otherwise a test result
of type XPASS (uneXpected PASS) is added to the test log and a true
value is returned.
</p><p> The 'expected fail' result is intended for cases where you know
a comparison or verification will go wrong right now due to a bug in the AUT
</p><p>
In test cases where you want to ensure that a property never has a certain
value, we suggest using <code class="function">test.verify()</code>, or to use
<code class="function">test.fail()</code> directly with an if-construct.
</p><p>
If the optional <em class="parameter"><code>message</code></em> parameter (of type
string—e.g., a comment, bug number, or test plan reference)
is present, it will be added to the test result whether the test passed
or failed.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.breakOnFailure-property">testSettings.breakOnFailure</a> property
can be used to make the debugger stop in case the verification passes unexpectedly.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.throwOnFailure-property">testSettings.throwOnFailure</a> property
can be used to make this function raise a script exception in case the
verification passes unexpectedly.
</p><div class="funcsynopsis"><a id="test.xfail-function"></a><p><code class="funcdef"><b class="fsfunc">test.xfail</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">test.xfail</b>(</code><var class="pdparam">message</var>, <var class="pdparam">detail</var><code>)</code>;</p></div><p>
This function unconditionally adds an XFAIL (eXpected FAILure) entry
to <span class="emphasis"><em>Squish</em></span>'s test log with the given <em class="parameter"><code>message</code></em>
string, and with the <em class="parameter"><code>detail</code></em> string, if one is given.
The 'expected fail' result is intended for cases where you know
a comparison or verification will go wrong right now due to a bug in the AUT.
</p><div class="funcsynopsis"><a id="test.xpass-function"></a><p><code class="funcdef"><b class="fsfunc">test.xpass</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">test.xpass</b>(</code><var class="pdparam">message</var>, <var class="pdparam">detail</var><code>)</code>;</p></div><p>
This function unconditionally adds an XPASS (uneXpected PASS) entry
to <span class="emphasis"><em>Squish</em></span>'s test log with the given <em class="parameter"><code>message</code></em>
string, and with the <em class="parameter"><code>detail</code></em> string, if one is given.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Python-specific"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Python-specific</th></tr><tr><td align="left" valign="top"><p>
The Python version of this function is called <code class="code">test.xpasses</code>, so
that it is consistent with the naming of <code class="code">test.passes</code> in the Python
API.
</p></td></tr></table></div><div class="funcsynopsis"><a id="test.xverify-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">test.xverify</b>(</code><var class="pdparam">condition</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Boolean <b class="fsfunc">test.xverify</b>(</code><var class="pdparam">condition</var>, <var class="pdparam">message</var><code>)</code>;</p></div><p>
This function is used to test for expected failures in test
scripts. For handling of bugs that should be fixed one day.
</p><p>
The function evaluates the <em class="parameter"><code>condition</code></em> and if it
evaluates to a false value (e.g., anything that isn't <code class="code">true</code>
or that's non-zero), a test result of type XFAIL (eXpected FAILure) is
added to the test log. Otherwise a test result of type XPASS (uneXpected
PASS) is added. In either case the function returns the result of
evaluating the <em class="parameter"><code>condition</code></em>, (i.e., a false value on
XFAIL and a true value on XPASS).
</p><p>
If the optional <em class="parameter"><code>message</code></em> parameter (of type
string—e.g., a comment, bug number, or test plan reference)
is present, it will be added to the test result whether the test passed
or failed.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.breakOnFailure-property">testSettings.breakOnFailure</a> property
can be used to make the debugger stop in case the verification passes unexpectedly.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.throwOnFailure-property">testSettings.throwOnFailure</a> property
can be used to make this function raise a script exception in case the
verification passes unexpectedly.
</p><div class="funcsynopsis"><a id="test.xvp-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">test.xvp</b>(</code><var class="pdparam">name</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Boolean <b class="fsfunc">test.xvp</b>(</code><var class="pdparam">name</var>, <var class="pdparam">message</var><code>)</code>;</p></div><p>
This function is used to test expected verification point failures.
For handling of bugs that should be fixed one day.
</p><p>
This function executes the verification point called
<em class="parameter"><code>name</code></em>.
If the verification point's comparison fails, a test result
of type <span class="guilabel">XFAIL</span> (eXpected FAILure) is added to the test
log and this function returns a true value.
Otherwise a result of type <span class="guilabel">XPASS</span> (uneXpected PASS)
is added to the test log and a false value is returned.
</p><p>
If the verification point refers to an object that is not found,
the function will return a false value, and possibly pop up an object not found
dialog, if Squish is configured that way.
</p><p>
If the optional <em class="parameter"><code>message</code></em> parameter (of type
string—e.g., a comment, bug number, or test plan reference)
is present, it will be added to the test result whether the test passed
or failed.
</p><p>
In the event of a <span class="guilabel">XPASS</span>, the testcase proceeds to
the next test statement unless <span class="application">squishrunner</span> is configured to
<code class="option">--abortOnFail</code>.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.breakOnFailure-property">testSettings.breakOnFailure</a> property
can be used to make the debugger stop in case the verification passes unexpectedly.
</p><p>
The <a class="xref" href="rgs-squish.html#testSettings.throwOnFailure-property">testSettings.throwOnFailure</a> property
can be used to make this function raise a script exception in case the
verification passes unexpectedly.
</p><div class="funcsynopsis"><a id="test.stackTrace-function"></a><p><code class="funcdef">StackTrace <b class="fsfunc">test.stackTrace</b>(</code><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">StackTrace <b class="fsfunc">test.stackTrace</b>(</code><var class="pdparam">startFrame</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">StackTrace <b class="fsfunc">test.stackTrace</b>(</code><var class="pdparam">startFrameIndex</var>, <var class="pdparam">maxFrameCount</var><code>)</code>;</p></div><p>
This function returns a list of stack frames representing the currently
active function calls. The first element in the list contains information
about the location of the <a class="xref" href="rgs-squish.html#test.stackTrace-function"><code class="function">test.stackTrace</code></a> call
itself, the second element contains information about its caller and so
on. The last element in the list is usually the <code class="code">main</code>
function call.
</p><p>
Each stack frame value in the returned list features two fields:
</p><div class="variablelist"><dl><dt><span class="term"><code class="code">fileName</code></span></dt><dd><p>
The name of the source file in which the function call was done.
</p></dd><dt><span class="term"><code class="code">line</code></span></dt><dd><p>
The line number in the script file in which the function call was done.
</p></dd></dl></div><p>
If the optional <em class="parameter"><code>startFrameIndex</code></em> parameter (a number) is
given, the given number of most recent frames will be skipped. This is useful
for retrieving stack traces from framework functions, in which case the stack
trace should possibly not include the code internal to the framework itself. If
this parameter is not given it defaults to zero, i.e.  no frames are skipped.
</p><p>
If both <em class="parameter"><code>startFrameIndex</code></em> as well as
<em class="parameter"><code>maxFrameCount</code></em> are given, the stack trace will be limited
to <em class="parameter"><code>maxFrameCount</code></em> frames, i.e. it will not be computed
all the way back to the initial call to the <code class="code">main</code> function. This
can improve performance for deeply nested script frameworks.
</p><div class="funcsynopsis"><a id="test.fixateResultContext-function"></a><p><code class="funcdef"><b class="fsfunc">test.fixateResultContext</b>(</code><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">test.fixateResultContext</b>(</code><var class="pdparam">ancestorFrameIndex</var><code>)</code>;</p></div><div class="funcsynopsis"><a id="test.restoreResultContext-function"></a><p><code class="funcdef"><b class="fsfunc">test.restoreResultContext</b>(</code><code>)</code>;</p></div><p>
These functions temporarily enforce that test results created by other <span class="emphasis"><em>Squish</em></span>
functions such as <a class="xref" href="rgs-squish.html#test.xcompare-function"><code class="function">test.xcompare</code></a> or <a class="xref" href="rgs-squish.html#test.verify-function"><code class="function">test.verify</code></a> will have their report entry rewritten such
that the location of the result entry is no longer the place where
<code class="code">text.xcompare</code> was called but rather any of the ancestors frames of
the current function.
</p><p>
The <code class="code">test.fixateResultContext</code> function adjusts the call stack frame
which is used when generating test result entries; by default, it will rewrite
the location of all result entries such that they seem to stem from the parent
stack frame. The same effect can be achieved by passing an optional argument
<code class="code">1</code>. You can pass other values to reference other ancestor stack
frames, e.g. <code class="code">2</code> would reference the grand-parent stack framer (the
caller of the caller).
</p><p>
Use the <code class="code">test.restoreResultContext</code> to revert the effect of a
previous <code class="code">test.fixateResultContext</code> call. Note that the calls can be
nested, i.e. multiple subsequent calls to <code class="code">fixateResultContext</code>
requires that <code class="code">restoreResultContext</code> gets called multiple times as
well.
</p><p>
Here are some examples; note how the test result entry triggered by the call to
<code class="code">test.compare</code> will be logged with a location pointing into the
<code class="code">main</code> function, not into the <code class="code">libraryFunction</code> function:
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
def libraryFunction():
  test.fixateResultContext(1)
  test.compare("Apples", "Oranges") <a xmlns="http://www.w3.org/1999/xhtml" class="co" id="orig-result-location-co-py" href="rgs-squish.html#orig-result-location"><img xmlns="" src="callouts/1.png" border="0"></a>
  test.restoreResultContext()

def main():
  libraryFunction() <a xmlns="http://www.w3.org/1999/xhtml" class="co" id="new-result-location-co-py" href="rgs-squish.html#new-result-location"><img xmlns="" src="callouts/2.png" border="0"></a>
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
function libraryFunction()
{
  test.fixateResultContext(1);
  test.compare("Apples", "Oranges"); <a xmlns="http://www.w3.org/1999/xhtml" class="co" id="orig-result-location-co-js" href="rgs-squish.html#orig-result-location"><img xmlns="" src="callouts/1.png" border="0"></a>
  test.restoreResultContext();
}

function main()
{
  libraryFunction(); <a xmlns="http://www.w3.org/1999/xhtml" class="co" id="new-result-location-co-js" href="rgs-squish.html#new-result-location"><img xmlns="" src="callouts/2.png" border="0"></a>
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
sub libraryFunction
{
  test::fixateResultContext(1);
  test::compare("Apples", "Oranges"); <a xmlns="http://www.w3.org/1999/xhtml" class="co" id="orig-result-location-co-pl" href="rgs-squish.html#orig-result-location"><img xmlns="" src="callouts/1.png" border="0"></a>
  test::restoreResultContext();
}

sub main
{
  libraryFunction(); <a xmlns="http://www.w3.org/1999/xhtml" class="co" id="new-result-location-co-pl" href="rgs-squish.html#new-result-location"><img xmlns="" src="callouts/2.png" border="0"></a>
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
require 'squish'

include Squish

def libraryFunction
  Test.fixateResultContext(1)
  Test.compare("Apples", "Oranges") <a xmlns="http://www.w3.org/1999/xhtml" class="co" id="orig-result-location-co-rb" href="rgs-squish.html#orig-result-location"><img xmlns="" src="callouts/1.png" border="0"></a>
  Test.restoreResultContext()
end

def main
  libraryFunction() <a xmlns="http://www.w3.org/1999/xhtml" class="co" id="new-result-location-co-rb" href="rgs-squish.html#new-result-location"><img xmlns="" src="callouts/2.png" border="0"></a>
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
proc libraryFunction {} {
  test fixateResultContext 1
  test compare "Apples" "Oranges" <a xmlns="http://www.w3.org/1999/xhtml" class="co" id="orig-result-location-co-tcl" href="rgs-squish.html#orig-result-location"><img xmlns="" src="callouts/1.png" border="0"></a>
  test restoreResultContext
}

proc main {} {
  libraryFunction <a xmlns="http://www.w3.org/1999/xhtml" class="co" id="new-result-location-co-tcl" href="rgs-squish.html#new-result-location"><img xmlns="" src="callouts/2.png" border="0"></a>
}
</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a id="orig-result-location"></a><a href="#orig-result-location-co-py"><img xmlns="" src="callouts/1.png" border="0"></a> </p></td><td valign="top" align="left"><p>
The script file location which is associated with the comparison in case
<code class="code">fixateResultContext</code>/<code class="code">restoreResultContext</code> is not used.
This is the default - test results are associated with the location of the
respective <code class="code">test</code> statement.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="new-result-location"></a><a href="#new-result-location-co-py"><img xmlns="" src="callouts/2.png" border="0"></a> </p></td><td valign="top" align="left"><p>
The script file location which is associated with the comparison with
<code class="code">fixateResultContext</code>/<code class="code">restoreResultContext</code> used as
shown here. Due to the <code class="code">fixateResultContext</code> call, the test result
generated by the <code class="code">test.compare</code> statement is reported at the call
site, i.e. the place where <code class="code">libraryFunction</code> is called.
</p></td></tr></table></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png"></img></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>
Omitting a call to <code class="code">test.restoreResultContext</code> after calling
<code class="code">test.fixateResultContext</code> can result in very misleading test
reports.
</p></td></tr></table></div><div class="funcsynopsis"><a id="test.imagePresent-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">test.imagePresent</b>(</code><var class="pdparam">imageFile</var>, <var class="pdparam">[parameterMap]</var>, <var class="pdparam">[searchRegion]</var><code>)</code>;</p></div><div class="funcsynopsis"><a id="test.imageNotPresent-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">test.imageNotPresent</b>(</code><var class="pdparam">imageFile</var>, <var class="pdparam">[parameterMap]</var>, <var class="pdparam">[searchRegion]</var><code>)</code>;</p></div><p>
This function will perform a search of the template image as stored
in <em class="parameter"><code>imageFile</code></em> on the display also showing the
currently running application. On success a test result of type PASS
is added to the test log and the function returns <code class="code">true</code>.
Otherwise a test result of type FAIL is added to the test log and the
function returns <code class="code">false</code>.
</p><p>The <code class="code">imageNotPresent()</code> variant of the function works
exactly the same as <code class="code">imagePresent()</code>, except it waits for
the image NOT to be found. It can be used to verify the image absence.
</p><p>The search for the sub-image is performed left to right, top to
bottom. The first successful match is selected. For selection of other
matches use the <code class="code">occurrence</code> parameter as described below.
</p><p>All available screens making up the desktop will be searched. At
least on Windows and X11-based systems. For searches on multi-screen
setup on macOS please inquire with technical support.
</p><p>
The search behavior can be configured through entries passed
via the optional <em class="parameter"><code>parameterMap</code></em> argument.
</p><div class="itemizedlist"><ul type="disc"><li><p><em class="parameter"><code>occurrence</code></em> - The occurrence
index. By default the first match (with index 1) will be selected.
Index values 2 and higher will select consecutive matches.</p></li><li><p> <em class="parameter"><code>interval</code></em> - Number of
milliseconds to wait in between image search retries. The default is
1000 (1 second). </p></li><li><p> <em class="parameter"><code>timeout</code></em> - Amount of time in
milliseconds to search for an image before reporting that the image is
not found. The default is 20000 (20 seconds). </p></li><li><p><em class="parameter"><code>tolerant</code></em> - Boolean switch
that enables tolerant image search mode. In this mode some differences
between the template image and the desktop screenshot are allowed. The
default value is the value of
<a class="xref" href="rgs-squish.html#testSettings.imageSearchTolerant-property">testSettings.imageSearchTolerant</a> property.
</p></li><li><p><em class="parameter"><code>threshold</code></em> - Threshold on the
correlation between template image and a desktop screenshot,
expressed as a percentage. A correlation higher than the threshold is
considered a match against the template image. Usable values for this
parameter usually fall between <code class="constant">99.0</code> and
<code class="constant">100.0</code>. The default value is the value of the
<a class="xref" href="rgs-squish.html#testSettings.imageSearchThreshold-property">testSettings.imageSearchThreshold</a> property.
This parameter is ignored if the <code class="code">tolerant</code> parameter is
set to <code class="code">false</code>.</p></li><li><p><em class="parameter"><code>multiscale</code></em> - Boolean switch
that enables scaled image search mode. In this mode the template image
is expanded into a series of images of different sizes. Those image
are subsequently used as template images for the image search. The
default value is the value of the
<a class="xref" href="rgs-squish.html#testSettings.imageSearchMultiscale-property">testSettings.imageSearchMultiscale</a> property.
This parameter is ignored if the <code class="code">tolerant</code> parameter is
set to <code class="code">false</code>.</p></li><li><p><em class="parameter"><code>minScale</code></em> - Lower bound on the
template image series sizes, expressed as a percentage. The resized
template image sizes will span between <code class="code">minScale</code> and
<code class="code">maxScale</code> of the original image size. The default value
is the value of the
<a class="xref" href="rgs-squish.html#testSettings.imageSearchMinScale-property">testSettings.imageSearchMinScale</a> property.
This parameter is ignored if either the <code class="code">tolerant</code> or the
<code class="code">multiscale</code> parameters are set to <code class="code">false</code>.
</p></li><li><p><em class="parameter"><code>maxScale</code></em> Upper bound on the
template image series sizes, expressed as a percentage. The resized
template image sizes will span between <code class="code">minScale</code> and
<code class="code">maxScale</code> of the original image size. The default value
is the value of the
<a class="xref" href="rgs-squish.html#testSettings.imageSearchMaxScale-property">testSettings.imageSearchMaxScale</a> property.
This parameter is ignored if either the <code class="code">tolerant</code> or the
<code class="code">multiscale</code> parameters are set to <code class="code">false</code>.
</p></li><li><p><em class="parameter"><code>message</code></em> - An optional detailed
description (of type string) added to the test result no matter whether
the test passed or failed, much like <code class="code">message</code> argument of
<a class="xref" href="rgs-squish.html#test.compare-function"><code class="function">test.compare</code></a>.
</p></li></ul></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Verify the icon.png is displayed
test.imagePresent("icon.png")
# Verify the icon.png is displayed at least twice
test.imagePresent("icon.png", {"occurrence": 2})
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Verify the icon.png is displayed
test.imagePresent("icon.png");
// Verify the icon.png is displayed at least twice
test.imagePresent("icon.png", {"occurrence": 2});
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Verify the icon.png is displayed
test::imagePresent("icon.png")
# Verify the icon.png is displayed at least twice
test::imagePresent("icon.png", {"occurrence" =&gt; 2})
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Verify the icon.png is displayed
Test.imagePresent("icon.png")
# Verify the icon.png is displayed at least twice
Test.imagePresent("icon.png", {"occurrence" =&gt; 2})
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Verify the icon.png is displayed
test imagePresent "icon.png"
# Verify the icon.png is displayed at least twice
test imagePresent "icon.png" {"occurrence": 2}
</pre></div><p>By default this function will repeatedly grab the screen content
until an image is found or until 20 seconds have passed. Longer (or
shorter) waiting periods can be set in milliseconds via a
<code class="code">timeout</code> value passed through the
<em class="parameter"><code>parameterMap</code></em>.</p><p>The matching algorithm performs a pixel-by-pixel color value
comparison. The screen content and sub-image content therefore have to
match 100% unless the tolerant search mode is enabled.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Verify the icon.png is displayed
test.imagePresent( "icon.png", {'tolerant': True,
                                'threshold': 99.7,
                                'multiscale': True,
                                'minScale': 100.0,
                                'maxScale': 150.0})
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Verify the icon.png is displayed
test.imagePresent("icon.png", {tolerant: true,
                               threshold: 99.7,
                               multiscale: true,
                               minScale: 100.0,
                               maxScale: 150.0});
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Verify the icon.png is displayed
test::imagePresent("icon.png", {tolerant =&gt; true,
                                threshold =&gt; 99.7,
                                multiscale =&gt; true,
                                minScale =&gt; 100.0,
                                maxScale =&gt; 150.0}) );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Verify the icon.png is displayed
Test.imagePresent("icon.png", {"tolerant" =&gt; true,
                               "threshold" =&gt; 99.7,
                               "multiscale" =&gt; true,
                               "minScale" =&gt; 100.0,
                               "maxScale" =&gt; 150.0}) )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Verify the icon.png is displayed
test imagePresent "icon.png" {tolerant true \
                              threshold 99.7 \
                              multiscale true \
                              minScale 100.0 \
                              maxScale 150.0}
</pre></div><p>
In case a searchRegion is specified as the last argument, the search
is performed only within the area corresponding to it. The search
region can be an AUT object, a ScreenRectangle object or an array of
such objects. It can also be a special string value "all", in which
case all top-level objects are used.
</p><p>The searchRegion can also be an <a class="xref" href="rgs-squish.html#script-image-object" title="6.3.14. Image Object">Image</a> object. In such case no new screenshots
are taken and the specified image is used instead. Currently it is not
possible to limit the search scope to a portion of an <code class="code">Image</code>
object; please use the <a class="xref" href="rgs-squish.html#Image.copy-function"><code class="function">Image.copy</code></a> to cut
the relevant section. Since the <code class="code">Image</code> object specified
as the search region cannot possibly change overtime, this function
will not perform the image search repetitively and will return the
result immediately.</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Verify the icon.png is displayed on the MyWidget object
test.imagePresent("icon.png", {}, waitForObject( names.MyWidget ) )

# Verify the icon.png is displayed on multiple objects
test.imagePresent("icon.png", {}, [ waitForObject( names.MyWidget ),
                            waitForObject( names.MyOtherWidget ) ] )

# Verify the icon.png is displayed on the left half of the MyWidget object
bounds = object.globalBounds( waitForObject( names.MyWidget ) )
bounds.width = bounds.width / 2
test.imagePresent("icon.png", {}, bounds )

# Verify the icon.png is displayed in the specified area
test.imagePresent("icon.png", {}, UiTypes.ScreenRectangle( 100, 100, 200, 300 ) )

# Verify the icon.png is displayed on all top-level objects
test.imagePresent("icon.png", {}, "all" )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Verify the icon.png is displayed on the MyWidget object
test.imagePresent("icon.png", {}, waitForObject( names.MyWidget ) );

// Verify the icon.png is displayed on multiple objects
test.imagePresent("icon.png", {}, [ waitForObject( names.MyWidget ),
                            waitForObject( names.MyOtherWidget ) ] );

// Verify the icon.png is displayed on the left half of the MyWidget object
var bounds = object.globalBounds( waitForObject( names.MyWidget ) );
bounds.width = bounds.width / 2
test.imagePresent("icon.png", {}, bounds );

// Verify the icon.png is displayed in the specified area
test.imagePresent("icon.png", {}, UiTypes.ScreenRectangle( 100, 100, 200, 300 ) );

// Verify the icon.png is displayed on all top-level objects
test.imagePresent("icon.png", {}, "all" );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Verify the icon.png is displayed on the MyWidget object
test::imagePresent("icon.png", {}, waitForObject( names::MyWidget ) );

# Verify the icon.png is displayed on multiple objects
test::imagePresent("icon.png", {}, ( waitForObject( names::MyWidget ),
                            waitForObject( names::MyOtherWidget ) ) );

# Verify the icon.png is displayed on the left half of the MyWidget object
my $bounds = object::globalBounds( waitForObject( names::MyWidget ) );
$bounds-&gt;width = $bounds-&gt;width / 2;
test::imagePresent("icon.png", {}, bounds );

# Verify the icon.png is displayed in the specified area
test::imagePresent("icon.png", {}, new UiTypes::ScreenRectangle( 100, 100, 200, 300 ) );

# Verify the icon.png is displayed on all top-level objects
test::imagePresent("icon.png", {}, "all" )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Verify the icon.png is displayed on the MyWidget object
Test.imagePresent("icon.png", {}, waitForObject( names.MyWidget ) );

# Verify the icon.png is displayed on multiple objects
Test.imagePresent("icon.png", {}, [ waitForObject( names.MyWidget ),
                            waitForObject( names.MyOtherWidget ) ] );

# Verify the icon.png is displayed on the left half of the MyWidget object
bounds = Squish::Object.globalBounds( waitForObject( names.MyWidget ) );
bounds.width = bounds.width / 2
Test.imagePresent("icon.png", {}, bounds );

# Verify the icon.png is displayed in the specified area
Test.imagePresent("icon.png", {}, UiTypes::ScreenRectangle.new( 100, 100, 200, 300 ) );

# Verify the icon.png is displayed on all top-level objects
Test.imagePresent("icon.png", {}, "all" );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Verify the icon.png is displayed on the MyWidget object
test imagePresent "icon.png" {} [ waitForObject $names::MyWidget ]

# Verify the icon.png is displayed on multiple objects
test imagePresent "icon.png" {} { [ waitForObject $names::MyWidget ],
                                   [ waitForObject $names::MyOtherWidget ] }

# Verify the icon.png is displayed on the left half of the MyWidget object
set bounds [object globalBounds [ waitForObject $names::MyWidget ] ]
property set $bounds width [ expr [ property get $bounds width ] / 2 ]
test imagePresent "icon.png" {} $bounds

# Verify the icon.png is displayed in the specified area
test imagePresent "icon.png" {} [ construct ScreenRectangle 100 100 200 300 ]

# Verify the icon.png is displayed on all top-level objects
test imagePresent "icon.png" {} "all"
</pre></div><div class="funcsynopsis"><a id="test.ocrTextPresent-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">test.ocrTextPresent</b>(</code><var class="pdparam">text</var>, <var class="pdparam">[parameterMap]</var>, <var class="pdparam">[searchRegion]</var><code>)</code>;</p></div><div class="funcsynopsis"><a id="test.ocrTextNotPresent-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">test.ocrTextNotPresent</b>(</code><var class="pdparam">text</var>, <var class="pdparam">[parameterMap]</var>, <var class="pdparam">[searchRegion]</var><code>)</code>;</p></div><p>
This function will perform optical character recognition on the
display also showing the currently running application and search for
the specific text within the result set. If the specified text is present,
a test result of type PASS is added to the test log and the function
returns <code class="code">true</code>. Otherwise a test result of type FAIL is added
to the test log and the function returns <code class="code">false</code>.
</p><p>The <code class="code">ocrTextNotPresent()</code> variant of the function works
exactly the same as <code class="code">ocrTextPresent()</code>, except it waits for
the text NOT to be found. It can be used to verify the text absence.
</p><p>
The OCR will be performed over all available screens making up
the desktop. At least on Windows and X11-based systems. For OCR on
multi-screen setup on macOS please inquire with technical support.
</p><p>
The search behavior can be configured through entries passed
via the optional <em class="parameter"><code>parameterMap</code></em> argument.
</p><div class="itemizedlist"><ul type="disc"><li><p> <em class="parameter"><code>interval</code></em> - Minimal number of
milliseconds to wait in between OCR search retries. The default is
1000 (1 second). The actual interval between separate OCR attempts is
dependent on OCR engine performance, and may be significantly longer.
</p></li><li><p> <em class="parameter"><code>timeout</code></em> - Amount of time in
milliseconds to search for the specified text before reporting that
the text is not found. The default is 20000 (20 seconds).
</p></li><li><p><em class="parameter"><code>occurrence</code></em> - The occurrence
index. By default the first text match (with index 1) will be
returned. Index values 2 and higher will select consecutive matches as
far as available.</p></li><li><p><em class="parameter"><code>language</code></em> - The language hint
for OCR engine. Use an empty string to use the OCR engine defaults.
The default value is the value of
<a class="xref" href="rgs-squish.html#testSettings.defaultOcrLanguage-property">testSettings.defaultOcrLanguage</a> property.
</p></li><li><p><em class="parameter"><code>profiles</code></em> - An array of OCR
engine specific profile names. This parameter is used only with
engines that support profiles.
</p></li><li><p><em class="parameter"><code>options</code></em> - A map of
engine-specific option names and values. These options are passed to
the OCR engine after loading the specified profiles.
</p></li><li><p><em class="parameter"><code>scaleFactor</code></em> - Image up-scale
factor. The source image is upscaled by that factor before it is
passed to the OCR engine. The default value is
<code class="constant">3.5</code>. It can be set to a lower value to improve
the OCR performance in case the text is rendered with a large font.
</p></li><li><p><em class="parameter"><code>message</code></em> - An optional detailed
description (of type string) added to the test result no matter whether
the test passed or failed, much like <code class="code">message</code> argument of
<a class="xref" href="rgs-squish.html#test.compare-function"><code class="function">test.compare</code></a>.
</p></li></ul></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Verify the 'Hier klicken' German text is displayed at least twice
test.ocrTextPresent("Hier klicken", {"occurrence": 2, "language": "German"})
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
// Verify the 'Hier klicken' German text is displayed at least twice
test.ocrTextPresent("Hier klicken", {occurrence: 2, language: "German"});
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Verify the 'Hier klicken' German text is displayed at least twice
test::ocrTextPresent("Hier klicken", {"occurrence" =&gt; 2, "language" =&gt; "German"});
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Verify the 'Hier klicken' German text is displayed at least twice
Test.ocrTextPresent("Hier klicken", {"occurrence" =&gt; 2, "language" =&gt; "German"})
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Verify the 'Hier klicken' German text is displayed at least twice
test ocrTextPresent "Hier klicken" {occurrence 2 language "German"}
</pre></div><p>By default this function will repeatedly grab the screen content
until the specified text is found or until 20 seconds have passed. Longer
(or shorter) waiting periods can be set in milliseconds via a
<code class="code">timeout</code> value passed through the
<em class="parameter"><code>parameterMap</code></em>.</p><p>
In case a searchRegion is specified as the last argument, the OCR
is performed only within the area corresponding to it. The search
region can be an AUT object, a ScreenRectangle object or an array of
such objects. It can also be a special string value "all", in which
case all top-level objects are used.
</p><p>The searchRegion can also be an <a class="xref" href="rgs-squish.html#script-image-object" title="6.3.14. Image Object">Image</a> object. In such case no new screenshots
are taken and the specified image is used instead. Currently it is not
possible to limit the OCR scope to a portion of an <code class="code">Image</code>
object; please use the <a class="xref" href="rgs-squish.html#Image.copy-function"><code class="function">Image.copy</code></a> to cut
the relevant section. Since the <code class="code">Image</code> object specified
as the search region cannot possibly change overtime, this function
will not perform the OCR repetitively and will return the results
immediately.</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# Verify the 'Click me' text is displayed on the MyWidget object
test.ocrTextPresent( "Click me", {}, waitForObject( names.MyWidget )

# Verify the 'Click me' text is displayed on multiple objects
test.ocrTextPresent( "Click me", {}, [ waitForObject( names.MyWidget ),
                                       waitForObject( names.MyOtherWidget ) ] )

# Verify the 'Click me' text is displayed on the left half of the MyWidget object
bounds = object.globalBounds( waitForObject( names.MyWidget ) )
bounds.width = bounds.width / 2
test.ocrTextPresent( "Click me", {}, bounds )

# Verify the 'Click me' text is displayed in the specified area
test.ocrTextPresent( "Click me", {}, UiTypes.ScreenRectangle( 100, 100, 200, 300 ) )

# Verify the 'Click me' text is displayed on all top-level objects
test.ocrTextPresent( "Click me", {}, "all" )
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
# Verify the 'Click me' text is displayed on the MyWidget object
test.ocrTextPresent( "Click me", {}, waitForObject( names.MyWidget ) );

// Verify the 'Click me' text is displayed on multiple objects
test.ocrTextPresent( "Click me", {}, [ waitForObject( names.MyWidget ),
                                       waitForObject( names.MyOtherWidget ) ] );

// Verify the 'Click me' text is displayed on the left half of the MyWidget object
var bounds = object.globalBounds( waitForObject( names.MyWidget ) );
bounds.width = bounds.width / 2
test.ocrTextPresent( "Click me", {}, bounds );

// Verify the 'Click me' text is displayed in the specified area
test.ocrTextPresent( "Click me", {}, new UiTypes.ScreenRectangle( 100, 100, 200, 300 ) );

// Verify the 'Click me' text is displayed on all top-level objects
test.ocrTextPresent( "Click me", {}, "all" );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
# Verify the 'Click me' text is displayed on the MyWidget object
test::ocrTextPresent( "Click me", {}, waitForObject( names::MyWidget ) );

# Verify the 'Click me' text is displayed on multiple objects
test::ocrTextPresent( "Click me", {}, ( waitForObject( names::MyWidget ),
                                              waitForObject( names::MyOtherWidget ) ) );

# Verify the 'Click me' text is displayed on the left half of the MyWidget object
my $bounds = object::globalBounds( waitForObject( names::MyWidget ) );
$bounds-&gt;width = $bounds-&gt;width / 2;
test::ocrTextPresent( "Click me", {}, bounds );

# Verify the 'Click me' text is displayed in the specified area
test::ocrTextPresent( "Click me", {}, new UiTypes::ScreenRectangle( 100, 100, 200, 300 ) );

# Verify the 'Click me' text is displayed on all top-level objects
test::ocrTextPresent( "Click me", {}, "all" );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# Verify the 'Click me' text is displayed on the MyWidget object
Test.ocrTextPresent( "Click me", {}, waitForObject( names.MyWidget ) );

# Verify the 'Click me' text is displayed on multiple objects
Test.ocrTextPresent( "Click me", {}, [ waitForObject( names.MyWidget ),
                                       waitForObject( names.MyOtherWidget ) ] );

# Verify the 'Click me' text is displayed on the left half of the MyWidget object
bounds = Squish::Object.globalBounds( waitForObject( names.MyWidget ) );
bounds.width = bounds.width / 2
Test.ocrTextPresent( "Click me", {}, bounds );

# Verify the 'Click me' text is displayed in the specified area
Test.ocrTextPresent( "Click me", {}, UiTypes::ScreenRectangle.new( 100, 100, 200, 300 ) );

# Verify the 'Click me' text is displayed on all top-level objects
Test.ocrTextPresent( "Click me", {}, "all" );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
# Verify the 'Click me' text is displayed on the MyWidget object
test ocrTextPresent "Click me" {} [ waitForObject $names::MyWidget ]

# Verify the 'Click me' text is displayed on multiple objects
test ocrTextPresent "Click me" {} { [ waitForObject $names::MyWidget ],
                                    [ waitForObject $names::MyOtherWidget ] }

# Verify the 'Click me' text is displayed on the left half of the MyWidget object
set bounds [object globalBounds [ waitForObject $names::MyWidget ] ]
property set $bounds width [ expr [ property get $bounds width ] / 2 ]
test ocrTextPresent "Click me" {} $bounds

# Verify the 'Click me' text is displayed in the specified area
test ocrTextPresent "Click me" {} [ construct ScreenRectangle 100 100 200 300 ]

# Verify the 'Click me' text is displayed on all top-level objects
test ocrTextPresent "Click me" {} "all"
</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="bracketing-function-calls"></a>6.3.8.1. Ensuring that functions are always called pairwise</h4></div></div></div><p>
Some functions need to be called in pairs to work correctly. For instance,
<code class="code">fixateResultContext</code> &amp; <code class="code">restoreResultContext</code>
should go together, just like <code class="code">startsection</code> &amp; <code class="code">endSection</code>.
In order to ensure that this is the case even when script exceptions are raised
(or the control flow could bypass one of the statements by other means, e.g. a
<code class="code">return;</code> statement), it is advisable to wrap the calls to the function
pairs into helper functions which ensure that they always go together.
</p><p>
Here are some examples for how to ensure that <code class="code">fixateResultContext</code> and
<code class="code">restoreResultContext</code> always go together. The same approach is applicable
to <code class="code">startSection</code> &amp; <code class="code">endSection</code>:
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
#
# Python 2.5 or newer
#
def resultsReportedAtCallsite(ancestorLevel = 1):
    class Ctx:
        def __enter__(self):
            test.fixateResultContext(ancestorLevel + 1)
        def __exit__(self, exc_type, exc_value, traceback):
            test.restoreResultContext()
    return Ctx()

def libraryFunction():
    with resultsReportedAtCallsite():
        test.compare("Apples", "Oranges")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
#
# Python 2.4 or earlier; these versions don't have the 'with' statement yet.
#
def withResultsReportedAtCallsite(callable, ancestorLevel = 1):
    test.fixateResultContext(ancestorLevel + 1)
    try:
        return callable()
    finally:
        test.restoreResultContext()

def libraryFunction():
    def go():
        test.compare("Apples", "Oranges")
    withResultsReportedAtCallsite(go)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
function withResultsReportedAtCallsite(f)
{
    test.fixateResultContext(2);
    try {
        return f();
    } finally {
        test.restoreResultContext();
    }
}

function libraryFunction()
{
    withResultsReportedAtCallsite(function() {
        test.compare("Apples", "Oranges");
    });
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
sub withResultsReportedAtCallsite {
    my $code = shift;
    test::fixateResultContext(2);
    $code-&gt;();
    test::restoreResultContext();
}

sub libraryFunction
{
    withResultsReportedAtCallsite sub {
        test::compare("Apples", "Oranges");
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
require 'squish'

include Squish

def withResultsReportedAtCallsite
  Test.fixateResultContext( 2 )
  begin
    yield
  ensure
    Test.restoreResultContext()
  end
end

def libraryFunction
  withResultsReportedAtCallsite do
    Test.compare("Apples", "Oranges")
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
proc withResultsReportedAtCallsite {body} {
    test fixateResultContext 2
    uplevel 1 $body
    test restoreResultContext
}

proc libraryFunction {} {
    withResultsReportedAtCallsite {
        test compare "Apples" "Oranges"
    }
}
</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="grouping-testresults-into-sections-api"></a>6.3.8.2.  Grouping test results into sections </h4></div></div></div><div class="funcsynopsis"><a id="test.startSection-function"></a><p><code class="funcdef"><b class="fsfunc">test.startSection</b>(</code><var class="pdparam">title</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">test.startSection</b>(</code><var class="pdparam">title</var>, <var class="pdparam">description</var><code>)</code>;</p></div><div class="funcsynopsis"><a id="test.endSection-function"></a><p><code class="funcdef"><b class="fsfunc">test.endSection</b>(</code><code>)</code>;</p></div><p>
These functions can be used to group test results into logical units. A set of
comparison or log/warning statements can be enclosed in
<code class="code">startSection</code>/<code class="code">endSection</code> to have it logged as a
distinct result section. The <span class="application">Squish IDE</span> will display result sections as a nested set
of test results. Executing tests on the commandline will, except when the XML3
report generator is used, get log messages added to the test report whenever a
section starts or ends.
</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png"></img></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>
Omitting a call to <code class="code">test.endSection</code> after calling
<code class="code">test.startSection</code> can result in very misleading or malformed test
reports. Please see <a class="xref" href="rgs-squish.html#bracketing-function-calls" title="6.3.8.1. Ensuring that functions are always called pairwise">Ensuring that functions are always called pairwise (Section 6.3.8.1)</a> for how
to approach this problem.
</p></td></tr></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="comparing-files-api"></a>6.3.8.3.  Comparing Files </h4></div></div></div><div class="funcsynopsis"><a id="test.compareTextFiles-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">test.compareTextFiles</b>(</code><var class="pdparam">expectedFilePath</var>, <var class="pdparam">actualFilePath</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Boolean <b class="fsfunc">test.compareTextFiles</b>(</code><var class="pdparam">expectedFilePath</var>, <var class="pdparam">actualFilePath</var>, <var class="pdparam">options</var><code>)</code>;</p></div><p>
This function compares the expected file specified by <em class="parameter"><code>expectedFilePath</code></em>
and compares it to the actual file specified by <em class="parameter"><code>actualFilePath</code></em>. If they
are equal a test result of type PASS is added to the test log and the function returns a true
value. Otherwise a test result of type FAIL is added to the test log and a false value is returned.
If the files are different a diff that shows which lines have changed is created which can be found
in the test result message details.
</p><p>
The optional parameter <em class="parameter"><code>options</code></em> can be specified as a map or dictionary.
So far the following options can be set:
</p><div class="itemizedlist"><ul type="disc" compact><li><p>strictLineEndings : If this is set to <code class="code">true</code> the function will pick up
if two files use different line endings (e.g. CR+LF on windows or LF on unix). The default is
<code class="code">false</code>.</p></li></ul></div><p>
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
//example 1: no options
test.compareTextFiles("expected.txt", "actual.txt");

//example 2: with options
test.compareTextFiles("expected.txt", "actual.txt", {'strictLineEndings': true});
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
#example 1: no options
test::compareTextFiles("expected.txt", "actual.txt");

#example 2: with options
test::compareTextFiles("expected.txt", "actual.txt", {"strictLineEndings" =&gt; 1});
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
#example 1: no options
test.compareTextFiles("expected.txt", "actual.txt")

#example 2: with options
test.compareTextFiles("expected.txt", "actual.txt", {'strictLineEndings': True})
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
#example 1: no options
Test.compareTextFiles("expected.txt", "actual.txt")

#example 2: with options
Test.compareTextFiles("expected.txt", "actual.txt", {'strictLineEndings' =&gt; True})
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
#example 1: no options
test compareTextFiles "expected.txt" "actual.txt"

#example 2: with options
test compareTextFiles "expected.txt" "actual.txt" [dict create strictLineEndings 1]
</pre></div><div class="funcsynopsis"><a id="test.compareXMLFiles-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">test.compareXMLFiles</b>(</code><var class="pdparam">expectedFilePath</var>, <var class="pdparam">actualFilePath</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Boolean <b class="fsfunc">test.compareXMLFiles</b>(</code><var class="pdparam">expectedFilePath</var>, <var class="pdparam">actualFilePath</var>, <var class="pdparam">options</var><code>)</code>;</p></div><p>
This function compares the expected XML file specified by <em class="parameter"><code>expectedFilePath</code></em>
with the actual XML file specified by <em class="parameter"><code>actualFilePath</code></em>.
If they are equal, a test result of type PASS is added to the test log and this function returns
a true value. Otherwise a test result of type FAIL is added to the test log and a false value is
returned. If the files are different the result message details will show in which line and for
what reason the comparison failed.
</p><p>
The optional parameter <em class="parameter"><code>options</code></em> can be specified as a map or dictionary.
So far the following options can be set:
</p><div class="itemizedlist"><ul type="disc" compact><li><p>ignoreNodeOrder : If this is set to <code class="code">true</code> the function will ignore
the order of elements on the same level, i.e. with the same parent element. The default is
<code class="code">false</code>.</p></li><li><p>ignoreAttributeOrder : If this is set to <code class="code">true</code> the function will ignore
the order of attributes inside an element. The default is <code class="code">true</code>.</p></li><li><p>ignoreComments : If this is set to <code class="code">true</code> the function will ignore
all comments. If it is set to <code class="code">false</code> all comments are compared. The default is
<code class="code">true</code>.</p></li><li><p>whitespaceInTextHandling : This option can be used to control how whitespaces
inside of text elements are processed. This can be set to either <code class="code">preserve</code>,
<code class="code">normalize</code> or <code class="code">trim</code>. If this is set to <code class="code">preserve</code> all whitespaces
are kept, if this is set to <code class="code">normalize</code> all whitespaces will be normalized and if this
is set to <code class="code">trim</code> whitespaces at the start and end of the text elements are removed.
The default is <code class="code">normalize</code>.</p></li><li><p>whitespaceInValuesHandling : This option can be used to control how whitespaces
inside of attribute values are processed. This can be set to either <code class="code">preserve</code>,
<code class="code">normalize</code> or <code class="code">trim</code>. If this is set to <code class="code">preserve</code> all whitespaces
are kept, if this is set to <code class="code">normalize</code> all whitespaces will be normalized and if this
is set to <code class="code">trim</code> whitespaces at the start and end of the attribute values are removed.
The default is <code class="code">preserve</code>.</p></li><li><p>ignoreCDATA : If this is set to <code class="code">true</code> only the text inside the
CDATA tags will be compared. The tags itself will be ignored. If this is set to <code class="code">false</code>
the tags will also be compared. The default is <code class="code">true</code>.</p></li><li><p>matchSpecialTags : If this is set to <code class="code">true</code> special tags like the
declaration, processing instructions and doctype tags will also be compared by value.
The default is <code class="code">false</code>.</p></li><li><p>filteredElements : This option accepts a list/array of strings representing
tag names. Tags that have a name contained inside the filtered elements list will be ignored
when comparing the two documents.</p></li><li><p>filteredAttributes : This option accepts a list/array of strings representing
attribute names. Attributes that have a name contained inside the filtered attributes list will
be ignored when comparing the two documents.</p></li></ul></div><p>
</p><p>
You can also compare XML files with the <a class="xref" href="rgs-squish.html#test.compareTextFiles-function"><code class="function">test.compareTextFiles</code></a>
function but this function has the advantage that it does not consider the file formatting.
Instead it looks directly at the structure of the files and compares nodes and attributes.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
//example 1: no options
test.compareXMLFiles("expected.xml", "actual.xml");

//example 2: you only need to specify the options you need
test.compareXMLFiles("expected.xml", "actual.xml", {'ignoreNodeOrder': false});

//example 3: with filtered attributes and elements
filteredAttributes = ["version", "xmlns"];
filteredElements = ["uri"];
options = {'ignoreNodeOrder': false,
           'ignoreAttributeOrder': true,
           'filteredAttributes': filteredAttributes,
           'filteredElements': filteredElements,
           'whitespaceInTextHandling':'trim'};
test.compareXMLFiles("expected.xml", "actual.xml", options);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
#example 1: no options
test::compareXMLFiles("expected.xml", "actual.xml");

#example 2: you only need to specify the options you need
test::compareXMLFiles("expected.xml", "actual.xml", {"ignoreNodeOrder" =&gt; 0});

#example 3: with filtered attributes and elements
my $filteredAttributes = ["version", "xmlns"];
my $filteredElements = ["uri"];
my $options = {"ignoreNodeOrder" =&gt; 0,
               "ignoreAttributeOrder" =&gt; 1,
               "filteredAttributes" =&gt; $filteredAttributes,
               "filteredElements" =&gt; $filteredElements,
               "whitespaceInTextHandling" =&gt; "trim"};
test::compareXMLFiles("expected.xml", "actual.xml", $options);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
#example 1: no options
test.compareXMLFiles("expected.xml", "actual.xml")

#example 2: you only need to specify the options you need
test.compareXMLFiles("expected.xml", "actual.xml", {'ignoreNodeOrder': False})

#example 3: with filtered attributes and elements
filteredAttributes = ["version", "xmlns"]
filteredElements = ["uri"]
options = {'ignoreNodeOrder': False,
           'ignoreAttributeOrder': True,
           'filteredAttributes': filteredAttributes,
           'filteredElements': filteredElements,
           'whitespaceInTextHandling':'trim'}
test.compareXMLFiles("expected.xml", "actual.xml", options)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
#example 1: no options
Test.compareXMLFiles("expected.xml", "actual.xml")

#example 2: you only need to specify the options you need
Test.compareXMLFiles("expected.xml", "actual.xml", {'ignoreNodeOrder' =&gt; false})

#example 3: with filtered attributes and elements
filteredAttributes = ["version", "xmlns"]
filteredElements = ["uri"]
options = {'ignoreNodeOrder' =&gt; false,
           'ignoreAttributeOrder' =&gt; true,
           'filteredAttributes' =&gt; filteredAttributes,
           'filteredElements' =&gt; filteredElements,
           'whitespaceInTextHandling' =&gt; 'trim'}
Test.compareXMLFiles("expected.xml", "actual.xml", options)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
#example 1: no options
test compareXMLFiles "expected.xml" "actual.xml"

#example 2: you only need to specify the options you need
test compareXMLFiles "expected.xml" "actual.xml" [dict create ignoreNodeOrder 0]

#example 3: with filtered attributes and elements
set filteredAttributes [list version xmlns]
set filteredElements [list uri]
set options [dict create ignoreNodeOrder 0 \
                         ignoreAttributeOrder 1 \
                         filteredAttributes $filteredAttributes \
                         filteredElements $filteredElements \
                         whitespaceInTextHandling trim]
test compareXMLFiles "expected.xml" "actual.xml" $options
</pre></div><div class="funcsynopsis"><a id="test.compareJSONFiles-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">test.compareJSONFiles</b>(</code><var class="pdparam">expectedFilePath</var>, <var class="pdparam">actualFilePath</var><code>)</code>;</p></div><p>
This function compares the expected JSON file specified by <em class="parameter"><code>expectedFilePath</code></em>
with the actual JSON file specified by <em class="parameter"><code>actualFilePath</code></em>.
If they are equal, a test result of type PASS is added to the test log and this function returns
a true value. Otherwise a test result of type FAIL is added to the test log and a false value is
returned. If the files are different the result message details will show for what reason the
comparison failed as well as a textual diff.
</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png"></img></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>
Due to features and constraints of the used JSON library, non-standard and possibly unwanted JSON might pass the test.
Please validate the JSON files and make sure there are no duplicate names before calling them with <code class="function">test.compareJSONFiles</code>!
</p></td></tr></table></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-createvvp"></a>6.3.9. Script-based Creation of Visual Verification Points</h3></div></div></div><div class="funcsynopsis"><a id="createVisualVP-function"></a><p><code class="funcdef"><b class="fsfunc">createVisualVP</b>(</code><var class="pdparam">objectNameOrReference</var>, <var class="pdparam">vpFile</var><code>)</code>;</p></div><p>
This function creates a <a class="xref" href="ug-vps.html#ugv-visual" title="5.22.4. How to Do Visual Verifications">Visual Verification Point</a> named <em class="parameter"><code>vpFile</code></em> to be
used with <a class="xref" href="rgs-squish.html#test.vp-function"><code class="function">test.vp</code></a> and <a class="xref" href="rgs-squish.html#test.xvp-function"><code class="function">test.xvp</code></a>
in a later test run.
Whereas this action is typically performed via point &amp; click in the <span class="application">Squish IDE</span>.
</p><p>The expected visual state is determined through an internal call
to <a class="xref" href="rgs-squish.html#saveObjectSnapshot-function"><code class="function">saveObjectSnapshot</code></a> for the object
denoted by <em class="parameter"><code>objectNameOrReference</code></em>.
</p><p>
The newly created verification point will have all of content,
geometry and screenshot checks enabled. The Visual Verification Point
Editor can later be used to modify these checks.
</p><p>
In case <em class="parameter"><code>vpFile</code></em> already exists the function will
throw a catchable script exception.
</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-testdata"></a>6.3.10. Test Data Functions</h3></div></div></div><p>
<span class="emphasis"><em>Squish</em></span> can handle tabular data (rows and columns—or in database
terminology, records and fields). With respect to <span class="emphasis"><em>Squish</em></span>'s data
handling functions, we use the terms “<span class="quote">row</span>” and
“<span class="quote">record</span>” as synonyms, and
similarly, “<span class="quote">column</span>” and “<span class="quote">field</span>”.
</p><p>
<span class="emphasis"><em>Squish</em></span> can read in test data from <code class="filename">.tsv</code>
(tab-separated values format), <code class="filename">.csv</code>
(comma-separated values format),
<code class="filename">.xls</code> or <code class="filename">.xlsx</code> (<span class="trademark">Microsoft</span>®
<span class="trademark">Excel</span>™ spreadsheet format) files. In
the case of <code class="filename">.csv</code> and <code class="filename">.tsv</code>
files, <span class="emphasis"><em>Squish</em></span> assumes that they use the Unicode UTF-8
encoding—the same encoding used for all test scripts.
</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important: Data Row Indexing"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"></img></td><th align="left">Data Row Indexing</th></tr><tr><td align="left" valign="top"><p>
In the <span class="application">Squish IDE</span>, the first row of data is used for the headers, with row
indexes shown counting from 1. However, the functions listed in this
subsection use 0-based indexing, so the first record is at row 0, the
second record at row 1, and so on. (And in fact the headers are
accessible at row index -1.)
</p></td></tr></table></div><p>
The test data functions are used for data-driven and keyword-driven
testing. For examples of data-driven testing see the Tutorials, and for
examples of keyword-driven testing see <a class="xref" href="how.to.do.keyword.driven.testing.html" title="5.16. How to Do Keyword-Driven Testing">How to Do Keyword-Driven Testing (Section 5.16)</a>.
</p><div class="funcsynopsis"><a id="testData.create-function"></a><p><code class="funcdef">String <b class="fsfunc">testData.create</b>(</code><var class="pdparam">where</var>, <var class="pdparam">filename</var><code>)</code>;</p></div><p>
This function returns the name of a file you can write to. If the
<em class="parameter"><code>where</code></em> parameter is <code class="code">"shared"</code>, the
filename will have a path that locates the file in the test suite's
shared test data directory
(<code class="code"><span class="emphasis"><em>test_suite</em></span>/shared/testdata/<span class="emphasis"><em>filename</em></span></code>),
and if the <em class="parameter"><code>where</code></em> is <code class="code">"local"</code> the
filename will have a path that locates the file in the test suite's,
test case's test data directory
(<code class="code"><span class="emphasis"><em>test_suite</em></span>/<span class="emphasis"><em>tst_case</em></span>/testdata/<span class="emphasis"><em>filename</em></span></code>).
</p><p>
This function is designed to be used when you are running a script in a
“<span class="quote">learning</span>” mode and want to create test data dynamically.
</p><div class="funcsynopsis"><a id="testData.dataset-function"></a><p><code class="funcdef">Dataset <b class="fsfunc">testData.dataset</b>(</code><var class="pdparam">filename</var><code>)</code>;</p></div><p>
This function (along with the <code class="code">testData.fieldNames</code>, <code class="code">testData.field</code> and <code class="code">testData.datasetExcel</code> functions), is used for data-driven and
keyword-driven testing.
</p><p>
The <code class="code">testData.dataset</code> function returns a
<span class="emphasis"><em>dataset</em></span> object that refers to an array or tuple of
records. The data is retrieved from the file specified by the
<em class="parameter"><code>filename</code></em>—providing the data is in one of
the file formats that <span class="emphasis"><em>Squish</em></span> recognizes.
</p><p>
The normal practice is for the <em class="parameter"><code>filename</code></em> to be
given without a path (e.g., <code class="filename">mydata.csv</code>). In this
case, <span class="emphasis"><em>Squish</em></span> first tries to find the file in the test case's data
(i.e., in the test case's <code class="filename">testdata</code> folder if it has
one). If that fails, <span class="emphasis"><em>Squish</em></span> next tries looking in the test suite's
shared data folder (i.e., in the test suite's
<code class="filename">shared/testdata</code> folder). If the file isn't found
(or is found but cannot be read or understood), <span class="emphasis"><em>Squish</em></span> throws a
catchable exception. If the <em class="parameter"><code>filename</code></em> is specified
with a path (e.g., <code class="filename">C:\mydata\mydata.csv</code>), then
<span class="emphasis"><em>Squish</em></span> tries to read that specific file and throws a catchable
exception if the file doesn't exist or isn't in a format that <span class="emphasis"><em>Squish</em></span>
can understand.
</p><p>
The field names and field values can be retrieved using the functions
described below.
</p><div class="funcsynopsis"><a id="testData.datasetExcel-function"></a><p><code class="funcdef">Dataset <b class="fsfunc">testData.datasetExcel</b>(</code><var class="pdparam">filename</var>, <var class="pdparam">sheetname</var><code>)</code>;</p></div><p>
This function (along with the <code class="code">testData.fieldNames</code>,
 <code class="code">testData.field</code> and <code class="code">testData.dataset</code> functions), is used for data-driven and
keyword-driven testing.
</p><p>
The <code class="code">testData.datasetExcel</code> function returns a
<span class="emphasis"><em>dataset</em></span> object that refers to an array or tuple of
records. The data is retrieved from the file specified by the
<em class="parameter"><code>filename</code></em> and <em class="parameter"><code>sheetname</code></em> — providing the data is in one of
the Excel formats i.e. having extension .xls or .xlsx. This function is a specification of the function <code class="code">testData.dataset</code>.
</p><p>
For a detailed description of the function's behavior please see info
to <code class="code">testData.dataset</code> above.
The only specific is the second parameter of the function, namely
<em class="parameter"><code>sheetname</code></em>. This is the name of the particular sheet within the Excel document.
This parameter is optional. By default the first sheet will be used.
</p><div class="funcsynopsis"><a id="testData.exists-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">testData.exists</b>(</code><var class="pdparam">filename</var><code>)</code>;</p></div><p> This is an old API and it is generally better to use
<a class="xref" href="rgs-squish.html#RemoteSystem.exists-function"><code class="function">RemoteSystem.exists</code></a> instead. </p><p>
This function returns a true value if a file called
<em class="parameter"><code>filename</code></em> exists in the AUT's current working
directory; otherwise it returns a false value.
</p><div class="funcsynopsis"><a id="testData.field-function"></a><p><code class="funcdef">String <b class="fsfunc">testData.field</b>(</code><var class="pdparam">record</var>, <var class="pdparam">fieldName</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">String <b class="fsfunc">testData.field</b>(</code><var class="pdparam">record</var>, <var class="pdparam">fieldIndex</var><code>)</code>;</p></div><p>
This function returns the value of the field specified by the given
<em class="parameter"><code>fieldName</code></em> string or the given
<em class="parameter"><code>fieldIndex</code></em> integer, taken from the specified
<em class="parameter"><code>record</code></em> (i.e., from a particular row from
the <span class="emphasis"><em>dataset</em></span> returned by the
<code class="code">testData.dataset</code> function).
</p><p>
See <a class="xref" href="ug-shareddata.html#ugsh-datadriven" title="5.23.2. How to Do Data-Driven Testing">How to Do Data-Driven Testing (Section 5.23.2)</a> for usage examples.
</p><div class="funcsynopsis"><a id="testData.fieldNames-function"></a><p><code class="funcdef">SequenceOfStrings <b class="fsfunc">testData.fieldNames</b>(</code><var class="pdparam">record</var><code>)</code>;</p></div><p>
This function returns an array or tuple of field names for the specified
<em class="parameter"><code>record</code></em> (i.e., from a particular row from
the <span class="emphasis"><em>dataset</em></span> returned by the
<code class="code">testData.dataset</code> function).
</p><div class="funcsynopsis"><a id="testData.get-function"></a><p><code class="funcdef"><b class="fsfunc">testData.get</b>(</code><var class="pdparam">filename</var><code>)</code>;</p></div><p>
This function copies the file called <em class="parameter"><code>filename</code></em>
from the AUT's current working directory to <span class="application">squishrunner</span>'s current working
directory. Generally, for copying remote files to a local machine, it is better
to use <a class="xref" href="rgs-squish.html#RemoteSystem.download-function"><code class="function">RemoteSystem.download</code></a> instead.
</p><div class="funcsynopsis"><a id="testData.remove-function"></a><p><code class="funcdef"><b class="fsfunc">testData.remove</b>(</code><var class="pdparam">filename</var><code>)</code>;</p></div><p>
This function removes the file called <em class="parameter"><code>filename</code></em>
from the AUT's current working directory.
</p><div class="funcsynopsis"><a id="testData.put-function"></a><p><code class="funcdef"><b class="fsfunc">testData.put</b>(</code><var class="pdparam">filename</var><code>)</code>;</p></div><p>
If the <em class="parameter"><code>filename</code></em> is specified without a path, this
function copies the test data file called
<em class="parameter"><code>filename</code></em> from the test case's directory into the
AUT's current working directory. If the <em class="parameter"><code>filename</code></em>
is specified with a path, this function copies the specified file into
the AUT's current working directory. When the AUT is terminated the
copied test data file is automatically <span class="emphasis"><em>deleted</em></span>.
</p><p>
This function returns the full path of the file copied or, in case of error,
throws an exception that can be caught in the test script.
</p><p>
Note that if multiple AUTs are involved—for example, if one AUT
starts another program—the deletion occurs when the program in
whose context the call to the <code class="code">testData.put</code> function was
made is terminated.
</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-objmap"></a>6.3.11. Object Map Functions</h3></div></div></div><p>
For information about manipulating the Object Map using the <span class="application">Squish IDE</span> see
the <a class="xref" href="ide.views.html#ide.the-object-map.view" title="8.2.10. Object Map view">Object Map view (Section 8.2.10)</a>. For more about Object
Maps in use see <a class="xref" href="rg-objectmap.html" title="7.11. Object Map">Object Map (Section 7.11)</a>.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>
These functions are only relevant for <a class="xref" href="rg-objectmap.html#rgo-squish-textbased" title="7.11.5. Text-Based Object Map">Text-Based Object Map (Section 7.11.5)</a>;
when using <a class="xref" href="rg-objectmap.html#rgo-squish-scriptbased" title="7.11.4. Script-Based Object Map">Script-Based Object Map (Section 7.11.4)</a>, object names are plain
script variables and hence no dedicated <acronym class="acronym">API</acronym> is required to
handle them.
</p></td></tr></table></div><div class="funcsynopsis"><a id="objectMap.add-function"></a><p><code class="funcdef"><b class="fsfunc">objectMap.add</b>(</code><var class="pdparam">object</var><code>)</code>;</p></div><p>
This function adds the given <em class="parameter"><code>object</code></em> to the object
map. (A suitable object can be obtained using the <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a> function or the <a class="xref" href="rgs-squish.html#findObject-function"><code class="function">findObject</code></a> function.)
</p><div class="funcsynopsis"><a id="objectMap.load-function"></a><p><code class="funcdef"><b class="fsfunc">objectMap.load</b>(</code><var class="pdparam">filename</var><code>)</code>;</p></div><p>
This function loads an object map from the given
<em class="parameter"><code>filename</code></em> and uses it to
<span class="emphasis"><em>replace</em></span> the current object map. If the file does
not exist, an exception is raised and the current object map is left
unchanged.
</p><div class="funcsynopsis"><a id="objectMap.realName-function"></a><p><code class="funcdef">String <b class="fsfunc">objectMap.realName</b>(</code><var class="pdparam">object</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">String <b class="fsfunc">objectMap.realName</b>(</code><var class="pdparam">symbolicName</var><code>)</code>;</p></div><p>
This function returns the real (multi-property) name for the given
<em class="parameter"><code>object</code></em>, or for the object with the given
<em class="parameter"><code>symbolicName</code></em>.
</p><div class="funcsynopsis"><a id="objectMap.symbolicName-function"></a><p><code class="funcdef">String <b class="fsfunc">objectMap.symbolicName</b>(</code><var class="pdparam">object</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">String <b class="fsfunc">objectMap.symbolicName</b>(</code><var class="pdparam">objectOrRealName</var><code>)</code>;</p></div><p>
This function tries to return the symbolic name for the specified
object or real name from the object map.
</p><p>
If the <em class="parameter"><code>objectOrRealName</code></em> is a real name,
and it does not match any existing object, it will simply be
returned; no error will be thrown.
</p><p>
If the <em class="parameter"><code>objectOrRealName</code></em> is an invalid
real name it will simply be returned; no error will be thrown.
</p><p>
If the <em class="parameter"><code>objectOrRealName</code></em> is a reference
to an object and the object map does not contain an object
name that matches this object, then a real name for this
object will be returned.
</p><div class="funcsynopsis"><a id="objectMap.symbolicNames-function"></a><p><code class="funcdef">SequenceOfStrings <b class="fsfunc">objectMap.symbolicNames</b>(</code><code>)</code>;</p></div><p>
This function returns an array (a tuple in Python) containing all the
mapped symbolic names. The returned names are in an arbitrary order.
</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-appcontext"></a>6.3.12. Application Context</h3></div></div></div><p>
Every AUT that is started by <span class="emphasis"><em>Squish</em></span> has a corresponding
<code class="code">ApplicationContext</code> object. These objects provide the
following properties and functions. (For examples of use see <a class="xref" href="ugs-appcontext.html#ugsac-appcontext" title="5.12.3. How to Use ApplicationContext Objects">How to Use ApplicationContext Objects (Section 5.12.3)</a>.)
</p><p>
Here are some quick links to the Application Context-related functions,
methods and properties:
</p><div class="informaltable"><table border="0"><colgroup><col></col><col></col><col></col></colgroup><tbody><tr valign="top"><td valign="top">
<div class="itemizedlist"><ul type="disc" compact><li><p><a class="xref" href="rgs-squish.html#applicationContext-function"><code class="function">applicationContext</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext.commandLine-property">ApplicationContext.commandLine</a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext.cwd-property">ApplicationContext.cwd</a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext.environmentVariable-function"><code class="function">applicationContext.environmentVariable</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext.host-property">ApplicationContext.host</a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext.isFrozen-function"><code class="function">applicationContext.isFrozen</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext.isRunning-property">ApplicationContext.isRunning</a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext.detach-function"><code class="function">applicationContext.detach</code></a></p></li></ul></div>
</td><td valign="top">
<div class="itemizedlist"><ul type="disc" compact><li><p><a class="xref" href="rgs-squish.html#applicationContext.name-property">ApplicationContext.name</a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext.pid-property">ApplicationContext.pid</a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext.port-property">ApplicationContext.port</a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext.readStderr-function"><code class="function">applicationContext.readStderr</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext.readStdout-function"><code class="function">applicationContext.readStdout</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext.startTime-property">ApplicationContext.startTime</a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext.totalTime-property">ApplicationContext.totalTime</a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext.usedMemory-property">ApplicationContext.usedMemory</a></p></li></ul></div>
</td><td valign="top">
<div class="itemizedlist"><ul type="disc" compact><li><p><a class="xref" href="rgs-squish.html#applicationContextList-function"><code class="function">applicationContextList</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#attachToApplication-function"><code class="function">attachToApplication</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#currentApplicationContext-function"><code class="function">currentApplicationContext</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#defaultApplicationContext-function"><code class="function">defaultApplicationContext</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#setApplicationContext-function"><code class="function">setApplicationContext</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#startApplication-function"><code class="function">startApplication</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#applicationContext.osName-property">ApplicationContext.osName</a></p></li></ul></div>
</td></tr></tbody></table></div><div class="funcsynopsis"><a id="applicationContext-function"></a><p><code class="funcdef">ApplicationContext <b class="fsfunc">applicationContext</b>(</code><var class="pdparam">name</var><code>)</code>;</p></div><p>
This function returns a handle to the application context object with
the given name.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Tcl-specific"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Tcl-specific</th></tr><tr><td align="left" valign="top"><p>When using the Tcl scripting language, this function is called
<code class="code">getApplicationContext</code>.</p></td></tr></table></div><a id="applicationContext.commandLine-property"></a>String
<span class="property">applicationContext.commandLine</span><p>
This read-only property holds the command line that the application was
started with.
</p><a id="applicationContext.cwd-property"></a>String
<span class="property">applicationContext.cwd</span><p>
This read-only property holds the application's current working directory.
</p><div class="funcsynopsis"><a id="applicationContext.environmentVariable-function"></a><p><code class="funcdef">String <b class="fsfunc">applicationContext.environmentVariable</b>(</code><var class="pdparam">name</var><code>)</code>;</p></div><p>
This function returns the value of the AUT process environment variable
called <em class="parameter"><code>name</code></em> or an empty string if no such
environment variable exists.
</p><a id="applicationContext.host-property"></a>String
<span class="property">applicationContext.host</span><p>
Every application context is connected to a <span class="application">squishserver</span> process.
This read-only property holds the computer/host name or TCP/IP address
of the computer where the <span class="application">squishserver</span> process is running and which
this application context is connected to.
</p><p>
If this application context has been created by
<a class="xref" href="rgs-squish.html#startApplication-function"><code class="function">startApplication</code></a> then this property also
denotes the computer/host name or TCP/IP address of the computer
where the AUT is running.
</p><div class="funcsynopsis"><a id="applicationContext.isFrozen-function"></a><p><code class="funcdef">bool <b class="fsfunc">applicationContext.isFrozen</b>(</code><var class="pdparam">timeout</var><code>)</code>;</p></div><p>
This function returns a false value if the application responds before
the <em class="parameter"><code>timeout</code></em> (in seconds) expired; otherwise it
returns a true value.
</p><a id="applicationContext.isRunning-property"></a>bool
<span class="property">applicationContext.isRunning</span><p>
This read-only property is <code class="code">true</code> if the communication
between squishserver and Squish Hook in the AUT is still active,
otherwise <code class="code">false</code>.
</p><p>The communication between squishserver and Squish Hook is shutting
down when the Squish Hook is shutting down. The Squish Hook in turn is
shutting down when the AUT is shutting down. (For example in case of
Qt, when the main Qt event loop exits.)
</p><p>However, the AUT shut down is not necessarily immediate: An AUT
can perform lengthy operations shortly before finally exiting, and so
for some amount of time <code class="code">isRunning</code> can be <code class="code">false</code>
even though the AUT process is still alive.
</p><div class="funcsynopsis"><a id="applicationContext.detach-function"></a><p><code class="funcdef"><b class="fsfunc">applicationContext.detach</b>(</code><code>)</code>;</p></div><p>
This function detaches from a previously started (or attached) application.
</p><p>
If the respective application has been started with
<a class="xref" href="rgs-squish.html#startApplication-function"><code class="function">startApplication</code></a> <span class="emphasis"><em>Squish</em></span> will attempt to close
it, and eventually (if still running) forcefully close it.
</p><p>
If the respective application has been attached to with
<a class="xref" href="rgs-squish.html#attachToApplication-function"><code class="function">attachToApplication</code></a> <span class="emphasis"><em>Squish</em></span> will leave it
running but detach from it, thus leaving the application running. The
application can then be attached to with
<a class="xref" href="rgs-squish.html#attachToApplication-function"><code class="function">attachToApplication</code></a> again.
</p><p>
After detaching from an application one should not access any of
its objects anymore. (This would typically be done by using object
references which had been retrieved before detaching.)
</p><p>
If the application context of
<a class="xref" href="rgs-squish.html#applicationContext.detach-function"><code class="function">applicationContext.detach</code></a> is the current
application context, then the current application context will be
changed to another (random) application context. So one must make
sure to make the desired application context the current one before
proceeding. (See <a class="xref" href="rgs-squish.html#applicationContextList-function"><code class="function">applicationContextList</code></a>,
<a class="xref" href="rgs-squish.html#currentApplicationContext-function"><code class="function">currentApplicationContext</code></a> and
<a class="xref" href="rgs-squish.html#setApplicationContext-function"><code class="function">setApplicationContext</code></a>.)
</p><a id="applicationContext.name-property"></a>String
<span class="property">applicationContext.name</span><p>
This read-only property holds the application's name.
</p><a id="applicationContext.pid-property"></a>int
<span class="property">applicationContext.pid</span><p>
This read-only property holds the application's process identifier.
</p><a id="applicationContext.port-property"></a>int
<span class="property">applicationContext.port</span><p>
Every application context is connected to a <span class="application">squishserver</span> process.
This read-only property holds the TCP port number of the <span class="application">squishserver</span>
process which this application context is connected to.
</p><div class="funcsynopsis"><a id="applicationContext.readStderr-function"></a><p><code class="funcdef">String <b class="fsfunc">applicationContext.readStderr</b>(</code><var class="pdparam"></var><code>)</code>;</p></div><p>
This function reads and returns everything which the application has
written to the <code class="code">stderr</code> stream since the last call to
<code class="code">readStderr</code>, or since the application started if there has
been no previous call.
</p><div class="funcsynopsis"><a id="applicationContext.readStdout-function"></a><p><code class="funcdef">String <b class="fsfunc">applicationContext.readStdout</b>(</code><var class="pdparam"></var><code>)</code>;</p></div><p>
This function reads and returns everything which the application has
written to the <code class="code">stdout</code> stream since the last call to
<code class="code">readStdout</code>, or since the application started if there has
been no previous call.
</p><a id="applicationContext.startTime-property"></a>time
<span class="property">applicationContext.startTime</span><p>
This read-only property holds the time when the application was started.
(The property's data type varies depending on the scripting language
used.)
</p><a id="applicationContext.totalTime-property"></a>int
<span class="property">applicationContext.totalTime</span><p>
This read-only property holds the amount of time that the AUT process has been
scheduled in user and kernel modes measured in milliseconds.
</p><a id="applicationContext.usedMemory-property"></a>int
<span class="property">applicationContext.usedMemory</span><p>
This read-only property holds the amount of memory used by the
<acronym class="acronym">AUT</acronym> process. For Windows operating systems, the value
corresponds to the working set size in bytes. For Linux operating systems, the
value corresponds to the resident set size (RSS), in bytes. For macOS, it is
also the RSS, but in Kbytes.
</p><div class="funcsynopsis"><a id="applicationContextList-function"></a><p><code class="funcdef">SequenceOfApplicationContexts <b class="fsfunc">applicationContextList</b>(</code><code>)</code>;</p></div><p>
This function returns an array (a tuple in Python) of handles to all the
existing application contexts.
</p><div class="funcsynopsis"><a id="attachToApplication-function"></a><p><code class="funcdef">ApplicationContext <b class="fsfunc">attachToApplication</b>(</code><var class="pdparam">autName</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">ApplicationContext <b class="fsfunc">attachToApplication</b>(</code><var class="pdparam">autName</var>, <var class="pdparam">squishserver_host</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">ApplicationContext <b class="fsfunc">attachToApplication</b>(</code><var class="pdparam">autName</var>, <var class="pdparam">squishserver_host</var>, <var class="pdparam">squishserver_port</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">ApplicationContext <b class="fsfunc">attachToApplication</b>(</code><var class="pdparam">autName</var>, <var class="pdparam">squishserver_host</var>, <var class="pdparam">squishserver_port</var>, <var class="pdparam">timeoutSecs</var><code>)</code>;</p></div><p>
This function causes <span class="emphasis"><em>Squish</em></span> to attach to the application called
<em class="parameter"><code>autName</code></em> and returns a handle to its application
context. The <em class="parameter"><code>autName</code></em> must be the name of an
application that has been registered with the <span class="application">squishserver</span> as an
attachable <acronym class="acronym">AUT</acronym>. (See <a class="xref" href="rg-cmdline.html#rg-squishserver--config" title="7.4.4.3. Configuring squishserver">Configuring <span class="application">squishserver</span> (Section 7.4.4.3)</a>.) No command line options can be
given since the application should already be running.
</p><p>
<em class="parameter"><code>squishserver_host</code></em> and
<em class="parameter"><code>squishserver_port</code></em>
refer to the computer where the desired <span class="application">squishserver</span> is running,
and its TCP port. (This is <span class="emphasis"><em>not</em></span> the host and
port of the attachable <acronym class="acronym">Attachable AUT</acronym>. The
<acronym class="acronym">Attachable AUT</acronym>'s host and port are specified
when the <acronym class="acronym">Attachable AUT</acronym> is registered with the
<span class="application">squishserver</span> (see <a class="xref" href="rghsa-attach.html#rghsa-attach-registeraut" title="7.8.3. Register the Attachable AUT">Register the Attachable <acronym class="acronym">AUT</acronym> (Section 7.8.3)</a>).)
</p><p>
The parameter <em class="parameter"><code>timeoutSecs</code></em> is being used
after the socket connection to the attachable AUT has been
established. If the attachable AUT requires more seconds than
specified to respond to the attaching attempt an error will be
thrown. If no <em class="parameter"><code>timeoutSecs</code></em> is specified the
<span class="application">squishserver</span>'s (Maximum Startup Time) default is used—this
is 20 seconds, unless it has been changed; see
<a class="xref" href="ide.dialogs.html#ide.squish.server.settings.dialog" title="8.3.22. Squish Server Settings dialog">Squish Server Settings dialog (Section 8.3.22)</a>.
</p><p>
If you want to specify a timeout, but don't want to change the host or
port, you can do so by passing an empty string as the host (which will
make <span class="emphasis"><em>Squish</em></span> use the configured host—<code class="code">localhost</code> by
default), and by passing -1 as the port.
</p><p>
If attaching fails (e.g,. because the <acronym class="acronym">AUT</acronym> is not
running), this function throws an exception that can be caught in the
test script. If the exception is not caught an error will be logged as
an error in the test script's execution.
</p><p>
See <a class="xref" href="rghsa-attach.html" title="7.8. Attaching to Running Applications">Attaching to Running Applications (Section 7.8)</a> for more information.
</p><div class="funcsynopsis"><a id="currentApplicationContext-function"></a><p><code class="funcdef">ApplicationContext <b class="fsfunc">currentApplicationContext</b>(</code><code>)</code>;</p></div><p>
This function returns a handle to the current application context.
</p><div class="funcsynopsis"><a id="defaultApplicationContext-function"></a><p><code class="funcdef">ApplicationContext <b class="fsfunc">defaultApplicationContext</b>(</code><code>)</code>;</p></div><p>
This function returns a handle to the default application context. It is
more reliable to use the <a class="xref" href="rgs-squish.html#currentApplicationContext-function"><code class="function">currentApplicationContext</code></a> function instead.
</p><div class="funcsynopsis"><a id="setApplicationContext-function"></a><p><code class="funcdef"><b class="fsfunc">setApplicationContext</b>(</code><var class="pdparam">contextHandle</var><code>)</code>;</p></div><p>
This function can be used to change the current application context. The
<em class="parameter"><code>contextHandle</code></em> object is a handle to an
application context that has been returned by the any of the functions
that return one—<a class="xref" href="rgs-squish.html#applicationContextList-function"><code class="function">applicationContextList</code></a>,
<a class="xref" href="rgs-squish.html#attachToApplication-function"><code class="function">attachToApplication</code></a>,
<a class="xref" href="rgs-squish.html#defaultApplicationContext-function"><code class="function">defaultApplicationContext</code></a>,
<a class="xref" href="rgs-squish.html#currentApplicationContext-function"><code class="function">currentApplicationContext</code></a>, and
<a class="xref" href="rgs-squish.html#startApplication-function"><code class="function">startApplication</code></a>.
If the argument is omitted the default context is activated.
</p><p>
If the <em class="parameter"><code>contextHandle</code></em> object is invalid—for
example, if it refers to an application that has crashed—a catchable
exception (<code class="code">TypeError</code> in Python), will be thrown.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p> Changing application contexts determines which AUT the test script
is interacting with at a given time, but it does not change the currently
active GUI window to be displayed. For that, we use the
<a class="link" href="rgs-squish.html#ToplevelWindow.setForeground-function">ToplevelWindow.setForeground</a> function.
</p></td></tr></table></div><div class="funcsynopsis"><a id="getClipboardText-function"></a><p><code class="funcdef">text <b class="fsfunc">getClipboardText</b>(</code><var class="pdparam"></var><code>)</code>;</p></div><div class="funcsynopsis"><a id="setClipboardText-function"></a><p><code class="funcdef"><b class="fsfunc">setClipboardText</b>(</code><var class="pdparam">text</var><code>)</code>;</p></div><p>
These functions can be used for getting and setting the clipboard text content
on a machine where the AUT is running.
</p><p>
When working with clipboard contents containing line breaks, be aware that
their representations (<code class="code">\n</code> and <code class="code">\r\n</code>) are OS-specific.
</p><p>
Note to Linux users: For non-Qt X11 applications this feature does require the
<span class="application">xsel</span> tool to be installed.
For non-Qt applications with alternative windowing system, this feature is not
yet available.
</p><div class="funcsynopsis"><a id="startApplication-function"></a><p><code class="funcdef">ApplicationContext <b class="fsfunc">startApplication</b>(</code><var class="pdparam">autName</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">ApplicationContext <b class="fsfunc">startApplication</b>(</code><var class="pdparam">autName</var>, <var class="pdparam">host</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">ApplicationContext <b class="fsfunc">startApplication</b>(</code><var class="pdparam">autName</var>, <var class="pdparam">host</var>, <var class="pdparam">port</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">ApplicationContext <b class="fsfunc">startApplication</b>(</code><var class="pdparam">autName</var>, <var class="pdparam">host</var>, <var class="pdparam">port</var>, <var class="pdparam">timeoutSecs</var><code>)</code>;</p></div><p>
This function starts the specified application and returns a handle
to its application context. The <em class="parameter"><code>autName</code></em> parameter
should be the name of an application whose path is already registered with
the <span class="application">squishserver</span>. (See <a class="xref" href="rg-cmdline.html#rg-squishserver--config" title="7.4.4.3. Configuring squishserver">Configuring <span class="application">squishserver</span> (Section 7.4.4.3)</a>) </p><p> It is also possible to use the absolute
path of an executable or a .jar file for <em class="parameter"><code>autName</code></em>. In
addition, command line options can be supplied here.
</p><p>
Optionally, as second and third parameters a <em class="parameter"><code>host</code></em>
and <em class="parameter"><code>port</code></em> can be specified. If these parameters
are used, instead of connecting to the default host and port (as
specified in the <span class="application">Squish IDE</span>'s settings or on <span class="application">squishrunner</span>'s command line), a
connection to the <span class="application">squishserver</span> on the specified host and listening to
the specified port will be established. This makes it possible to
control multiple applications on multiple computers from a single test
script.
</p><p>
The fourth parameter, <em class="parameter"><code>timeoutSecs</code></em> (an integer
number of seconds) can also be specified. This tells <span class="emphasis"><em>Squish</em></span> how long it
should be prepared to wait for the application to start before throwing
an error. If not specified, the <span class="application">squishserver</span>'s default is used—this
is 20 seconds, and can be changed from <span class="guimenuitem">Server
Settings</span> - <span class="guimenuitem">Application Behavior</span> -
<span class="guilabel">Maximum Startup Time</span>, or by executing
<code class="code">squishserver --config AUTTimeout numSeconds</code>.
</p><p>
If you want to specify a timeout, but don't want to specify the host or
port, you can do so by passing an empty string as the host (which will
make <span class="emphasis"><em>Squish</em></span> use the configured host—<code class="code">localhost</code> by
default), and by passing -1 as the port.
</p><p>
For more about how application context objects can be used, see <a class="xref" href="ugs-appcontext.html#ugsac-appcontext" title="5.12.3. How to Use ApplicationContext Objects">How to Use ApplicationContext Objects (Section 5.12.3)</a>. (See also, the <a class="xref" href="rgs-squish.html#waitForApplicationLaunch-function"><code class="function">waitForApplicationLaunch</code></a> function.)
</p><a id="applicationContext.osName-property"></a>String
<span class="property">applicationContext.osName</span><p>
This read-only property holds the name of the OS the AUT is running on.
Possible names include:
</p><div class="itemizedlist"><ul type="disc" compact><li><p><code class="code">"Android"</code> — Android</p></li><li><p><code class="code">"Darwin"</code> — macOS and iOS</p></li><li><p><code class="code">"Linux"</code> — Linux</p></li><li><p><code class="code">"QNX"</code> — QNX</p></li><li><p><code class="code">"SunOS"</code> — Solaris</p></li><li><p><code class="code">"Windows"</code> — Windows</p></li></ul></div><div class="funcsynopsis"><a id="connectTo-function"></a><p><code class="funcdef">ApplicationContext <b class="fsfunc">connectTo</b>(</code><var class="pdparam">target</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">ApplicationContext <b class="fsfunc">connectTo</b>(</code><var class="pdparam">target</var>, <var class="pdparam">host</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">ApplicationContext <b class="fsfunc">connectTo</b>(</code><var class="pdparam">target</var>, <var class="pdparam">host</var>, <var class="pdparam">port</var><code>)</code>;</p></div><p>
This function starts a connection to a remote desktop (eg. VNC) server and
returns a handle to its application context. The <em class="parameter"><code>target</code></em>
specifies the connection parameters.
</p><p>
The connection target can be either a URL or a map. In order to connect to a VNC
server, the parameters of both URL and parameter map need to conform to
<a class="ulink" href="https://tools.ietf.org/html/rfc7869" target="_blank">RFC 7869</a>, ie. it may
specify the following fields:
</p><div class="itemizedlist"><ul type="disc" compact><li><p><em class="parameter"><code>scheme</code></em> - the connection scheme
<code class="code">"vnc"</code>;</p></li><li><p><em class="parameter"><code>host</code></em> - the hostname of the VNC server;
</p></li><li><p><em class="parameter"><code>port</code></em> - the TCP port of the VNC server.
If no port is specified, the default value of 5900 is used;</p></li><li><p><em class="parameter"><code>VncUsername</code></em> - the user name used for
VNC authentication. Used only if required by the server;</p></li><li><p><em class="parameter"><code>VncPassword</code></em> - the password used for
VNC authentication. Used only if required by the server.</p></li></ul></div><p>Squish also offers a "Native" connection protocol which
allows the <span class="application">squishserver</span> to connect directly to a user session it is running
in, without any need for an additional remote desktop server/authentication.
In order to use it, the <code class="code">"os"</code> scheme needs to be specified as a part
of the <em class="parameter"><code>target</code></em> parameter. The <code class="code">"os"</code> scheme
accepts the following fields:</p><div class="itemizedlist"><ul type="disc" compact><li><p><em class="parameter"><code>scheme</code></em> - the connection scheme
<code class="code">"os"</code>;</p></li><li><p><em class="parameter"><code>display</code></em> - the X11 display string to
connect to. If not specified, the default display string will be used. This
parameter is only relevant on UNIX-like systems and ignored on Windows and OSX
systems.</p></li></ul></div><p>
Remote desktop connections are always routed through a <span class="application">squishserver</span> instance.
If the <em class="parameter"><code>host</code></em> and <em class="parameter"><code>port</code></em> parameters
are specified, <span class="emphasis"><em>Squish</em></span> will use the server listening at the specified address.
By default the server parameters specified in the <span class="application">Squish IDE</span>'s settings or on
<span class="application">squishrunner</span>'s command line will be used.
</p><p>
For example:
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
connectTo("vnc://example.com")
connectTo("vnc://example.com:5901")
connectTo("vnc://example.com?VncPassword=secret")
connectTo("vnc://example.com:5901?VncUsername=user&amp;VncPassword=secret")
connectTo("os://")

connectTo({"scheme": "vnc",
           "host": "example.com"})
connectTo({"scheme": "vnc",
           "host": "example.com",
           "port": 5901})
connectTo({"scheme": "vnc",
           "host": "example.com",
           "VncPassword": "secret"})
connectTo({"scheme": "vnc",
           "host": "example.com",
           "port": 5901,
           "VncUsername": "user",
           "VncPassword": "secret"})
connectTo({"scheme": "os"})
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
connectTo("vnc://example.com");
connectTo("vnc://example.com:5901");
connectTo("vnc://example.com?VncPassword=secret");
connectTo("vnc://example.com:5901?VncUsername=user&amp;VncPassword=secret");
connectTo("os://");

connectTo({scheme: "vnc",
           host: "example.com"});
connectTo({scheme: "vnc",
           host: "example.com",
           port: 5901});
connectTo({scheme: "vnc",
           host: "example.com",
           VncPassword: "secret"});
connectTo({scheme: "vnc",
           host: "example.com",
           port: 5901,
           VncUsername: "user",
           VncPassword: "secret"});
connectTo({scheme: "os"});
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
connectTo("vnc://example.com");
connectTo("vnc://example.com:5901");
connectTo("vnc://example.com?VncPassword=secret");
connectTo("vnc://example.com:5901?VncUsername=user&amp;VncPassword=secret");
connectTo("os://");

connectTo({"scheme" =&gt; "vnc",
           "host" =&gt; "example.com"});
connectTo({"scheme" =&gt; "vnc",
           "host" =&gt; "example.com",
           "port" =&gt; 5901});
connectTo({"scheme" =&gt; "vnc",
           "host" =&gt; "example.com",
           "VncPassword" =&gt; "secret"});
connectTo({"scheme" =&gt; "vnc",
           "host" =&gt; "example.com",
           "port" =&gt; 5901,
           "VncUsername" =&gt; "user",
           "VncPassword" =&gt; "secret"});
connectTo({"scheme" =&gt; "os"});
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
connectTo("vnc://example.com");
connectTo("vnc://example.com:5901");
connectTo("vnc://example.com?VncPassword=secret");
connectTo("vnc://example.com:5901?VncUsername=user&amp;VncPassword=secret");
connectTo("os://");

connectTo({"scheme" =&gt; "vnc",
           "host" =&gt; "example.com"});
connectTo({"scheme" =&gt; "vnc",
           "host" =&gt; "example.com",
           "port" =&gt; 5901});
connectTo({"scheme" =&gt; "vnc",
           "host" =&gt; "example.com",
           "VncPassword" =&gt; "secret"});
connectTo({"scheme" =&gt; "vnc",
           "host" =&gt; "example.com",
           "port" =&gt; 5901,
           "VncUsername" =&gt; "user",
           "VncPassword" =&gt; "secret"});
connectTo({"scheme" =&gt; "os"});
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
connectTo "vnc://example.com"
connectTo "vnc://example.com:5901"
connectTo "vnc://example.com?VncPassword=secret"
connectTo "vnc://example.com:5901?VncUsername=user&amp;VncPassword=secret"
connectTo "os://"

connectTo [ dict create "scheme" "vnc"
                        "host" "example.com" ]
connectTo [ dict create "scheme" "vnc"
                        "host" "example.com"
                        "port" 5901 ]
connectTo [ dict create "scheme" "vnc"
                        "host" "example.com"
                        "VncPassword" "secret" ]
connectTo [ dict create "scheme" "vnc"
                        "host" "example.com"
                        "port" 5901
                        "VncUsername" "user"
                        "VncPassword" "secret" ]
connectTo [ dict create "scheme" "os" ]
</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-image-object"></a>6.3.13. <code class="code">QImage</code> Object</h3></div></div></div><a id="idp48443864" class="indexterm"></a><p>
Most toolkits' <code class="function">grabWidget</code> function returns a
<span class="type">QImage</span> object. This object resides in the AUT process.
The class provides a single method, <code class="function">save</code>.
</p><div class="funcsynopsis"><a id="QImage.save-function"></a><p><code class="funcdef"><b class="fsfunc">QImage.save</b>(</code><var class="pdparam">filename</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">QImage.save</b>(</code><var class="pdparam">filename</var>, <var class="pdparam">imageFormat</var><code>)</code>;</p></div><p>
This method saves the image to a file with the given
<em class="parameter"><code>filename</code></em> on the computer where the AUT is running.
In case of remote execution, the function <a class="xref" href="rgs-squish.html#RemoteSystem.download-function"><code class="function">RemoteSystem.download</code></a> can be used to transfer the
image file to the computer where the test script is being executed.
</p><p>
The image file format is deduced from the filename for toolkits
where this is supported and using the specified
<em class="parameter"><code>imageFormat</code></em> otherwise.
</p><p>
For example:
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
widget = waitForObject(objectName)
image = grabWidget(widget)
image.save("C:\\screenshot1.png", "PNG")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var widget = waitForObject(objectName);
var image = grabWidget(widget);
image.save("C:\\screenshot1.png", "PNG");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
my $widget = waitForObject($objectName);
my $image = grabWidget($widget);
$image-&gt;save("C:\\screenshot1.png", "PNG");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
widget = waitForObject(objectName)
image = grabWidget(widget)
image.save("C:\\screenshot1.png", "PNG")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set widget [waitForObject $objectName]
set image [invoke grabWidget $widget]
invoke $image save "C:\\screenshot1.png" "PNG"
</pre></div><p>
This example takes a screenshot of the given object and saves it to the
file <code class="filename">screenshot1.png</code> in the root directory on
Windows, using the PNG (Portable Network Graphics) file format.
</p><p>
The available formats depend on which platform/edition you are using, but will
usually include the following:
</p><div class="itemizedlist"><ul type="disc" compact><li><p><code class="code">"BMP"</code> — Windows Bitmap</p></li><li><p><code class="code">"JPG"</code> or <code class="code">"JPEG"</code> — Joint
Photographic Experts Group</p></li><li><p><code class="code">"PNG"</code> — Portable Network
Graphics</p></li><li><p><code class="code">"PPM"</code> — Portable Pixmap</p></li><li><p><code class="code">"TIF"</code> or <code class="code">"TIFF"</code> — Tagged
Image File Format</p></li><li><p><code class="code">"XBM"</code> — X11
Bitmap (monochrome)</p></li><li><p><code class="code">"XPM"</code> — X11 Pixmap</p></li></ul></div><p>
For iOS testing, only the <code class="code">"JPEG"</code> and <code class="code">"PNG"</code>
formats are supported.
</p><p>
See also:
<span> <a class="xref" href="rgs-qtconvenience.html#qt-grabWidget-function"><code class="function">grabWidget</code></a> [Qt] </span>
<span>, <a class="xref" href="rgs-javaconvenience.html#java-grabWidget-function"><code class="function">grabWidget</code></a> [Java] </span>
<span>, <a class="xref" href="rgs-macconvenience.html#mac-grabWidget-function"><code class="function">grabWidget</code></a> [Mac] </span>
<span>, <a class="xref" href="rgs-iphoneconvenience.html#iphone-grabWidget-function"><code class="function">grabWidget</code></a> [iOS] </span>
<span>, <a class="xref" href="rgs-tkconvenience.html#tk-grabWidget-function"><code class="function">grabWidget</code></a> [Tk] </span>
<span>, <a class="xref" href="rgs-webconvenience.html#web-grabWidget-function"><code class="function">grabWidget</code></a> [Web] </span>
<span>, <a class="xref" href="rgs-windowsconvenienceapi.html#win-grabWidget-function"><code class="function">grabWidget</code></a> [Win]  </span>
<span>, <a class="xref" href="rgs-androidconvenience.html#android-grabWidget-function"><code class="function">grabWidget</code></a> [Android]</span>
. </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="script-image-object"></a>6.3.14. Image Object</h3></div></div></div><p>
The global <code class="code">Image</code> object provides functions for reading,
saving and manipulation of image files. Instances of the <code class="code">Image
</code> class can be obtained by loading an image from a file using
the <a class="xref" href="rgs-squish.html#Image.load-function"><code class="function">Image.load</code></a> or by taking
screenshots using either <a class="xref" href="rgs-squish.html#object.grabScreenshot-function"><code class="function">object.grabScreenshot</code></a>
or <a class="xref" href="rgs-squish.html#grabDesktopScreenshot-function"><code class="function">grabDesktopScreenshot</code></a> test API. It can
be used as the search region argument to image search and OCR APIs like
<a class="xref" href="rgs-squish.html#findImage-function"><code class="function">findImage</code></a>,
<a class="xref" href="rgs-squish.html#waitForImage-function"><code class="function">waitForImage</code></a>,
<a class="xref" href="rgs-squish.html#getOcrText-function"><code class="function">getOcrText</code></a>,
<a class="xref" href="rgs-squish.html#findOcrText-function"><code class="function">findOcrText</code></a>,
<a class="xref" href="rgs-squish.html#waitForOcrText-function"><code class="function">waitForOcrText</code></a>,
<a class="xref" href="rgs-squish.html#findAllOcrText-function"><code class="function">findAllOcrText</code></a>,
<a class="xref" href="rgs-squish.html#test.imagePresent-function"><code class="function">test.imagePresent</code></a> and
<a class="xref" href="rgs-squish.html#test.ocrTextPresent-function"><code class="function">test.ocrTextPresent</code></a>
</p><div class="funcsynopsis"><a id="Image-function"></a><p><code class="funcdef">Image <b class="fsfunc">Image</b>(</code><var class="pdparam">QImage</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Image <b class="fsfunc">Image</b>(</code><var class="pdparam">QPixmap</var><code>)</code>;</p></div><p>
The constructor for the <code class="code">Image</code> type. It creates an image
object out of the AUT-specific QImage and QPixmap objects.
</p><div class="funcsynopsis"><p><code class="funcdef">Image <b class="fsfunc">Image</b>(</code><var class="pdparam">width</var>, <var class="pdparam">height</var>, <var class="pdparam">[color]</var><code>)</code>;</p></div><p>
The constructor for the <code class="code">Image</code> type. It creates an image
with the specified size. The initial color of the image pixels can be
specified using the <code class="code">color</code> argument. The color may be
specified as a 32-bit ARGB value or as a set of values for each of the
color channels.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var img = new Image(100, 100, [255, 0, 0]);
img.save("C:\\red.png");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
my $img = Image-&gt;new(100, 100, [255, 0, 0]);
$img-&gt;save("C:\\red.png");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
img = Image(100, 100,[255, 0, 0])
img.save("C:\\red.png")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
img = Image.new(100, 100, [255, 0, 0]);
img.save("C:\\red.png");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set img [image new 100 100 {255 0 0}]
invoke $img save "C:\\red.png"
</pre></div><div class="funcsynopsis"><a id="Image.load-function"></a><p><code class="funcdef">Image <b class="fsfunc">Image.load</b>(</code><var class="pdparam">fileName</var><code>)</code>;</p></div><p>
This static function of the <code class="code">Image</code> object reads an image
from the specified file and returns a reference to the instance. In
case the file cannot be found or read an exception is thrown.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
img = Image.load("indicator.png")
test.compare(img.width, 32)
test.compare(img.height, 32)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var img = Image.load("indicator.png");
test.compare(img.width, 32);
test.compare(img.height, 32);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
my $img = Image::load("indicator.png");
test-&gt;compare($img-&gt;width, 32);
test-&gt;compare($img-&gt;height, 32);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
img = Image::load("indicator.png");
Test::compare(img.width, 32)
Test::compare(img.height, 32)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set img [image load "indicator.png"]
test compare [property get $img width] 32
test compare [property get $img height] 32
</pre></div><p>
The properties and functions available in the prototype of image
instances can be found below.
</p><a id="Image.width-property"></a>Number
<span class="property">width</span><p>
This property denotes the width of the image instance in pixels. The value is
read-only. When attempting to set a new value an exception is thrown.
</p><a id="Image.height-property"></a>Number
<span class="property">height</span><p>
This property denotes the height of the image instance in pixels. The value is
read-only. When attempting to set a new value an exception is thrown.
</p><div class="funcsynopsis"><a id="Image.copy-function"></a><p><code class="funcdef"><b class="fsfunc">Image.copy</b>(</code><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef"><b class="fsfunc">Image.copy</b>(</code><var class="pdparam">x</var>, <var class="pdparam">y</var>, <var class="pdparam">width</var>, <var class="pdparam">height</var><code>)</code>;</p></div><p>
This function returns a copy of a part of the image. In case the
specified geometry does not fit into the image's boundary
[(0, 0)...(width-1, height-1)], an exception is thrown. If the
coordinate parameters are not specified, the copy of the entire
image is returned.
</p><div class="funcsynopsis"><a id="Image.save-function"></a><p><code class="funcdef"><b class="fsfunc">Image.save</b>(</code><var class="pdparam">fileName</var><code>)</code>;</p></div><p>
This function saves the image instance on disk under the specified
file name. In case the path is invalid or not writable, an exception is
thrown. If the specified path is relative, the file is saved
relative to the interpreter's current working directory, which
by default, is the location of the currently executing test case.
</p><p>
The format of the saved file will be based on the file extension.
The supported formats vary depending on which platform/edition is used, but will
usually include BMP, JPG, PNG, PPM, TIF, XBM and XPM.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var img = grabDesktopScreenshot();
img.save("C:\\screenshot1.png");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
my $img = grabDesktopScreenshot();
$img-&gt;save("C:\\screenshot1.png");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
img = grabDesktopScreenshot()
img.save("C:\\screenshot1.png")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
img = grabDesktopScreenshot()
img.save("C:\\screenshot1.png")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set img [grabDesktopScreenshot]
invoke $img save "C:\\screenshot1.png"
</pre></div><div class="funcsynopsis"><a id="Image.getPixelRGBA-function"></a><p><code class="funcdef">Number <b class="fsfunc">Image.getPixelRGBA</b>(</code><var class="pdparam">x</var>, <var class="pdparam">y</var><code>)</code>;</p></div><p>
This function returns an array that contains colors of the pixel at the
specified position on the red, green, blue and alpha color channel (in
that order). In case the pixel does not lie within the boundary
of the image (from (0, 0) to (width-1, height-1)) an exception is
thrown.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
pixel = img.getPixelRGBA(0, 0)
red = pixel[0];
green = pixel[1];
blue = pixel[2];
alpha = pixel[3];
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var pixel = img.getPixelRGBA(0, 0);
var red = pixel[0];
var green = pixel[1];
var blue = pixel[2];
var alpha = pixel[3];
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
my @pixel = $img-&gt;getPixelRGBA(0, 0);
my red = $pixel[0];
my green = $pixel[1];
my blue = $pixel[2];
my alpha = $pixel[3];
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
pixel = img.getPixelRGBA(0, 0);
red = pixel[0];
green = pixel[1];
blue = pixel[2];
alpha = pixel[3];
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set pix [invoke $img getPixelRGBA 0 0]
set red [lindex $pix 0]
set green [lindex $pix 1]
set blue [lindex $pix 2]
set alpha [lindex $pix 3]
</pre></div><p>
The alpha value for fully opaque pixels is 255. Fully transparent
pixels have an alpha value 0.
</p><div class="funcsynopsis"><a id="Image.getPixel-function"></a><p><code class="funcdef">Number <b class="fsfunc">Image.getPixel</b>(</code><var class="pdparam">x</var>, <var class="pdparam">y</var><code>)</code>;</p></div><p>
This function returns the 32-bit ARGB color value of the pixel at the
specified position. In case the pixel does not lie within the boundary
of the image (from (0, 0) to (width-1, height-1)) an exception is
thrown. The value can directly be compared against expected values
(e.g. 0xff00ff00 for pure green).
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
pixel = img.getPixel(0, 0)
test.compare(pixel, 0xff102030)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var pixel = img.getPixel(0, 0);
test.compare(pixel, 0xff102030 );
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
my $pixel = $img-&gt;getPixel(0, 0);
test::compare($pixel, 0xff102030);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
pixel = img.getPixel(0, 0);
Test::compare(pixel, 0xff102030);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set pixel [invoke $img getPixel 0 0]
test compare $pixel [expr 0xff102030]
</pre></div><div class="funcsynopsis"><a id="Image.setPixel-function"></a><p><code class="funcdef">Number <b class="fsfunc">Image.setPixel</b>(</code><var class="pdparam">x</var>, <var class="pdparam">y</var>, <var class="pdparam">rgbColor</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Number <b class="fsfunc">Image.setPixel</b>(</code><var class="pdparam">x</var>, <var class="pdparam">y</var>, <var class="pdparam">Array</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Number <b class="fsfunc">Image.setPixel</b>(</code><var class="pdparam">x</var>, <var class="pdparam">y</var>, <var class="pdparam">red</var>, <var class="pdparam">green</var>, <var class="pdparam">blue</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Number <b class="fsfunc">Image.setPixel</b>(</code><var class="pdparam">x</var>, <var class="pdparam">y</var>, <var class="pdparam">red</var>, <var class="pdparam">green</var>, <var class="pdparam">blue</var>, <var class="pdparam">alpha</var><code>)</code>;</p></div><p>
This function changes the color of the pixel at the specified position.
The color may be specified as a 32-bit ARGB value, as a set of values
for each of the color channels: reg, green, blue and optionally alpha,
or an array of such values; for example:
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
img.setPixel(0, 0, 0xffff0000)
img.setPixel(0, 0, 255, 0, 0)
img.setPixel(0, 0, 255, 0, 0, 255)
img.setPixel(0, 0, [255, 0, 0])
img.setPixel(0, 0, [255, 0, 0, 255])
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
img.setPixel(0, 0, 0xffff0000);
img.setPixel(0, 0, 255, 0, 0);
img.setPixel(0, 0, 255, 0, 0, 255);
img.setPixel(0, 0, [255, 0, 0]);
img.setPixel(0, 0, [255, 0, 0, 255]);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
$img-&gt;setPixel( 0, 0, 0xffff0000);
$img-&gt;setPixel( 0, 0, 255, 0, 0);
$img-&gt;setPixel( 0, 0, 255, 0, 0, 255 );
$img-&gt;setPixel( 0, 0, [255, 0, 0]);
$img-&gt;setPixel( 0, 0, [255, 0, 0, 255]);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
img.setPixel(0, 0, 0xffff0000)
img.setPixel(0, 0, 255, 0, 0)
img.setPixel(0, 0, 255, 0, 0, 255)
img.setPixel(0, 0, [255, 0, 0])
img.setPixel(0, 0, [255, 0, 0, 255])
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
invoke $img setPixel 0 0 [expr 0xffff0000]
invoke $img setPixel 0 0 255 0 0
invoke $img setPixel 0 0 255 0 0 255
invoke $img setPixel 0 0 {255 0 0}
invoke $img setPixel 0 0 {255 0 0 255}
</pre></div><div class="funcsynopsis"><a id="Image.equals-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">Image.equals</b>(</code><var class="pdparam">otherImage</var><code>)</code>;</p></div><p>
This function returns true if this image is equal to the other image.
In case the argument does not reference an image instance an exception
is thrown.
</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-screen-object"></a>6.3.15. <code class="code">Screen</code> Object</h3></div></div></div><p>
Information about screens. In order to use this <code class="code">Screen</code> object,
the <span class="emphasis"><em>Squish</em></span> <code class="code">screen</code> library has to be included in the
script file, and Squish must be hooked into/attached to an AUT.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile("scripts", "javascript/screen.js"));

function main()
{
    startApplication("myaut");

    // ...

    var scr = Screen.byIndex(0);
    var geom = scr.geometry;
    test.log("Screen is " + geom.width + " by " + geom.height);
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use strict;
use utf8;
use warnings;

use Squish::Screen;

sub main {
    startApplication("myaut");

    # ...

    my $scr = Squish::Screen-&gt;byIndex(0);
    my $geom = $scr-&gt;geometry;
    test::log("Screen is " . $geom-&gt;width . " by " . $geom-&gt;height);
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from screen import Screen

def main():
    startApplication("myaut")

    # ...

    scr = Screen.byIndex(0)
    geom = scr.geometry
    test.log("Screen is " + str(geom.width) + " by " + str(geom.height))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require 'squish/screen'

def main
    startApplication("myaut")

    # ...

    scr = Screen::byIndex(0)
    geom = scr.geometry
    Test.log("Screen is " + geom.width.to_s + " by " + geom.height.to_s)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::screen

    # ...

    set scr [Squish::Screen byIndex 0]
    set geom [$scr geometry]
    test log [concat "Screen is " [property get $geom width] " by " [property get $geom height]]
</pre></div><div class="funcsynopsis"><a id="Screen.count-function"></a><p><code class="funcdef"><b class="fsfunc">Screen.count</b>(</code><code>)</code>;</p></div><p>
This method returns the number of <code class="code">Screen</code> objects available.
</p><div class="funcsynopsis"><a id="Screen.byIndex-function"></a><p><code class="funcdef"><b class="fsfunc">Screen.byIndex</b>(</code><var class="pdparam">index</var><code>)</code>;</p></div><p>
This method returns a <code class="code">Screen</code> object. The specified
<em class="parameter"><code>index</code></em> must be in the range of <code class="code">0</code> till
<code class="code">Screen.count() - 1</code>.
</p><a id="Screen.index-property"></a>
<span class="property">index</span><p>
Read-only property of a <code class="code">Screen</code> object which is the index of this
<code class="code">Screen</code> object in the list of all available <code class="code">Screen</code>
objects.
</p><a id="Screen.geometry-property"></a>
<span class="property">geometry</span><p>
Read-only property of a <code class="code">Screen</code> object that returns a
<a class="xref" href="rgs-squish.html#rgss-screenrectangle-object" title="6.3.21.3. UiTypes.ScreenRectangle Class">ScreenRectangle</a> containing the dimensions of this
<code class="code">Screen</code> object.
</p><a id="Screen.orientation-function"></a>
<span class="property">orientation</span><p>
Read-Write property of a <code class="code">Screen</code> object specifying the orientation
of this <code class="code">Screen</code> using one of the following 4 properties.
Instead of the following properties it's also possible to use numbers to
specify the orientation, 1 for LandscapeOrientation, 2 for PortraitOrientation,
4 for ReverseLandscapeOrientation and 8 for ReversePortraitOrientation.
</p><a id="Screen.LandscapeOrientation"></a>
<span class="property">Screen.LandscapeOrientation</span><a id="Screen.PortraitOrientation"></a>
<span class="property">Screen.PortraitOrientation</span><a id="Screen.ReverseLandscapeOrientation"></a>
<span class="property">Screen.ReverseLandscapeOrientation</span><a id="Screen.ReversePortraitOrientation"></a>
<span class="property">Screen.ReversePortraitOrientation</span><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Tcl users"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Tcl users</th></tr><tr><td align="left" valign="top"><p>
Due to language constraints, these orientation properties start with a
lowercase.
</p></td></tr></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-toplevelwindow-object"></a>6.3.16. <code class="code">ToplevelWindow</code> Object</h3></div></div></div><p>
Information about and manipulation of toplevel windows. In order to use this
<code class="code">ToplevelWindow</code> object, the <span class="emphasis"><em>Squish</em></span> <code class="code">toplevelwindow</code>
library has to be included in the script file.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile("scripts", "javascript/toplevelwindow.js"));

    // ...

    var win = ToplevelWindow.focused();
    var geom = win.geometry;
    test.log("Focused window is " + geom.width + " by " + geom.height);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use strict;
use utf8;
use warnings;

use Squish::ToplevelWindow;

    # ...

    my $win = Squish::ToplevelWindow-&gt;focused();
    my $geom = $win-&gt;geometry;
    test::log("Focused window is " . $geom-&gt;width . " by " . $geom-&gt;height);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from toplevelwindow import *

    # ...

    win = ToplevelWindow.focused()
    geom = win.geometry
    test.log("Focused window is " + str(geom.width) + " by " + str(geom.height))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require 'squish/toplevelwindow'

    # ...

    win = ToplevelWindow::focused()
    geom = win.geometry
    test.log("Focused window is " + geom.width + " by " + geom.height)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::toplevelwindow

    # ...

    set win [Squish::ToplevelWindow focused]
    set geom [$win geometry]
    test log "Focused window is [property get $geom width] by [property get $geom height]"
</pre></div><div class="funcsynopsis"><a id="ToplevelWindow.byName-function"></a><p><code class="funcdef"><b class="fsfunc">ToplevelWindow.byName</b>(</code><var class="pdparam">objectname</var>, <var class="pdparam">timeout</var><code>)</code>;</p></div><div class="funcsynopsis"><a id="ToplevelWindow.byObject-function"></a><p><code class="funcdef"><b class="fsfunc">ToplevelWindow.byObject</b>(</code><var class="pdparam">object</var><code>)</code>;</p></div><p>
These methods return a <code class="classname">ToplevelWindow</code> object for the given
<em class="parameter"><code>objectname</code></em> or <em class="parameter"><code>object</code></em>. The first
is a convenience method for calling the second, with the result
of <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a>. These methods accept different
argument types depending on the toolkit, and should work with most top-level
windows such as Dialogs, Main Windows, and Browser Tabs.
</p><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
    tlw = ToplevelWindow.byName({'type': 'BrowserTab'})
    #  ... is equivalent to ...
    tlw = ToplevelWindow.byObject(activeBrowserTab())
</pre></div><div class="funcsynopsis"><a id="ToplevelWindow.focused-function"></a><p><code class="funcdef"><b class="fsfunc">ToplevelWindow.focused</b>(</code><code>)</code>;</p></div><p>
This method returns a <code class="code">ToplevelWindow</code> object for the window
having the keyboard focus. When no window found having the keyboard focus,
an exception is raised.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Squish for Web specific"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"><span class="emphasis"><em>Squish</em></span> for Web specific</th></tr><tr><td align="left" valign="top"><p>
To obtain an instance of <code class="classname">TopLevelWindow</code>
from <span class="emphasis"><em>Squish</em></span> for Web, use <code class="code">ToplevelWindow.byObject(activeBrowserTab())</code>.
The <code class="function">focused()</code> method is not supported.
</p></td></tr></table></div><a id="ToplevelWindow.geometry-property"></a>
<span class="property">geometry</span><p>
Read-only property of a <code class="code">ToplevelWindow</code> object that returns a
<a class="xref" href="rgs-squish.html#rgss-screenrectangle-object" title="6.3.21.3. UiTypes.ScreenRectangle Class">ScreenRectangle</a> containing the dimensions of
the referenced window.
</p><a id="ToplevelWindow.nativeObject-property"></a>
<span class="property">nativeObject</span><p>
Read-only property of a <code class="code">ToplevelWindow</code> object that returns the
object for which this <code class="code">ToplevelWindow</code> object was created.
</p><div class="funcsynopsis"><a id="ToplevelWindow.close-function"></a><p><code class="funcdef"><b class="fsfunc">close</b>(</code><code>)</code>;</p></div><p>
This method closes the window referenced by this <code class="code">ToplevelWindow</code>
object.
</p><div class="funcsynopsis"><a id="ToplevelWindow.maximize-function"></a><p><code class="funcdef"><b class="fsfunc">maximize</b>(</code><code>)</code>;</p></div><p>
This method maximizes the window referenced by this <code class="code">ToplevelWindow</code>
object.
</p><div class="funcsynopsis"><a id="ToplevelWindow.minimize-function"></a><p><code class="funcdef"><b class="fsfunc">minimize</b>(</code><code>)</code>;</p></div><p>
This method minimizes the window referenced by this <code class="code">ToplevelWindow</code>
object.
</p><div class="funcsynopsis"><a id="ToplevelWindow.moveTo-function"></a><p><code class="funcdef"><b class="fsfunc">moveTo</b>(</code><var class="pdparam">x</var>, <var class="pdparam">y</var><code>)</code>;</p></div><p>
This method moves the client-area (excluding window borders) upper left corner
of the window referenced by this <code class="code">ToplevelWindow</code> object, to the
given global position.
</p><div class="funcsynopsis"><a id="ToplevelWindow.resizeTo-function"></a><p><code class="funcdef"><b class="fsfunc">resizeTo</b>(</code><var class="pdparam">width</var>, <var class="pdparam">height</var><code>)</code>;</p></div><p>
This method resizes the client-area (excluding window borders) of the window
referenced by this <code class="code">ToplevelWindow</code> object, to the given
<em class="parameter"><code>width</code></em> and <em class="parameter"><code>height</code></em>.
</p><div class="funcsynopsis"><a id="ToplevelWindow.restore-function"></a><p><code class="funcdef"><b class="fsfunc">restore</b>(</code><code>)</code>;</p></div><p>
This method restores the window referenced by this <code class="code">ToplevelWindow</code>
object from fullscreen.
</p><div class="funcsynopsis"><a id="ToplevelWindow.setFocus-function"></a><p><code class="funcdef"><b class="fsfunc">setFocus</b>(</code><code>)</code>;</p></div><p>
This method sets the keyboard input focus to the window referenced by this
<code class="code">ToplevelWindow</code> object.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Windows specific "><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Windows specific </th></tr><tr><td align="left" valign="top"><p> On Windows, there is a feature called "focus theft protection"
that prevents certain APIs from being able to change the focus from the
active window.
Therefore, <code class="function">setFocus</code> may have no effect on Windows
systems.
</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Squish for Web specific"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"><span class="emphasis"><em>Squish</em></span> for Web specific</th></tr><tr><td align="left" valign="top"><p>
This function is not supported for <span class="emphasis"><em>Squish</em></span> for Web, it will generate an error
when being used
</p></td></tr></table></div><div class="funcsynopsis"><a id="ToplevelWindow.setForeground-function"></a><p><code class="funcdef"><b class="fsfunc">setForeground</b>(</code><code>)</code>;</p></div><p>
This raises the window referenced by this <code class="code">ToplevelWindow</code> object.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Windows specific "><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Windows specific </th></tr><tr><td align="left" valign="top"><p> On Windows, there is a feature called "foreground lock protection"
that prevents certain APIs from being able to change the foreground window.
Therefore, <code class="function">setForeground</code> may have no effect on Windows
systems.
</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Squish for Web specific"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"><span class="emphasis"><em>Squish</em></span> for Web specific</th></tr><tr><td align="left" valign="top"><p>
This function is not supported for <span class="emphasis"><em>Squish</em></span> for Web, it will generate an error
when being used
</p></td></tr></table></div><div class="funcsynopsis"><a id="ToplevelWindow.setFullscreen-function"></a><p><code class="funcdef"><b class="fsfunc">setFullscreen</b>(</code><code>)</code>;</p></div><p>
This changes the window referenced by this <code class="code">ToplevelWindow</code> object
to fullscreen, i.e. covering the whole screen without window borders. Use
<a class="xref" href="rgs-squish.html#ToplevelWindow.restore-function"><code class="function">restore</code></a> to undo this operation.
</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-info"></a>6.3.17. <code class="code">squishinfo</code> Object</h3></div></div></div><p>
The global <span class="type">squishinfo</span> object provides the following
properties.
</p><a id="squishinfo.major-property"></a>int
<span class="property">squishinfo.major</span><p>
This read-only property holds <span class="emphasis"><em>Squish</em></span>'s major version number as a
single integer (e.g., 4).
</p><a id="squishinfo.minor-property"></a>int
<span class="property">squishinfo.minor</span><p>
This read-only property holds <span class="emphasis"><em>Squish</em></span>'s minor version number as a
single integer (e.g., 0).
</p><a id="squishinfo.patch-property"></a>int
<span class="property">squishinfo.patch</span><p>
This read-only property holds <span class="emphasis"><em>Squish</em></span>'s patch level version number as a
single integer (e.g., 1).
</p><a id="squishinfo.resultDir-property"></a>String
<span class="property">squishinfo.resultDir</span><p>
This read-only property holds the path to the results directory.
</p><a id="squishinfo.settingsGroup-property"></a>—<span class="emphasis"><em>deprecated</em></span>—String
<span class="property">squishinfo.settingsGroup</span><p>
This read-only property holds the current test's currently active
settings group.
</p><a id="squishinfo.testCase-property"></a>String
<span class="property">squishinfo.testCase</span><p>
This read-only property holds the current test case's path.
</p><a id="squishinfo.testCaseName-property"></a>
String <span class="property">squishinfo.testCaseName</span>
<p>
This read-only property holds the current test case's name.
</p><a id="squishinfo.testSuiteName-property"></a>
String <span class="property">squishinfo.testSuiteName</span>
<p>
This read-only property holds the current test suite's name.
</p><a id="squishinfo.version-property"></a>int
<span class="property">squishinfo.version</span><p>
This read-only property holds <span class="emphasis"><em>Squish</em></span>'s complete version number
(major/minor/patch/release) as a single integer (see explanation further
on).
</p><p>
The <code class="code">squishinfo.version</code> number is a unique number that
represents the complete <span class="emphasis"><em>Squish</em></span> version number
(major/minor/patch/release). The number is composed of four bytes by
representing each part as a one-byte hexadecimal number. So
<span class="emphasis"><em>Squish</em></span> 4.0.1-final would be represented by the number
<code class="code">0x040001FF</code> where the <code class="code">0x04</code> is the major version
(4), the <code class="code">0x00</code> the minor version (0), the <code class="code">0x01</code>
the patch version (1), and the <code class="code">0xFF</code> the release (final).
The release is encoded using one of three hexadecimal numbers:
<code class="code">0xAA</code> is used for “<span class="quote">alpha</span>”, <code class="code">0xBB</code>
for “<span class="quote">beta</span>”, and <code class="code">0xFF</code> for “<span class="quote">final</span>”.
</p><p>
Using a hexadecimal format version number makes it easy to write
version-specific code in test scripts. Here's an example where we want
some code executed only for <span class="emphasis"><em>Squish</em></span> 4.0.0-final or later (for
example, to take advantage of some <span class="emphasis"><em>Squish</em></span> 4-specific
functionality):
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
if squishinfo.version &gt;= 0x040000FF:
   # code meant for Squish version 4.0.0-final or higher
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
if (squishinfo.version &gt;= 0x040000FF) {
   // code meant for Squish version 4.0.0-final or higher
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
if (squishinfo-&gt;version &gt;= 0x040000FF) {
   # code meant for Squish version 4.0.0-final or higher
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
if Squishinfo.version &gt;= 0x040000FF
   # code meant for Squish version 4.0.0-final or higher
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
if {[squishinfo version] &gt;= 0x040000FF} {
   # code meant for Squish version 4.0.0-final or higher
}
</pre></div><a id="squishinfo.version_str-property"></a>String
<span class="property">squishinfo.version_str</span><p>
This read-only property holds <span class="emphasis"><em>Squish</em></span>'s version number as a
human-readable string (e.g., "4.0.1-final").
</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgs-testinteraction"></a>6.3.18. <code class="code">testInteraction</code> Functions</h3></div></div></div><p>
<span class="emphasis"><em>Squish</em></span> provides several functions for tests which need interaction with a
real user during replay. Such interaction includes simple questions for manual
verification as well as providing user-input, i.e. for manually driven testing
or for taking notes while observing test execution.
</p><p>
<code class="code">testInteraction</code> functions that display a message box return one of
the following constant values depending on the button that was pressed by the
user:
</p><div class="itemizedlist"><ul type="disc"><li><p>testInteraction.Ok</p></li><li><p>testInteraction.Yes</p></li><li><p>testInteraction.No</p></li></ul></div><p>
</p><p>
Any <code class="code">testInteraction</code> function that displays a dialog shows
the current testscript filename and line number in its title bar.
</p><p>
Calling any of these functions only works if <span class="application">squishrunner</span> was started with
the <code class="option">--interactive</code> option (See also <a class="xref" href="rg-cmdline.html#rg-squishrunner-cli--testsuite" title="7.4.3.3. squishrunner --testsuite: Running tests in batch mode">squishrunner --testsuite: Running tests in batch mode (Section 7.4.3.3)</a>). Tests executed from the <span class="application">Squish IDE</span> are
always run in interactive mode. Calling any of the <code class="code">testInteraction</code>
functions (except for <code class="code">testInteraction.isAvailable()</code>) in
non-interactive mode will result in a script error causing script execution to
abort.
</p><div class="funcsynopsis"><a id="testInteraction.choice-function"></a><p><code class="funcdef">string <b class="fsfunc">testInteraction.choice</b>(</code><var class="pdparam">message</var>, <var class="pdparam">items</var><code>)</code>;</p></div><p>
Shows a dialog with <em class="parameter"><code>message</code></em> as message text and a list
of <em class="parameter"><code>items</code></em> to choose from. The returned string contains
the selected item text or an empty string if the user canceled the dialog.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var name = testInteraction.choice("Choose something", ["First", "Second", "Third"])
if (name == "") {
  test.warning("No item was chosen")
} else {
  test.log(item + " it is!")
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
my $item = testInteraction::choice("Choose something", ["First", "Second", "Third"]);
if ($item eq "") {
  test::warning("No item was chosen");
} else {
  test::log($item." it is!");
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
item = testInteraction.choice("Choose something", ["First", "Second", "Third"])
if not item:
  test.warning("No item was chosen")
else:
  test.log("{} it is!".format(item))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
item = TestInteraction.choice("Choose something", ["First", "Second", "Third"])
if item == ""
  Test.warning("No item was chosen")
else
  Test.log("#{item} it is!")
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set item [testInteraction choice "Choose something" [list "First" "Second" "Third"]]
if {$item == ""} {
  test warning "No item was chosen"
} {
  test log "$item it is!"
}
</pre></div><div class="funcsynopsis"><a id="testInteraction.information-function"></a><p><code class="funcdef">int <b class="fsfunc">testInteraction.information</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><p>
Shows a message box with <em class="parameter"><code>message</code></em> as message text, an
information icon and an <span class="guilabel">OK</span> button.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
testInteraction.information("This is the 'information' function.\nPress 'OK' to continue.")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
testInteraction::information("This is the 'information' function.\nPress 'OK' to continue.");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
testInteraction.information("This is the 'information' function.\nPress 'OK' to continue.")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
TestInteraction.information("This is the 'information' function.\nPress 'OK' to continue.")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
testInteraction information "This is the 'information' function.\nPress 'OK' to continue."
</pre></div><div class="funcsynopsis"><a id="testInteraction.input-function"></a><p><code class="funcdef">string <b class="fsfunc">testInteraction.input</b>(</code><var class="pdparam">message</var>, <var class="pdparam">initialText</var><code>)</code>;</p></div><p>
Shows a dialog with <em class="parameter"><code>message</code></em> as message text and a line
edit for user input. The optional <em class="parameter"><code>initialText</code></em> sets the
initial text of the line edit. The returned string contains the contents of the
line edit or an empty string if the user canceled the dialog.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
name = testInteraction.input("Type in your name and press one of buttons below.")
if (name == "") {
  testInteraction.warning("It's sad you don't want to share your name.")
} else {
  testInteraction.information("Hello " + name + "!")
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
$name = testInteraction::input("Type in your name and press one of buttons below.");
if ($name eq "") {
  testInteraction::warning("It's sad you don't want to share your name.");
} else {
  testInteraction::information("Hello $name!");
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
name = testInteraction.input("Type in your name and press one of buttons below.")
if name == "":
  testInteraction.warning("It's sad you don't want to share your name.")
else:
  testInteraction.information("Hello %s!" %name)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
name = TestInteraction.input("Type in your name and press one of buttons below.")
if name == ""
  TestInteraction.warning("It's sad you don't want to share your name.")
else
  TestInteraction.information("Hello " + name + "!")
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set name [testInteraction input "Type in your name and press one of buttons below."]
if {$name == ""} {
  testInteraction warning "It's sad you don't want to share your name."
} {
  testInteraction information "Hello $name!"
}
 </pre></div><div class="funcsynopsis"><a id="testInteraction.isAvailable-function"></a><p><code class="funcdef">bool <b class="fsfunc">testInteraction.isAvailable</b>(</code><code>)</code>;</p></div><p>
This function returns whether the test script is executed by a <span class="application">squishrunner</span>
that was started including the <code class="option">--interactive</code> option.  This
allows creating tests that only show interactive dialogs on request but also
run in a non-interactive way.
</p><div class="funcsynopsis"><a id="testInteraction.notification-function"></a><p><code class="funcdef">void <b class="fsfunc">testInteraction.notification</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><div class="funcsynopsis"><a id="testInteraction.notification-timeout-function"></a><p><code class="funcdef">void <b class="fsfunc">testInteraction.notification</b>(</code><var class="pdparam">message</var>, <var class="pdparam">timeoutSecs</var><code>)</code>;</p></div><p>
    Shows a timed non-blocking message box with <em class="parameter"><code>message</code></em> as message text for <em class="parameter"><code>timeoutSecs</code></em> seconds.
    If <em class="parameter"><code>timeoutSecs</code></em> is not provided, the message box will be shown for 5 seconds.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
timeOut = 2
testInteraction.notification("This is the 'notification' function.\nWait " + timeOut +" seconds for message box to close.", timeOut)
//or
testInteraction.notification("This is the 'notification' function.\nWait 5 seconds for message box to close.")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
$timeOut = 2;
testInteraction::notification("This is the 'notification' function.\nWait $timeOut seconds for message box to close.", $timeOut);
#or
testInteraction::notification("This is the 'notification' function.\nWait 5 seconds for message box to close.");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
timeOut = 2
testInteraction.notification("This is the 'notification' function.\nWait %s seconds for message box to close." %timeOut, timeOut)
#or
testInteraction.notification("This is the 'notification' function.\nWait 5 seconds for message box to close.")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
timeOut = "2"
TestInteraction.notification("This is the 'notification' function.\nWait "+ timeOut + " seconds for message box to close.", timeOut)
#or
TestInteraction.notification("This is the 'notification' function.\nWait 5 seconds for message box to close.")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set timeOut 2
testInteraction notification "This is the 'notification' function.\nWait $timeOut seconds for message box to close." $timeOut
#or
testInteraction notification "This is the 'notification' function.\nWait 5 seconds for message box to close."
</pre></div><div class="funcsynopsis"><a id="testInteraction.password-function"></a><p><code class="funcdef">string <b class="fsfunc">testInteraction.password</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><p>
Shows a dialog with <em class="parameter"><code>message</code></em> as message text and a line
edit with asterisks instead of the characters actually entered for user input.
The returned string contains the contents of the line edit or an empty string if the user canceled the dialog.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
passwd = testInteraction.password("Type 'P@ssw0rd' without quotes to reveal secret information.")
if (passwd == "P@ssw0rd") {
  testInteraction.information("The secret information is: The Cake is a Lie!")
} else {
  testInteraction.warning("Wrong password. It seems the secret will remain hidden.")
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
$passwd = testInteraction::password("Type 'Passw0rd' without quotes to reveal secret information.");
if ($passwd eq "Passw0rd") {
  testInteraction::information("The secret information is: The Cake is a Lie!");
} else {
  testInteraction::warning("Wrong password. It seems the secret will remain hidden.");
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
passwd = testInteraction.password("Type 'P@ssw0rd' without quotes to reveal secret information.")
if passwd == "P@ssw0rd":
  testInteraction.information("The secret information is: The Cake is a Lie!")
else:
  testInteraction.warning("Wrong password. It seems the secret will remain hidden.")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
passwd = TestInteraction.password("Type 'P@ssw0rd' without quotes to reveal secret information.")
if passwd == "P@ssw0rd"
  TestInteraction.information("The secret information is: The Cake is a Lie!")
else
  TestInteraction.warning("Wrong password. It seems the secret will remain hidden.")
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set passwd [testInteraction password "Type 'P@ssw0rd' without quotes to reveal secret information."]
if {$passwd == "P@ssw0rd"} {
  testInteraction information "The secret information is: The Cake is a Lie!"
} {
  testInteraction warning "Wrong password. It seems the secret will remain hidden."
}
</pre></div><div class="funcsynopsis"><a id="testInteraction.question-function"></a><p><code class="funcdef">int <b class="fsfunc">testInteraction.question</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><p>
Shows a message box with <em class="parameter"><code>message</code></em> as message text, a
questionmark-icon, a <span class="guilabel">Yes</span> button and a
<span class="guilabel">No</span> button.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
questionResult = testInteraction.question("Do you wish to continue?")
if (questionResult == testInteraction.Yes) {
  testInteraction.information("Button 'Yes' was pressed.")
} else {
  testInteraction.information("Button 'No' was pressed.")
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
$questionResult = testInteraction::question("Do you wish to continue?");
if ($questionResult == testInteraction::Yes) {
  testInteraction::information("Button 'Yes' was pressed.");
} else {
  testInteraction::information("Button 'No' was pressed.");
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
questionResult = testInteraction.question("Do you wish to continue?")
if questionResult == testInteraction.Yes:
  testInteraction.information("Button 'Yes' was pressed.")
else:
  testInteraction.information("Button 'No' was pressed.")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
questionResult = TestInteraction.question("Do you wish to continue?")
if questionResult == TestInteraction::YES
  TestInteraction.information("Button 'Yes' was pressed.")
else
  TestInteraction.information("Button 'No' was pressed.")
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set questionResult [testInteraction question "Do you wish to continue?"]
if {$questionResult == [testInteraction Yes] } {
  testInteraction information "Button 'Yes' was pressed."
} {
  testInteraction information "Button 'No' was pressed."
}
</pre></div><div class="funcsynopsis"><a id="testInteraction.showImage-function"></a><p><code class="funcdef">void <b class="fsfunc">testInteraction.showImage</b>(</code><var class="pdparam">image</var>, <var class="pdparam">[message]</var>, <var class="pdparam">[timeoutSecs]</var><code>)</code>;</p></div><p>
Shows a timed non-blocking dialog that contains the <em class="parameter"><code>image</code></em>
, a <em class="parameter"><code>message</code></em> message text, and a <span class="guilabel">OK</span>
button. If <em class="parameter"><code>timeoutSecs</code></em> is not provided, the dialog will
be shown for 5 seconds.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var img = grabDesktopScreenshot();
testInteraction.showImage(img, "Current desktop", 2);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
my $img = grabDesktopScreenshot();
testInteraction::showImage($img, "Current desktop", 2);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
img = grabDesktopScreenshot()
testInteraction.showImage(img, "Current desktop", 2)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
img = grabDesktopScreenshot();
TestInteraction.showImage(img, "Current desktop", 2)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set img [grabDesktopScreenshot]
testInteraction showImage $img, "Current desktop", 2
</pre></div><div class="funcsynopsis"><a id="testInteraction.warning-function"></a><p><code class="funcdef">int <b class="fsfunc">testInteraction.warning</b>(</code><var class="pdparam">message</var><code>)</code>;</p></div><p>
Shows a message box with <em class="parameter"><code>message</code></em> as message text, a
warning-icon and an <span class="guilabel">OK</span> button.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
testInteraction.warning("This is the 'warning' function.\nPress 'OK' to continue.")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
testInteraction::warning("This is the 'warning' function.\nPress 'OK' to continue.");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
testInteraction.warning("This is the 'warning' function.\nPress 'OK' to continue.")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
TestInteraction.warning("This is the 'warning' function.\nPress 'OK' to continue.")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
testInteraction warning "This is the 'warning' function.\nPress 'OK' to continue."
</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgs-testsettings"></a>6.3.19. <code class="code">testSettings</code> Object</h3></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="rgs-squish.html#rgs-testsettings-config">6.3.19.1. Set initial <code class="code">testSettings</code> Object values in the <code class="code">config.xml</code></a></span></dt></dl></div><p>
<span class="emphasis"><em>Squish</em></span> provides a global <code class="code">testSettings</code> object whose
properties and methods can be set to control certain aspects of test
execution.
</p><div class="funcsynopsis"><a id="testSettings.getWrappersForApplication-function"></a><p><code class="funcdef">SequenceOfStrings <b class="fsfunc">testSettings.getWrappersForApplication</b>(</code><var class="pdparam">application</var><code>)</code>;</p></div><p>
This function returns the list of wrappers associated with the specified
<em class="parameter"><code>application</code></em>. (See also <a class="xref" href="rgs-squish.html#testSettings.setWrappersForApplication-function"><code class="function">testSettings.setWrappersForApplication</code></a>.)
</p><a id="testSettings.logScreenshotOnFail-property"></a>bool
<span class="property">testSettings.logScreenshotOnFail</span><p>
If this property is true every test failure will cause <span class="emphasis"><em>Squish</em></span> to take
a screenshot of the desktop when the failure occurred; by default this
property is false and screenshots of failures are not automatically taken
</p><p>
For example, let's assume that we occasionally experience test failures
when verifying the state of a specific widget in our nightly tests. We
cannot explain the cause of the problem but suspect that the overall
state of our application's GUI is broken due to as yet unknown external
factors. To provide the developers with useful information via a visual
inspection we enable automatic screenshot capturing—but for only
for the test that is causing concern:
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
testSettings.logScreenshotOnFail = True
# ... perform test ...
testSettings.logScreenshotOnFail = False
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
testSettings.logScreenshotOnFail = true;
// ... perform test ...
testSettings.logScreenshotOnFail = false;
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
testSettings-&gt;logScreenshotOnFail(1);
# ... perform test ...
testSettings-&gt;logScreenshotOnFail(0);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
TestSettings.logScreenshotOnFail = true
# ... perform test ...
TestSettings.logScreenshotOnFail = false
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
testSettings set logScreenshotOnFail 1
# ... perform test ...
testSettings set logScreenshotOnFail 0
</pre></div><a id="testSettings.logScreenshotOnError-property"></a>bool
<span class="property">testSettings.logScreenshotOnError</span><p>
If this property is true every test error will cause <span class="emphasis"><em>Squish</em></span> to take
a screenshot of the desktop when the error occurred; by default this
property is false and screenshots of errors are not automatically taken
</p><a id="testSettings.logScreenshotOnPass-property"></a>bool
<span class="property">testSettings.logScreenshotOnPass</span>
<p>
If this property is true every test pass will cause <span class="emphasis"><em>Squish</em></span> to take
a screenshot of the desktop. By default this property is false and
this screenshots are not automatically taken for test passes.
</p><a id="testSettings.logStacktraceOnLog-property"></a>
bool <span class="property">testSettings.logStacktraceOnLog</span>
<p>
If this property is true every test log will have a stacktrace attached in test reports that
support stacktrace information.
By default this property is false.
</p><a id="testSettings.logStacktraceOnPass-property"></a>
bool <span class="property">testSettings.logStacktraceOnPass</span>
<p>
If this property is true every test pass will have a stacktrace attached in test reports that
support stacktrace information.
By default this property is false.
</p><a id="testSettings.objectNotFoundDebugging-property"></a>bool
<span class="property">testSettings.objectNotFoundDebugging</span><p>
If this property is false the object not found debug dialog will not
open if an object can not be located or is not ready. By default this
property is true and the object not found dialog will open, whenever
an object can not be located or is not ready in time.
</p><p>
Some algorithms require to determine if an object is ready or not,
without triggering the object not found dialog. In script sections
that would normally trigger unwanted object not found dialogs, you can
use the objectNotFoundDebugging property to temporarily deactivate
the dialog:
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
testSettings.objectNotFoundDebugging = False
# ... wait for object that might not exist or get ready in time ...
testSettings.objectNotFoundDebugging = True
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
testSettings.objectNotFoundDebugging = false;
// ... wait for object that might not exist or get ready in time ...
testSettings.objectNotFoundDebugging = true;
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
testSettings-&gt;objectNotFoundDebugging(0);
# ... wait for object that might not exist or get ready in time ...
testSettings-&gt;objectNotFoundDebugging(1);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
TestSettings.objectNotFoundDebugging = false
# ... wait for object that might not exist or get ready in time ...
TestSettings.objectNotFoundDebugging = true
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
testSettings set objectNotFoundDebugging 0
# ... wait for object that might not exist or get ready in time ...
testSettings set objectNotFoundDebugging 1
</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Object Not Found debugging"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Object Not Found debugging</th></tr><tr><td align="left" valign="top"><p>
The <a class="xref" href="ide.dialogs.html#ide.object.not.found.dialog" title="8.3.14. Object Not Found dialog">Object Not Found dialog (Section 8.3.14)</a> will not be shown
if the <span class="guilabel">Halt Test Execution in case of 'Object not found'
issues</span> is disabled on the <span class="guilabel">Playback</span>
<a class="xref" href="ide.dialogs.html#squish.pane" title="8.3.17.7. Squish pane">Squish pane (Section 8.3.17.7)</a> in the IDE preferences.</p></td></tr></table></div><a id="testSettings.imageNotFoundDebugging-property"></a>bool
<span class="property">testSettings.imageNotFoundDebugging</span><p>
If this property is false the image not found debug dialog will not
open if an template image can not be located. By default this
property is true and the image not found dialog will open, whenever
a template image can not be located in time.
</p><p>
Some algorithms require image search without triggering the image not
found dialog. In script sections that would normally trigger unwanted
image not found dialogs, you can use the imageNotFoundDebugging property
to temporarily deactivate the dialog:
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
testSettings.imageNotFoundDebugging = False
# ... wait for image that might not exist in time ...
testSettings.imageNotFoundDebugging = True
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
testSettings.imageNotFoundDebugging = false;
// ... wait for image that might not exist in time ...
testSettings.imageNotFoundDebugging = true;
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
testSettings-&gt;imageNotFoundDebugging(0);
# ... wait for image that might not exist in time ...
testSettings-&gt;imageNotFoundDebugging(1);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
TestSettings.imageNotFoundDebugging = false
# ... wait for image that might not exist in time ...
TestSettings.imageNotFoundDebugging = true
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
testSettings set imageNotFoundDebugging 0
# ... wait for image that might not exist in time ...
testSettings set imageNotFoundDebugging 1
</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Image Not Found debugging"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Image Not Found debugging</th></tr><tr><td align="left" valign="top"><p>
The <a class="xref" href="ide.dialogs.html#ide.image.not.found.dialog" title="8.3.4. Image Not Found dialog">Image Not Found dialog (Section 8.3.4)</a> will not be shown
if the <span class="guilabel">Halt Test Execution in case of 'Image not found'
issues</span> is disabled on the <span class="guilabel">Playback</span>
<a class="xref" href="ide.dialogs.html#squish.pane" title="8.3.17.7. Squish pane">Squish pane (Section 8.3.17.7)</a> in the IDE preferences.</p></td></tr></table></div><a id="testSettings.textNotFoundDebugging-property"></a>bool
<span class="property">testSettings.textNotFoundDebugging</span><p>
If this property is false the text not found debug dialog will not
open if a search text can not be located. By default this
property is true and the text not found dialog will open, whenever
a search text can not be located in time.
</p><p>
Some algorithms require text search without triggering the text not
found dialog. In script sections that would normally trigger unwanted
text not found dialogs, you can use the textNotFoundDebugging property
to temporarily deactivate the dialog:
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
testSettings.textNotFoundDebugging = False
# ... wait for text that might not exist in time ...
testSettings.textNotFoundDebugging = True
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
testSettings.textNotFoundDebugging = false;
// ... wait for text that might not exist in time ...
testSettings.textNotFoundDebugging = true;
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
testSettings-&gt;textNotFoundDebugging(0);
# ... wait for text that might not exist in time ...
testSettings-&gt;textNotFoundDebugging(1);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
TestSettings.textNotFoundDebugging = false
# ... wait for text that might not exist in time ...
TestSettings.textNotFoundDebugging = true
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
testSettings set textNotFoundDebugging 0
# ... wait for text that might not exist in time ...
testSettings set textNotFoundDebugging 1
</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Text Not Found debugging"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Text Not Found debugging</th></tr><tr><td align="left" valign="top"><p>
The <a class="xref" href="ide.dialogs.html#ide.text.not.found.dialog" title="8.3.5. Text Not Found dialog">Text Not Found dialog (Section 8.3.5)</a> will not be shown
if the <span class="guilabel">Halt Test Execution in case of 'Text not found'
issues</span> is disabled on the <span class="guilabel">Playback</span>
<a class="xref" href="ide.dialogs.html#squish.pane" title="8.3.17.7. Squish pane">Squish pane (Section 8.3.17.7)</a> in the IDE preferences.</p></td></tr></table></div><div class="funcsynopsis"><a id="testSettings.setWrappersForApplication-function"></a><p><code class="funcdef"><b class="fsfunc">testSettings.setWrappersForApplication</b>(</code><var class="pdparam">application</var>, <var class="pdparam">wrapperList</var><code>)</code>;</p></div><p>
This function associates a list of wrappers with the specified
<em class="parameter"><code>application</code></em>. The list <span class="emphasis"><em>must</em></span> include
at least one of the main toolkit wrappers. Optionally, it may include
application-specific wrappers (for those <span class="emphasis"><em>Squish</em></span> editions that support them). The
main toolkit wrappers are:
</p><div class="informaltable"><table border="0"><colgroup><col></col><col></col><col></col></colgroup><tbody><tr valign="top"><td valign="top">
<div class="itemizedlist"><ul type="disc" compact><li><p>Qt</p></li><li><p>XView</p></li><li><p>Tk</p></li><li><p>Web</p></li></ul></div>
</td><td valign="top">
<div class="itemizedlist"><ul type="disc" compact><li><p>Java</p></li><li><p>Mac</p></li><li><p>Windows</p></li></ul></div>
</td><td valign="top">
<div class="itemizedlist"><ul type="disc" compact><li><p>Android</p></li><li><p>iOS</p></li><li><p>Flex</p></li></ul></div>
</td></tr></tbody></table></div><p>
These main toolkit wrapper names correspond directly to the
<span class="guilabel">Toolkit:</span> field in the <span class="guilabel">Test Suite
Configuration</span> view of the <span class="application">Squish IDE</span>.
</p><p>
Note that <span class="emphasis"><em>Squish</em></span> 4's dynamic wrapper support greatly reduces the
need to create and maintain application-specific wrappers.
</p><p>
Here is an example that sets the Qt toolkit wrapper as well as a custom
application wrapper, and then starts the AUT:
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
testSettings.setWrappersForApplication("MyApp", ("Qt", "CanvasWrapper"))
startApplication("MyApp")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
testSettings.setWrappersForApplication("MyApp", ["Qt", "CanvasWrapper"]);
startApplication("MyApp");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
testSettings-&gt;setWrappersForApplication("MyApp", ("Qt", "CanvasWrapper"));
startApplication("MyApp");
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
TestSettings.setWrappersForApplication("MyApp", ["Qt", "CanvasWrapper"])
startApplication("MyApp")
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
testSettings setWrappersForApplication MyApp { Qt CanvasWrapper }
startApplication "MyApp"
</pre></div><p>
(See also <a class="xref" href="rgs-squish.html#testSettings.getWrappersForApplication-function"><code class="function">testSettings.getWrappersForApplication</code></a>.)
</p><a id="testSettings.silentVerifications-property"></a>bool
<span class="property">testSettings.silentVerifications</span><p>
If this property is true <span class="emphasis"><em>Squish</em></span> will not produce Test Result entries
for passing or failing <a class="xref" href="rgs-squish.html#test.vp-function"><code class="function">test.vp</code></a>, <a class="xref" href="rgs-squish.html#test.xvp-function"><code class="function">test.xvp</code></a>
and <a class="xref" href="rgs-squish.html#test.vpWithObject-function"><code class="function">test.vpWithObject</code></a> calls. In combination with
using the (boolean) return value of test.vp() and test.vpWithObject(),
this can come in handy for custom defined verifications on top of a
series of Verification Points.
</p><p>
Here is an example that checks that one of three Screenshot
Verification Points passes.
</p><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
testSettings.silentVerifications = True
for current in ['VP-winxp', 'VP-win2k', 'VP-win7']:
    if test.vp(current):
        test.passes("%s matched" % (current, ))
        break
else:
    test.fail("none of the provided VPs matched")
</pre></div><a id="testSettings.breakOnFailure-property"></a>bool
<span class="property">testSettings.breakOnFailure</span>
<p>
If this property is <code class="code">true</code>, the debugger stops on every failed verification performed by
<a class="xref" href="rgs-squish.html#test.compare-function"><code class="function">test.compare</code></a>, <a class="xref" href="rgs-squish.html#test.xcompare-function"><code class="function">test.xcompare</code></a>,
<a class="xref" href="rgs-squish.html#test.verify-function"><code class="function">test.verify</code></a>, <a class="xref" href="rgs-squish.html#test.xverify-function"><code class="function">test.xverify</code></a>,
<a class="xref" href="rgs-squish.html#test.vp-function"><code class="function">test.vp</code></a>, <a class="xref" href="rgs-squish.html#test.xvp-function"><code class="function">test.xvp</code></a>,
<a class="xref" href="rgs-squish.html#test.vpWithObject-function"><code class="function">test.vpWithObject</code></a> and <a class="xref" href="rgs-squish.html#test.exception-function"><code class="function">test.exception</code></a>
as well as every invocation of <a class="xref" href="rgs-squish.html#test.fail-function"><code class="function">test.fail</code></a> and
<a class="xref" href="rgs-squish.html#test.fatal-function"><code class="function">test.fatal</code></a>.
By default, this property is <code class="code">false</code>.
</p><a id="testSettings.throwOnFailure-property"></a>bool
<span class="property">testSettings.throwOnFailure</span>
<p>
If this property is true every failing verification performed by
<a class="xref" href="rgs-squish.html#test.compare-function"><code class="function">test.compare</code></a>, <a class="xref" href="rgs-squish.html#test.xcompare-function"><code class="function">test.xcompare</code></a>,
<a class="xref" href="rgs-squish.html#test.verify-function"><code class="function">test.verify</code></a>, <a class="xref" href="rgs-squish.html#test.xverify-function"><code class="function">test.xverify</code></a>,
<a class="xref" href="rgs-squish.html#test.vp-function"><code class="function">test.vp</code></a>, <a class="xref" href="rgs-squish.html#test.xvp-function"><code class="function">test.xvp</code></a>,
<a class="xref" href="rgs-squish.html#test.vpWithObject-function"><code class="function">test.vpWithObject</code></a> and <a class="xref" href="rgs-squish.html#test.exception-function"><code class="function">test.exception</code></a>
as well as every invocation of <a class="xref" href="rgs-squish.html#test.fail-function"><code class="function">test.fail</code></a> and
<a class="xref" href="rgs-squish.html#test.fatal-function"><code class="function">test.fatal</code></a> will raise a script error.
By default, this property is false and the aforementioned functions do not raise script errors.
</p><a id="testSettings.retryDuration-property"></a>Integer
<span class="property">testSettings.retryDuration</span><p>
This property affects the <a class="xref" href="rgs-squish.html#test.vp-function"><code class="function">test.vp</code></a>,
<a class="xref" href="rgs-squish.html#test.xvp-function"><code class="function">test.xvp</code></a> and the <a class="xref" href="rgs-squish.html#test.vpWithObject-function"><code class="function">test.vpWithObject</code></a> functions.
It can be used to specify for how long a verification should be retried after it fails.
The default value is 0, which means the verification is only tried once.
If you set it to 5000 the verification will be retried for at least 5000ms
if it keeps on failing (i.e. it will be retried until it passes or
5 seconds have passed). This can be useful if the AUT needs to reach a certain
stage before a property or screenshot verification can pass. This can help
to reduce timing issues.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Result logging"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Result logging</th></tr><tr><td align="left" valign="top"><p>
Please note that intermediate failures are not logged. Only the last result
in the series is logged. This can either be a fail when the retry duration is reached
and the verification is still failing or a pass.
</p></td></tr></table></div><p>
The following example shows how you can set this property for each verification
individually, but you could also set it once for every verification that follows.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
testSettings.retryDuration = 5000
test.vp("VP1")
testSettings.retryDuration = 0
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
testSettings.retryDuration = 5000;
test.vp("VP1")
testSettings.retryDuration = 0;
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
testSettings-&gt;retryDuration(5000);
test::vp("VP1")
testSettings-&gt;retryDuration(0);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
TestSettings.retryDuration = 5000
Test.vp("VP1")
TestSettings.retryDuration = 0
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
testSettings set retryDuration 5000
test vp "VP1"
testSettings set retryDuration 0
</pre></div><a id="testSettings.imageSearchTolerant-property"></a>bool
<span class="property">testSettings.imageSearchTolerant</span><p>
This property affects the <a class="xref" href="rgs-squish.html#findImage-function"><code class="function">findImage</code></a>,
<a class="xref" href="rgs-squish.html#waitForImage-function"><code class="function">waitForImage</code></a> and
<a class="xref" href="rgs-squish.html#test.imagePresent-function"><code class="function">test.imagePresent</code></a> functions. In case the
option map passed to the above functions does not contain the
<em class="parameter"><code>tolerant</code></em> key, the value of this property is
used in its place. The default value is <code class="constant">false</code>.
</p><a id="testSettings.imageSearchThreshold-property"></a>Number
<span class="property">testSettings.imageSearchThreshold</span><p>
This property affects the <a class="xref" href="rgs-squish.html#findImage-function"><code class="function">findImage</code></a>,
<a class="xref" href="rgs-squish.html#waitForImage-function"><code class="function">waitForImage</code></a> and
<a class="xref" href="rgs-squish.html#test.imagePresent-function"><code class="function">test.imagePresent</code></a> functions. In case the
option map passed to the above functions does not contain the
<em class="parameter"><code>threshold</code></em> key, the value of this property is
used in its place. The default value is <code class="constant">99.5</code>.
</p><a id="testSettings.imageSearchMultiscale-property"></a>bool
<span class="property">testSettings.imageSearchMultiscale</span><p>
This property affects the <a class="xref" href="rgs-squish.html#findImage-function"><code class="function">findImage</code></a>,
<a class="xref" href="rgs-squish.html#waitForImage-function"><code class="function">waitForImage</code></a> and
<a class="xref" href="rgs-squish.html#test.imagePresent-function"><code class="function">test.imagePresent</code></a> functions. In case the
option map passed to the above functions does not contain the
<em class="parameter"><code>multiscale</code></em> key, the value of this property is
used in its place. The default value is <code class="constant">false</code>.
</p><a id="testSettings.imageSearchMinScale-property"></a>Number
<span class="property">testSettings.imageSearchMinScale</span><p>
This property affects the <a class="xref" href="rgs-squish.html#findImage-function"><code class="function">findImage</code></a>,
<a class="xref" href="rgs-squish.html#waitForImage-function"><code class="function">waitForImage</code></a> and
<a class="xref" href="rgs-squish.html#test.imagePresent-function"><code class="function">test.imagePresent</code></a> functions. In case the
option map passed to the above functions does not contain the
<em class="parameter"><code>minScale</code></em> key, the value of this property is
used in its place. The default value is <code class="constant">50.0</code>.
</p><a id="testSettings.imageSearchMaxScale-property"></a>Number
<span class="property">testSettings.imageSearchMaxScale</span><p>
This property affects the <a class="xref" href="rgs-squish.html#findImage-function"><code class="function">findImage</code></a>,
<a class="xref" href="rgs-squish.html#waitForImage-function"><code class="function">waitForImage</code></a> and
<a class="xref" href="rgs-squish.html#test.imagePresent-function"><code class="function">test.imagePresent</code></a> functions. In case the
option map passed to the above functions does not contain the
<em class="parameter"><code>maxScale</code></em> key, the value of this property is
used in its place. The default value is <code class="constant">200.0</code>.
</p><a id="testSettings.defaultOcrLanguage-property"></a>bool
<span class="property">testSettings.defaultOcrLanguage</span><p>
This property affects the OCR functions like
<a class="xref" href="rgs-squish.html#getOcrText-function"><code class="function">getOcrText</code></a>,
<a class="xref" href="rgs-squish.html#findOcrText-function"><code class="function">findOcrText</code></a>,
<a class="xref" href="rgs-squish.html#waitForOcrText-function"><code class="function">waitForOcrText</code></a> and
<a class="xref" href="rgs-squish.html#test.ocrTextPresent-function"><code class="function">test.ocrTextPresent</code></a>. In case the option
map passed to the above functions does not contain the
<em class="parameter"><code>language</code></em> key, the value of this property is
used in its place. The default value is empty which means the engine's
default language.
</p><a id="testSettings.waitForObjectTimeout-property"></a> Integer
<span class="property">testSettings.waitForObjectTimeout</span><p>
This property defines the default timeout in milliseconds <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a>,
<a class="xref" href="rgs-squish.html#waitForObjectItem-function"><code class="function">waitForObjectItem</code></a> and <a class="xref" href="rgs-squish.html#waitForObjectExists-function"><code class="function">waitForObjectExists</code></a>
will wait for an object lookup to succeed. This timeout also applies to
<a class="xref" href="rgs-squish.html#test.vp-function"><code class="function">test.vp</code></a>, <a class="xref" href="rgs-squish.html#test.xvp-function"><code class="function">test.xvp</code></a>,
<a class="xref" href="rgs-squish.html#test.vpWithObject-function"><code class="function">test.vpWithObject</code></a> and <a class="xref" href="rgs-squish.html#highlightObject-function"><code class="function">highlightObject</code></a>.
</p><p>
The timeout value of 0 means <span class="emphasis"><em>Squish</em></span> will try to find the object exactly once.
Negative timeout values are not supported.
</p><div class="funcsynopsis"><a id="testSettings.getPassword-function"></a><p><code class="funcdef">String <b class="fsfunc">testSettings.getPassword</b>(</code><var class="pdparam">key</var><code>)</code>;</p></div><p>
This method retrieves the password associated with the specified
<em class="parameter"><code>key</code></em>. The passwords are stored with the test suite and can
be edited using the <a class="xref" href="ide.views.html#ide.the-settings.view.passwords" title="8.2.16.6. Password Information">Password Information (Section 8.2.16.6)</a>.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>
The passwords stored in a Squish test suite have to be retrievable in plaintext
form. Therefore, they are not stored in a "secure" way - they are just
stored separately, so that it is not necessary to hard-code passwords in
your test scripts.
</p></td></tr></table></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="rgs-testsettings-config"></a>6.3.19.1. Set initial <code class="code">testSettings</code> Object values in the <code class="code">config.xml</code></h4></div></div></div><p>
The initial values of the <code class="code">testSettings</code> Object properties can be set by editing the
<code class="code">config.xml</code> in the test suite folder. This way you can
easily set the same values for multiple test cases. The test settings
in the <code class="code">config.xml</code> can be edited using the
<a class="xref" href="ide.views.html#ide.the-settings.view.testsettings" title="8.2.16.4. Test Settings">Test Settings (Section 8.2.16.4)</a> and
<a class="xref" href="ide.views.html#ide.the-settings.view.imagesearch" title="8.2.16.5. Image Search">Image Search (Section 8.2.16.5)</a> pages of the test
suite settings editor in the Squish IDE.
</p><p>
The following example shows how to extend the <code class="code">config.xml</code>
manually. Every property can be set in the same way.
</p><pre class="programlisting">
&lt;testconfig version="1.0"&gt;
...
&lt;testsettings&gt;
    &lt;objectNotFoundDebugging&gt;false&lt;/objectNotFoundDebugging&gt;
    &lt;testCaseName&gt;some name&lt;/testCaseName&gt;
&lt;/testsettings&gt;
...
&lt;/testconfig&gt;
</pre><p>The test suite's <code class="code">config.xml</code> file is not always
created automatically. You can either create it manually with a text
editor, or in the Squish IDE by opening the
<a class="xref" href="ide.views.html#ide.the-settings.view" title="8.2.16. Test Suite Settings view">Test Suite Settings view (Section 8.2.16)</a> editor and editing either the
test suite summary and description or the default test settings.
</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgs-remotesystem"></a>6.3.20. <code class="code">RemoteSystem</code> Object</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Usability notes"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Usability notes</th></tr><tr><td align="left" valign="top"><p>
The <code class="code">RemoteSystem</code> object can be used to interact with the
system that <span class="application">squishserver</span> runs on.
In some cases,
the system that the AUT runs on is not the
same system the <span class="application">squishserver</span> runs on.
This means that <code class="code">RemoteSystem</code> can <span class="emphasis"><em>not</em></span>
be used to access the AUT's operating system when testing Android, iOS,
or remote attachable AUTs in general.
</p></td></tr></table></div><p>
<span class="emphasis"><em>Squish</em></span> provides a <code class="code">RemoteSystem</code> object whose
methods can be used for file system operations and process execution on the
system the <span class="application">squishserver</span> is running on.
In order to use the object, the <code class="code">RemoteSystem</code> library has to be
included and an object instance must be created.</p><div class="funcsynopsis"><a id="RemoteSystem.constructor-function"></a><p><code class="funcdef">RemoteSystem <b class="fsfunc">RemoteSystem</b>(</code><code>)</code>;</p></div><p>
When the object instance is created by the default constructor, a connection to
the default <span class="application">squishserver</span> is automatically established. If an error occurs
and the connection cannot be established, an exception is raised and no object
instance is created.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remotesys = new RemoteSystem();
    } catch (e) {
        test.fail("Connect to squishserver", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

eval {
    my $con = Squish::RemoteSystem-&gt;new();
    1;
} or do {
    my $e = $@;
    test::fail("Connect to squishserver", $e);
};
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remotesys = RemoteSystem()
    except Exception as e:
        test.fail("Connect to squishserver", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remotecon = RemoteSystem.new()
  rescue Exception =&gt; e
    Test.fail("Connect to squishserver", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remotesys [::Squish::RemoteSystem new]} result]} {
        test fail "Connect to squishserver" $result
    }
}
</pre></div><div class="funcsynopsis"><p><code class="funcdef">RemoteSystem <b class="fsfunc">RemoteSystem</b>(</code><var class="pdparam">host</var>, <var class="pdparam">port</var><code>)</code>;</p></div><p>
The constructor of the <code class="code">RemoteSystem</code> object takes two optional arguments
that can be used to establish a connection to an arbitrary <span class="application">squishserver</span>. The first
parameter is the hostname or IP address, the second parameter is the port number.
The following example creates a <code class="code">RemoteSystem</code> object that is connected
to a manually started <span class="application">squishserver</span> on the local system.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remotesys = new RemoteSystem("localhost", 4322);
    } catch (e) {
        test.fail("Connect to squishserver", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

eval {
    my $con = Squish::RemoteSystem-&gt;new("localhost", 4322);
    1;
} or do {
    my $e = $@;
    test::fail("Connect to squishserver", $e);
};
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remotesys = RemoteSystem("localhost", 4322)
    except Exception as e:
        test.fail("Connect to squishserver", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remotecon = RemoteSystem.new("localhost", 4322)
  rescue Exception =&gt; e
    Test.fail("Connect to squishserver", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remotesys [::Squish::RemoteSystem new localhost 4322]} result]} {
        test fail "Connect to squishserver" $result
    }
}
</pre></div><p>
The following exceptions can occur when the constructor of the object is called.
</p><div class="informaltable"><table border="1"><colgroup><col></col><col></col></colgroup><thead><tr><th>Exception</th><th>Description</th></tr></thead><tbody><tr><td>Runtime Error</td><td>When a connection cannot be established.</td></tr><tr><td>Type/Value/Argument Error (JavaScript/Python/Ruby)</td><td>When a parameter is missing.</td></tr></tbody></table></div><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Perl/Tcl-specific"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Perl/Tcl-specific</th></tr><tr><td align="left" valign="top"><p>
The exceptions for this languages don`t have a specific exception type.
Only a message, describing the error, is given.
</p></td></tr></table></div><p>
Once the <code class="code">RemoteSystem</code> object is created the following methods
are available.

</p><div class="informaltable"><table border="0"><colgroup><col></col></colgroup><tbody><tr valign="top"><td valign="top">
<div class="itemizedlist"><ul type="disc" compact><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.execute-function"><code class="function">RemoteSystem.execute</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.getEnvironmentVariable-function"><code class="function">RemoteSystem.getEnvironmentVariable</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.listFiles-function"><code class="function">RemoteSystem.listFiles</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.stat-function"><code class="function">RemoteSystem.stat</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.exists-function"><code class="function">RemoteSystem.exists</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.deleteFile-function"><code class="function">RemoteSystem.deleteFile</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.deleteDirectory-function"><code class="function">RemoteSystem.deleteDirectory</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.createDirectory-function"><code class="function">RemoteSystem.createDirectory</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.createPath-function"><code class="function">RemoteSystem.createPath</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.rename-function"><code class="function">RemoteSystem.rename</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.createTextFile-function"><code class="function">RemoteSystem.createTextFile</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.upload-function"><code class="function">RemoteSystem.upload</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.download-function"><code class="function">RemoteSystem.download</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.copy-function"><code class="function">RemoteSystem.copy</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.close-function"><code class="function">RemoteSystem.close</code></a></p></li><li><p><a class="xref" href="rgs-squish.html#RemoteSystem.getOSName-function"><code class="function">RemoteSystem.getOSName</code></a></p></li></ul></div>
</td></tr></tbody></table></div><p>

</p><p>
</p><div class="funcsynopsis"><a id="RemoteSystem.execute-function"></a><p><code class="funcdef">list <b class="fsfunc">RemoteSystem.execute</b>(</code><var class="pdparam">cmd</var><code>)</code>;</p></div><p>
</p><div class="funcsynopsis"><p><code class="funcdef">list <b class="fsfunc">RemoteSystem.execute</b>(</code><var class="pdparam">cmd</var>, <var class="pdparam">cwd</var><code>)</code>;</p></div><p>
</p><div class="funcsynopsis"><p><code class="funcdef">list <b class="fsfunc">RemoteSystem.execute</b>(</code><var class="pdparam">cmd</var>, <var class="pdparam">cwd</var>, <var class="pdparam">env</var><code>)</code>;</p></div><p>
</p><div class="funcsynopsis"><p><code class="funcdef">list <b class="fsfunc">RemoteSystem.execute</b>(</code><var class="pdparam">cmd</var>, <var class="pdparam">cwd</var>, <var class="pdparam">env</var>, <var class="pdparam">options</var><code>)</code>;</p></div><p>
</p><p>
The execute method can be used to run an application or shell command.
As the first parameter a list/array of the command and all parameters must be given.
The three following parameters are optional.
</p><p>
The <em class="parameter"><code>cwd</code></em> parameter specifies the working directory for executing the provided command.
</p><p>
The <em class="parameter"><code>env</code></em> parameter allows to set or remove environment variables. To remove an environment variable use an empty string as value.
</p><p>
The <em class="parameter"><code>options</code></em> parameter offers additional, sometimes less often used options. Please find the supported options for this below.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: RemoteSystem.execute is a synchronous operation"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">RemoteSystem.execute is a synchronous operation</th></tr><tr><td align="left" valign="top"><p>RemoteSystem.execute returns only when the executed command is finished or the process is started
as a background task. When the process is started as a background task there no longer is an association
to the RemoteSystem object.</p></td></tr></table></div><p>
The following table lists all possible options.
</p><p>
</p><div class="informaltable"><table border="1"><colgroup><col></col><col></col><col></col><col></col></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>cmd</td><td>List/Array</td><td>Mandatory</td><td>Array with command to execute and parameters.</td></tr><tr><td>cwd</td><td>String</td><td>Empty</td><td>Working directory for the started process.</td></tr><tr><td>env</td><td>Dictionary</td><td>Empty</td><td>Key/Value pairs of environment variables.</td></tr><tr><td>options</td><td>Dictionary</td><td>Empty</td><td>Dictionary of all options.</td></tr><tr><td>options.keepLineEnding</td><td>Boolean</td><td>True</td><td>If provided and set to false, line endings in stdout/stderr output of the started process will be converted to '\n' (Unix) newlines.</td></tr><tr><td>options.clearenv</td><td>Boolean</td><td>False</td><td>If provided and set to true, the process will be started with a minimal environment.
However, on most OS it is not possible to remove all environment variables because then some functionality or tools provided by the operating system would not work any more.</td></tr><tr><td>options.timeout</td><td>Integer</td><td>30</td><td>Value is a timeout in seconds. It is used to limit the execution time of the started process.</td></tr><tr><td>options.encoding</td><td>String</td><td>UTF-8</td><td>Name of the encoding of the stdout/stderr output of the started process. See below for a <a class="link" href="rgs-squish.html#encodings-table"> list</a> of supported encodings.</td></tr></tbody></table></div><p>
</p><p>
The following table lists the return values.
The returned value is a simple list/array with three elements. The order is always the same.
</p><p>
</p><div class="informaltable"><table border="1"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>exitcode</td><td>String/Unicode</td><td>Exit code of the process.</td></tr><tr><td>stdout</td><td>String/Unicode</td><td>Stdout output of the process.</td></tr><tr><td>stderr</td><td>String/Unicode</td><td>Stderr output of the process.</td></tr></tbody></table></div><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: JavaScript"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">JavaScript</th></tr><tr><td align="left" valign="top"><p>
The return value in JavaScript is an object with properties.</p></td></tr></table></div><p>
Example for each language.
The example adds one environment variable, deletes one and then gets the environment variable list from windows.
The maximum run time for the command is 10 seconds, for the encoding the Windows IBM850 codepage is used. Also
the line endings are transformed to "\n" line endings.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remotesys = new RemoteSystem();
        cmd = ["cmd", "/c", "set"];
        cwd = "";
        env = {};
        env["MYTESTENV"] = "test string";
        env["COMPUTERNAME"] = "";
        options = {};
        options.keepLineEnding = false;
        options.clearenv = false;
        options.timeout = 10;
        options.encoding = "IBM850"
        execresult = remotesys.execute(cmd, cwd, env, options);
    } catch (e) {
        test.fail("RemoteSystem error", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;
    my $cmd = ["cmd", "/c", "set"];
    my $cwd = "";
    my $env = {
      "MYTESTENV" =&gt; "test string",
      "COMPUTERNAME" =&gt; ""
    };
    my $options = {
      "keepLineEnding" =&gt; 0,
      "clearenv" =&gt; 0,
      "timeout" =&gt; 10,
      "encoding" =&gt; "IBM850"
    };
    eval {
        my $remotecon = Squish::RemoteSystem-&gt;new();
        my ($exitcode,$stdout,$stderr) = $remotecon-&gt;execute($cmd, $cwd, $env, $options);
        1;
    } or do {
        test::fail("RemoteSystem error", $@);
    };
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remotesys = RemoteSystem()
        cmd = [ "cmd", "/c", "set" ]
        cwd = ""
        env = {
            "MYTESTENV": "test string",
            "COMPUTERNAME": ""
        }
        options = {
            "keepLineEnding": False,
            "clearenv": False,
            "timeout": 10,
            "encoding": "IBM850"
        }
        (exitcode, stdout, stderr) = remotesys.execute(cmd, cwd, env, options)
        test.verify(exitcode == "0", "Command not executed")
    except Exception as e:
        test.fail("RemoteSystem error", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remotesys = RemoteSystem.new()
    cmd = ["cmd", "/c", "set"]
    cwd = ""
    env = {
      "MYTESTENV" =&gt; "test string",
      "COMPUTERNAME" =&gt; ""
    }
    options = {
      "keepLineEnding" =&gt; false,
      "clearenv" =&gt; false,
      "timeout" =&gt; 10,
      "encoding" =&gt; "IBM850"
    }
    exitcode, stdout, stderr = remotesys.execute(cmd, cwd, env, options)
  rescue Exception =&gt; e
    Test.fail("RemoteSystem error", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    set cmd [list cmd /c set]
    set cwd ""
    set env [dict create]
    set options [dict create keepNewLine 0 clearenv 0 timeout 10 encoding IBM850]

    if {[catch {set remotesys [::Squish::RemoteSystem new]} result]} {
        test fail "RemoteSystem error" $result
    }
    if { [catch {foreach {exitcode stdout stderr} [$remotesys execute $cmd $cwd $env $options] {break}} result] } {
        test fail "RemoteSystem error" $result
    }
}
</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Encoding and Windows codepages"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Encoding and Windows codepages</th></tr><tr><td align="left" valign="top"><p>When the command is executed on windows and runs in a console window, the encoding must match the
codepage of the console that is used. See
<a class="ulink" href="https://msdn.microsoft.com/de-de/library/windows/desktop/dd317756(v=vs.85).aspx" target="_blank">https://msdn.microsoft.com/de-de/library/windows/desktop/dd317756(v=vs.85).aspx</a>
for windows codepage numbers and there names. The name of the codepage is the name for the encoding option.
</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Encoding under Linux"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Encoding under Linux</th></tr><tr><td align="left" valign="top"><p>Linux encoding is mostly UTF-8. </p></td></tr></table></div><p>
The following list is a sub set of possible encodings.
</p><div class="informaltable"><a id="encodings-table"></a><table border="1"><colgroup><col></col><col></col><col></col></colgroup><tbody><tr><td>UTF-8</td><td>UTF-16</td><td>ISO 8859-1 to 10</td></tr><tr><td>ISO 8859-13 to 16</td><td>ISO 2022-JP</td><td>Shift-JIS</td></tr><tr><td>IBM 874</td><td>IBM 866</td><td>IBM 850</td></tr><tr><td>Windows-1250 to 1258</td><td>Big5</td><td>KOI8-R</td></tr></tbody></table></div><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: More encodings"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">More encodings</th></tr><tr><td align="left" valign="top"><p>Complete list of supported encodings.
<a class="ulink" href="https://doc.qt.io/qt-4.8/qtextcodec.html#details" target="_blank">https://doc.qt.io/qt-4.8/qtextcodec.html#details</a></p></td></tr></table></div><p>The following exception can occur when a command is executed.</p><p>
</p><div class="informaltable"><table border="1"><colgroup><col></col><col></col></colgroup><thead><tr><th>Exception</th><th>Description</th></tr></thead><tbody><tr><td>Runtime Error</td><td>Encoding not supported. The exception is raised when the wanted encoding is not supported.</td></tr><tr><td>Runtime Error</td><td>Working directory not found. The exception is raised when the working directory is not found.</td></tr><tr><td>Runtime Error</td><td>Program not started after timeout. The exception is raised when the program to execute does not start within 10 seconds.</td></tr></tbody></table></div><p>
</p><div class="funcsynopsis"><a id="RemoteSystem.getEnvironmentVariable-function"></a><p><code class="funcdef">String <b class="fsfunc">RemoteSystem.getEnvironmentVariable</b>(</code><var class="pdparam">variableName</var><code>)</code>;</p></div><p>
The <code class="code">getEnvironmentVariable</code> method can be used to retrieve the content of environment variables from the remote system.
The <em class="parameter"><code>variableName</code></em> parameter is used to specify the name of the environment variable on the remote system.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: RemoteSystem.getEnvironmentVariable error handling"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">RemoteSystem.getEnvironmentVariable error handling</th></tr><tr><td align="left" valign="top"><p>If the retrieved environment variable is not set on the remote system the function will return an empty string.
There is no way to differentiate if the variable is set to an empty string or not set at all.
</p></td></tr></table></div><p>
The following example retrieves the environment variable HOMEDRIVE and logs the result.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remoteOS = new RemoteSystem();
        test.log(remoteOS.getEnvironmentVariable("HOMEDRIVE"));
    } catch (e) {
        test.fail("RemoteSystem error", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

sub main {
    eval {
        my $remoteOS = Squish::RemoteSystem-&gt;new();
        test::log($remoteOS-&gt;getEnvironmentVariable("HOMEDRIVE"));
    } or do {
        test::fail("RemoteSystem error", $@);
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remoteOS = RemoteSystem()
        test.log(remoteOS.getEnvironmentVariable("HOMEDRIVE"))
    except Exception as e:
        test.fail("RemoteSystem error", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remoteOS = RemoteSystem.new()
    Test.log(remoteOS.getEnvironmentVariable("HOMEDRIVE"))
  rescue Exception =&gt; e
    Test.fail("RemoteSystem error", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remoteOS [::Squish::RemoteSystem new]} result]} {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test log [$remoteOS getEnvironmentVariable "HOMEDRIVE"] } result] } {
        test fail "RemoteSystem error" $result
    }
}
</pre></div><div class="funcsynopsis"><a id="RemoteSystem.getOSName-function"></a><p><code class="funcdef">String <b class="fsfunc">RemoteSystem.getOSName</b>(</code><code>)</code>;</p></div><p>
The <code class="code">getOSName</code> method can be used to retrieve the name of the operating system of the remote system.
When the OS can not be determined the function returns "Unknown".
</p><p>
Possible names include:
</p><div class="itemizedlist"><ul type="disc" compact><li><p><code class="code">"Android"</code> — Android</p></li><li><p><code class="code">"Darwin"</code> — macOS and iOS</p></li><li><p><code class="code">"Linux"</code> — Linux</p></li><li><p><code class="code">"QNX"</code> — QNX</p></li><li><p><code class="code">"SunOS"</code> — Solaris</p></li><li><p><code class="code">"Windows"</code> — Windows</p></li></ul></div><p>
The following example retrieves the name of the operating system and logs the result.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remoteOS = new RemoteSystem();
        test.log(remoteOS.getOSName());
    } catch (e) {
        test.fail("RemoteSystem error", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

sub main {
    eval {
        my $remoteOS = Squish::RemoteSystem-&gt;new();
        test::log($remoteOS-&gt;getOSName());
    } or do {
        test::fail("RemoteSystem error", $@);
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remoteOS = RemoteSystem()
        test.log(remoteOS.getOSName())
    except Exception as e:
        test.fail("RemoteSystem error", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remoteOS = RemoteSystem.new()
    Test.log(remoteOS.getOSName())
  rescue Exception =&gt; e
    Test.fail("RemoteSystem error", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remoteOS [::Squish::RemoteSystem new]} result]} {
        test fail "RemoteSystem error" $result
    } else {
        test log [$remoteOS getOSName]
    }
}
</pre></div><div class="funcsynopsis"><a id="RemoteSystem.listFiles-function"></a><p><code class="funcdef">StringList <b class="fsfunc">RemoteSystem.listFiles</b>(</code><var class="pdparam">path</var><code>)</code>;</p></div><p>
The <code class="code">listFiles</code> method can be used to retrieve a directory listing of a certain path from the remote system.
The <em class="parameter"><code>path</code></em> parameter is used to specify the path on the remote system that is retrieved. This method returns
a list of file and folder names (it does not return the full paths). It does not work recursively and therefore doesn't show the
content of subfolders. If the path does not exist or is not a directory an exception is raised.
</p><p>
The following example retrieves all directory and file names of the "/"-Directory (which under Windows should be the homedrive).
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remoteOS = new RemoteSystem();

        dirList = remoteOS.listFiles("/");

        for (var i = 0; i &lt; dirList.length; i++) {
            test.log(dirList[i]);
        }
    } catch (e) {
        test.fail("RemoteSystem error", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

sub main {
    eval {
        my $remoteOS = Squish::RemoteSystem-&gt;new();
        my @dirList = $remoteOS-&gt;listFiles("/");
        my $dirListLength = @dirList;

        for (my $i = 0; $i &lt; $dirListLength; $i++) {
            test::log($dirList[$i]);
        }
        1;
    } or do {
        test::fail("RemoteSystem error", $@);
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remoteOS = RemoteSystem()
        dirList = remoteOS.listFiles("/")

        for remoteFile in dirList:
            test.log(remoteFile)
    except Exception as e:
        test.fail("RemoteSystem error", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remoteOS = RemoteSystem.new()
    dirList = remoteOS.listFiles("/")
    dirList.each do |remoteFile|
      Test.log remoteFile
    end
  rescue Exception =&gt; e
    Test.fail("RemoteSystem error", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remoteOS [::Squish::RemoteSystem new]} result]} {
        test fail "RemoteSystem error" $result
    }

    if { [catch { set dirList [$remoteOS listFiles "/"]] } result] } {
        test fail "RemoteSystem error" $result
    }

    if { [catch {
        foreach remoteFile $dirList {
            test log $remoteFile
        } } result ] } {
        test fail "RemoteSystem error" $result
    }
}
</pre></div><div class="funcsynopsis"><a id="RemoteSystem.stat-function"></a><p><code class="funcdef">Variant <b class="fsfunc">RemoteSystem.stat</b>(</code><var class="pdparam">path</var>, <var class="pdparam">propertyName</var><code>)</code>;</p></div><p>
The <code class="code">stat</code> method can be used to retrieve different properties of a certain path from the remote system.
The <em class="parameter"><code>path</code></em> parameter is used to specify the path on the remote system and the <em class="parameter"><code>propertyName</code></em>
is used to specify which property should be retrieved. The property name must be chosen from a predefined list
of property names (property names are case-sensitive). Depending on the property this method returns different result types.
If the path does not exist or the property is unknown an exception is raised.
</p><p>
The following list shows the supported properties and the returned types.
</p><div class="informaltable"><a id="RemoteSystem.stat-properties-table"></a><table border="1"><colgroup><col></col><col></col></colgroup><thead><tr><th>Property Name</th><th>Return Type</th></tr></thead><tbody><tr><td>exists</td><td>Boolean</td></tr><tr><td>isDir</td><td>Boolean</td></tr><tr><td>isFile</td><td>Boolean</td></tr><tr><td>isSymLink</td><td>Boolean</td></tr><tr><td>isReadable</td><td>Boolean</td></tr><tr><td>isWritable</td><td>Boolean</td></tr><tr><td>isExecutable</td><td>Boolean</td></tr><tr><td>isHidden</td><td>Boolean</td></tr><tr><td>lastModified</td><td>Timestamp</td></tr><tr><td>lastRead</td><td>Timestamp</td></tr><tr><td>size</td><td>Integer</td></tr></tbody></table></div><p>
</p><p>
The following example prints if the given path is a directory or file. And prints the timestamp when the directory was last read.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remoteOS = new RemoteSystem();
        test.log(remoteOS.stat("/", "isDir"));
        test.log(remoteOS.stat("/", "isFile"));
        test.log(remoteOS.stat("/", "lastRead"));
    } catch (e) {
        test.fail("RemoteSystem error", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

sub main {
    eval {
        my $remoteOS = Squish::RemoteSystem-&gt;new();
        test::log($remoteOS-&gt;stat("/", "isDir"));
        test::log($remoteOS-&gt;stat("/", "isFile"));
        test::log($remoteOS-&gt;stat("/", "lastRead"));
    } or do {
        test::fail("RemoteSystem error", $@);
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remoteOS = RemoteSystem()
        test.log(str(remoteOS.stat("/", "isDir")))
        test.log(str(remoteOS.stat("/", "isFile")))
        test.log(remoteOS.stat("/", "lastRead"))
    except Exception as e:
        test.fail("RemoteSystem error", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remoteOS = RemoteSystem.new()
    Test.log(remoteOS.stat("/", "isDir")? "true" : "false")
    Test.log(remoteOS.stat("/", "isFile")? "true" : "false" )
    Test.log(remoteOS.stat("/", "lastRead"))
  rescue Exception =&gt; e
    Test.fail("RemoteSystem error", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remoteOS [::Squish::RemoteSystem new]} result]} {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test log [$remoteOS stat "/" "isDir" ] } result] } {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test log [$remoteOS stat "/" "isFile" ] } result] } {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test log [$remoteOS stat "/" "lastRead" ] } result] } {
        test fail "RemoteSystem error" $result
    }
}
</pre></div><div class="funcsynopsis"><a id="RemoteSystem.exists-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">RemoteSystem.exists</b>(</code><var class="pdparam">path</var><code>)</code>;</p></div><p>
The <code class="code">exists</code> method can be used to check if a certain path on the remote system exists.
The <em class="parameter"><code>path</code></em> parameter is used to specify the path on the remote system that will be checked.
</p><p>
The following example prints if the two given paths exists.
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remoteOS = new RemoteSystem();
        test.log(remoteOS.exists("/"));
        test.log(remoteOS.exists("/some/nonexisting/path"));
    } catch (e) {
        test.fail("RemoteSystem error", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

sub main {
    eval {
        my $remoteOS = Squish::RemoteSystem-&gt;new();
        test::log($remoteOS-&gt;exists("/"));
        test::log($remoteOS-&gt;exists("/some/nonexisting/path"));
    } or do {
        test::fail("RemoteSystem error", $@);
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remoteOS = RemoteSystem()
        test.log(str(remoteOS.exists("/")))
        test.log(str(remoteOS.exists("/some/nonexisting/path")))
    except Exception as e:
        test.fail("RemoteSystem error", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remoteOS = RemoteSystem.new()
    Test.log(remoteOS.exists("/")? "true" : "false")
    Test.log(remoteOS.exists("/some/nonexisting/path")? "true" : "false")
  rescue Exception =&gt; e
    Test.fail("RemoteSystem error", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remoteOS [::Squish::RemoteSystem new]} result]} {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test log [$remoteOS exists "/"] } result] } {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test log [expr ![$remoteOS exists "/some/nonexisting/path"]] } result] } {
        test fail "RemoteSystem error" $result
    }
}
</pre></div><div class="funcsynopsis"><a id="RemoteSystem.deleteFile-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">RemoteSystem.deleteFile</b>(</code><var class="pdparam">path</var><code>)</code>;</p></div><p>
The <code class="code">deleteFile</code> method can be used to delete a file on the remote system.
The <em class="parameter"><code>path</code></em> parameter is used to specify the path of the file on the remote system.
If the provided file cannot be deleted or the path doesn't lead to a file an exception is raised.
</p><p>
The following example shows how to use the deleteFile method. You will have to replace the path if you want to try the example.
</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"></img></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>Depending on your setup this test might alter files or folders on your local or remote system.</p></td></tr></table></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remoteOS = new RemoteSystem();
        test.verify(remoteOS.deleteFile("/some/nonexisting/filepath"));
        test.verify(!remoteOS.exists("/some/nonexisting/filepath"));
    } catch (e) {
        test.fail("RemoteSystem error", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

sub main {
    eval {
        my $remoteOS = Squish::RemoteSystem-&gt;new();
        test::verify($remoteOS-&gt;deleteFile("/some/nonexisting/filepath"));
        test::verify(!$remoteOS-&gt;exists("/some/nonexisting/filepath"));
    } or do {
        test::fail("RemoteSystem error", $@);
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remoteOS = RemoteSystem()
        test.verify(remoteOS.deleteFile("/some/nonexisting/filepath"))
        test.verify(!remoteOS.exists("/some/nonexisting/filepath"))
    except Exception as e:
        test.fail("RemoteSystem error", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remoteOS = RemoteSystem.new()
    Test.verify(remoteOS.deleteFile("/some/nonexisting/filepath"))
    Test.verify(!remoteOS.exists("/some/nonexisting/filepath"))
  rescue Exception =&gt; e
    Test.fail("RemoteSystem error", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remoteOS [::Squish::RemoteSystem new]} result]} {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [$remoteOS deleteFile "/some/nonexisting/filepath"] } result] } {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [expr ![$remoteOS exists "/some/nonexisting/filepath"]] } result] } {
        test fail "RemoteSystem error" $result
    }
}
</pre></div><div class="funcsynopsis"><a id="RemoteSystem.deleteDirectory-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">RemoteSystem.deleteDirectory</b>(</code><var class="pdparam">path</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Boolean <b class="fsfunc">RemoteSystem.deleteDirectory</b>(</code><var class="pdparam">path</var>, <var class="pdparam">recursive</var><code>)</code>;</p></div><p>
The <code class="code">deleteDirectory</code> method can be used to delete a directory on the remote system.
The <em class="parameter"><code>path</code></em> parameter is used to specify the path of the folder on the remote system.
The optional boolean parameter <em class="parameter"><code>recursive</code></em> can be used to specify whether subdirectories
and files inside the directories should be deleted too. If the <em class="parameter"><code>recursive</code></em> flag is not set and the
specified directory contains files or folders the deletion operation will fail and an exception will be raised.
Additionally if some of the specified files and folders cannot be deleted an exception will be raised.
</p><p>
The following example shows how to use the deleteDirectory method. You will have to replace the path if you want to try the example.
</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"></img></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>Depending on your setup this test might alter files or folders on your local or remote system.</p></td></tr></table></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remoteOS = new RemoteSystem();
        test.verify(remoteOS.deleteDirectory("/some/nonexisting/path"));
        test.verify(!remoteOS.exists("/some/nonexisting/path"));
    } catch (e) {
        test.fail("RemoteSystem error", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

sub main {
    eval {
        my $remoteOS = Squish::RemoteSystem-&gt;new();
        test::verify($remoteOS-&gt;deleteDirectory("/some/nonexisting/path"));
        test::verify(!$remoteOS-&gt;exists("/some/nonexisting/path"));
    } or do {
        test::fail("RemoteSystem error", $@);
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remoteOS = RemoteSystem()
        test.verify(remoteOS.deleteDirectory("/some/nonexisting/path"))
        test.verify(!remoteOS.exists("/some/nonexisting/path"))
    except Exception as e:
        test.fail("RemoteSystem error", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remoteOS = RemoteSystem.new()
    Test.verify(remoteOS.deleteDirectory("/some/nonexisting/path"))
    Test.verify(!remoteOS.exists("/some/nonexisting/path"))
  rescue Exception =&gt; e
    Test.fail("RemoteSystem error", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remoteOS [::Squish::RemoteSystem new]} result]} {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [$remoteOS deleteDirectory "/some/nonexisting/path"] } result] } {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [expr ![$remoteOS exists "/some/nonexisting/path"]] } result] } {
        test fail "RemoteSystem error" $result
    }
}
</pre></div><div class="funcsynopsis"><a id="RemoteSystem.createDirectory-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">RemoteSystem.createDirectory</b>(</code><var class="pdparam">path</var><code>)</code>;</p></div><p>
The <code class="code">createDirectory</code> method can be used to create a directory on the remote system.
The <em class="parameter"><code>path</code></em> parameter is used to specify the path of the folder on the remote system.
This method will only create the new folder if the parent directory already exists. If you want
to create multiple directories in one go you can use createPath <a class="xref" href="rgs-squish.html#RemoteSystem.createPath-function"><code class="function">RemoteSystem.createPath</code></a>.
If the folder cannot be created an exception will be raised.
</p><p>
The following example shows how to use the createDirectory method. You will have to replace the path if you want to try the example.
</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"></img></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>Depending on your setup this test might alter files or folders on your local or remote system.</p></td></tr></table></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remoteOS = new RemoteSystem();
        test.verify(remoteOS.createDirectory("/some/nonexisting/path"));
        test.verify(remoteOS.exists("/some/nonexisting/path"));
    } catch (e) {
        test.fail("RemoteSystem error", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

sub main {
    eval {
        my $remoteOS = Squish::RemoteSystem-&gt;new();
        test::verify($remoteOS-&gt;createDirectory("/some/nonexisting/path"));
        test::verify($remoteOS-&gt;exists("/some/nonexisting/path"));
    } or do {
        test::fail("RemoteSystem error", $@);
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remoteOS = RemoteSystem()
        test.verify(remoteOS.createDirectory("/some/nonexisting/path"))
        test.verify(remoteOS.exists("/some/nonexisting/path"))
    except Exception as e:
        test.fail("RemoteSystem error", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remoteOS = RemoteSystem.new()
    Test.verify(remoteOS.createDirectory("/some/nonexisting/path"))
    Test.verify(remoteOS.exists("/some/nonexisting/path"))
  rescue Exception =&gt; e
    Test.fail("RemoteSystem error", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remoteOS [::Squish::RemoteSystem new]} result]} {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [$remoteOS createDirectory "/some/nonexisting/path"] } result] } {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [$remoteOS exists "/some/nonexisting/path"] } result] } {
        test fail "RemoteSystem error" $result
    }
}
</pre></div><div class="funcsynopsis"><a id="RemoteSystem.createPath-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">RemoteSystem.createPath</b>(</code><var class="pdparam">path</var><code>)</code>;</p></div><p>
The <code class="code">createPath</code> method can be used to create directories on the remote system.
The <em class="parameter"><code>path</code></em> parameter is used to specify the path of the directories on the remote system.
This method will create all folders that are missing on the remote system from the specified path.
If the path cannot be created an exception will be raised.
</p><p>
The following example shows how to use the createPath method. You will have to replace the path if you want to try the example.
</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"></img></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>Depending on your setup this test might alter files or folders on your local or remote system.</p></td></tr></table></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remoteOS = new RemoteSystem();
        test.verify(remoteOS.createPath("/some/nonexisting/path"));
        test.verify(remoteOS.exists("/some/nonexisting/path"));
    } catch (e) {
        test.fail("RemoteSystem error", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

sub main {
    eval {
        my $remoteOS = Squish::RemoteSystem-&gt;new();
        test::verify($remoteOS-&gt;createPath("/some/nonexisting/path"));
        test::verify($remoteOS-&gt;exists("/some/nonexisting/path"));
    } or do {
        test::fail("RemoteSystem error", $@);
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remoteOS = RemoteSystem()
        test.verify(remoteOS.createPath("/some/nonexisting/path"))
        test.verify(remoteOS.exists("/some/nonexisting/path"))
    except Exception as e:
        test.fail("RemoteSystem error", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remoteOS = RemoteSystem.new()
    Test.verify(remoteOS.createPath("/some/nonexisting/path"))
    Test.verify(remoteOS.exists("/some/nonexisting/path"))
  rescue Exception =&gt; e
    Test.fail("RemoteSystem error", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remoteOS [::Squish::RemoteSystem new]} result]} {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [$remoteOS createPath "/some/nonexisting/path"] } result] } {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [$remoteOS exists "/some/nonexisting/path"] } result] } {
        test fail "RemoteSystem error" $result
    }
}
</pre></div><div class="funcsynopsis"><a id="RemoteSystem.rename-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">RemoteSystem.rename</b>(</code><var class="pdparam">oldPath</var>, <var class="pdparam">newPath</var><code>)</code>;</p></div><p>
The <code class="code">rename</code> method can be used to rename and move files and directories on the remote system.
The <em class="parameter"><code>oldPath</code></em> parameter is used to specify the old or current path of the directory or file on the remote system.
The <em class="parameter"><code>newPath</code></em> parameter is used to specify the new or desired path of the directory or file on the remote system.
The operation will fail if the new path is already existing. If the old path doesn't exist or the file
or folder cannot be renamed an exception will be raised.
</p><p>
The following example shows how to use the rename method. You will have to replace the paths if you want to try the example.
</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"></img></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>Depending on your setup this test might alter files or folders on your local or remote system.</p></td></tr></table></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remoteOS = new RemoteSystem();
        test.verify(remoteOS.rename("/some/old/path", "/some/new/path"));
        test.verify(remoteOS.exists("/some/new/path"));
        test.verify(!remoteOS.exists("/some/old/path"));
    } catch (e) {
        test.fail("RemoteSystem error", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

sub main {
    eval {
        my $remoteOS = Squish::RemoteSystem-&gt;new();
        test::verify($remoteOS-&gt;rename("/some/old/path", "/some/new/path"));
        test::verify($remoteOS-&gt;exists("/some/new/path"));
        test::verify(!$remoteOS-&gt;exists("/some/old/path"));
    } or do {
        test::fail("RemoteSystem error", $@);
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remoteOS = RemoteSystem()
        test.verify(remoteOS.rename("/some/old/path", "/some/new/path"))
        test.verify(remoteOS.exists("/some/new/path"))
        test.verify(!remoteOS.exists("/some/old/path"))
    except Exception as e:
        test.fail("RemoteSystem error", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remoteOS = RemoteSystem.new()
    Test.verify(remoteOS.rename("/some/old/path", "/some/new/path"))
    Test.verify(remoteOS.exists("/some/new/path"))
    Test.verify(!remoteOS.exists("/some/old/path"))
  rescue Exception =&gt; e
    Test.fail("RemoteSystem error", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remoteOS [::Squish::RemoteSystem new]} result]} {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [$remoteOS rename "/some/old/path" "/some/new/path"] } result] } {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [$remoteOS exists "/some/new/path"] } result] } {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [expr ![$remoteOS exists "/some/old/path"]] } result] } {
        test fail "RemoteSystem error" $result
    }
}
</pre></div><div class="funcsynopsis"><a id="RemoteSystem.createTextFile-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">RemoteSystem.createTextFile</b>(</code><var class="pdparam">path</var>, <var class="pdparam">content</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">Boolean <b class="fsfunc">RemoteSystem.createTextFile</b>(</code><var class="pdparam">path</var>, <var class="pdparam">content</var>, <var class="pdparam">encoding</var><code>)</code>;</p></div><p>
The <code class="code">createTextFile</code> method can be used to create a text file on the remote system.
The <em class="parameter"><code>path</code></em> parameter is used to specify the path and name of the file that is to be created on the remote system.
The <em class="parameter"><code>content</code></em> parameter is used to specify the content of the file that is created as a string.
The optional parameter <em class="parameter"><code>encoding</code></em> can be used to specify the encoding of the text file. The default
encoding is UTF-8, see above for a <a class="link" href="rgs-squish.html#encodings-table">list</a> of possible encodings.
This operation will fail if the supplied path already exists (so this function will not overwrite existing files).
If the file already exists, the encoding is not supported or the file cannot be created an exception will be raised.
</p><p>
The following example shows how to use the createTextFile method. You will have to replace the path if you want to try the example.
</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"></img></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>Depending on your setup this test might alter files or folders on your local or remote system.</p></td></tr></table></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remoteOS = new RemoteSystem();
        test.verify(remoteOS.createTextFile("/some/path/to/a/textfile", "Content..."));
        test.verify(remoteOS.exists("/some/path/to/a/textfile"));
    } catch (e) {
        test.fail("RemoteSystem error", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

sub main {
    eval {
        my $remoteOS = Squish::RemoteSystem-&gt;new();
        test::verify($remoteOS-&gt;createTextFile("/some/path/to/a/textfile", "Content..."));
        test::verify($remoteOS-&gt;exists("/some/path/to/a/textfile"));
    } or do {
        test::fail("RemoteSystem error", $@);
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remoteOS = RemoteSystem()
        test.verify(remoteOS.createTextFile("/some/path/to/a/textfile", "Content..."))
        test.verify(remoteOS.exists("/some/path/to/a/textfile"))
    except Exception as e:
        test.fail("RemoteSystem error", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remoteOS = RemoteSystem.new()
    Test.verify(remoteOS.createTextFile("/some/path/to/a/textfile", "Content..."))
    Test.verify(remoteOS.exists("/some/path/to/a/textfile"))
  rescue Exception =&gt; e
    Test.fail("RemoteSystem error", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remoteOS [::Squish::RemoteSystem new]} result]} {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [$remoteOS createTextFile "/some/path/to/a/textfile" "Content..."] } result] } {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [$remoteOS exists "/some/path/to/a/textfile"] } result] } {
        test fail "RemoteSystem error" $result
    }
}
</pre></div><div class="funcsynopsis"><a id="RemoteSystem.upload-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">RemoteSystem.upload</b>(</code><var class="pdparam">localPath</var>, <var class="pdparam">remotePath</var><code>)</code>;</p></div><p>
The <code class="code">upload</code> method can be used to upload a file from the local system (i.e. the system the runner is running on)
to the remote system (i.e. the system the server is running on).
The <em class="parameter"><code>localPath</code></em> parameter is used to specify the path of the source file on the local system, while the
<em class="parameter"><code>remotePath</code></em> parameter is used to specify the path of the target location for the file on the remote system.
This operation will fail if the supplied remote path already exists (so this function will not overwrite existing files).
Additionally if the local path does not exist or the file is not transferred correctly an exception will be raised.
</p><p>
The following example shows how to use the upload method. You will have to replace the paths if you want to try the example.
</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"></img></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>Depending on your setup this test might alter files or folders on your local or remote system.</p></td></tr></table></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remoteOS = new RemoteSystem();
        test.verify(remoteOS.upload("/some/local/path", "/some/remote/path"));
        test.verify(remoteOS.exists("/some/remote/path"));
    } catch (e) {
        test.fail("RemoteSystem error", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

sub main {
    eval {
        my $remoteOS = Squish::RemoteSystem-&gt;new();
        test::verify($remoteOS-&gt;upload("/some/local/path", "/some/remote/path"));
        test::verify($remoteOS-&gt;exists("/some/remote/path"));
    } or do {
        test::fail("RemoteSystem error", $@);
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remoteOS = RemoteSystem()
        test.verify(remoteOS.upload("/some/local/path", "/some/remote/path"))
        test.verify(remoteOS.exists("/some/remote/path"))
    except Exception as e:
        test.fail("RemoteSystem error", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remoteOS = RemoteSystem.new()
    Test.verify(remoteOS.upload("/some/local/path", "/some/remote/path"))
    Test.verify(remoteOS.exists("/some/remote/path"))
  rescue Exception =&gt; e
    Test.fail("RemoteSystem error", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remoteOS [::Squish::RemoteSystem new]} result]} {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [$remoteOS upload "/some/local/path" "/some/remote/path"] } result] } {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [$remoteOS exists "/some/remote/path"] } result] } {
        test fail "RemoteSystem error" $result
    }
}
</pre></div><div class="funcsynopsis"><a id="RemoteSystem.download-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">RemoteSystem.download</b>(</code><var class="pdparam">remotePath</var>, <var class="pdparam">localPath</var><code>)</code>;</p></div><p>
The <code class="code">download</code> method can be used to download a file from the remote system (i.e. the system the server is running on)
to the local system (i.e. the system the runner is running on).
The <em class="parameter"><code>remotePath</code></em> parameter is used to specify the path of the source file on the remote system, while the
<em class="parameter"><code>localPath</code></em> parameter is used to specify the path of the target location for the file on the local system.
This operation will fail if the supplied local path already exists (so this function will not overwrite existing files).
Additionally if the remote path does not exist, the local file cannot be created or the file is not transferred correctly
an exception will be raised.
</p><p>
The following example shows how to use the download method. You will have to replace the paths if you want to try the example.
</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"></img></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>Depending on your setup this test might alter files or folders on your local or remote system.</p></td></tr></table></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remoteOS = new RemoteSystem();
        test.verify(remoteOS.download("/some/remote/path", "/some/local/path"));
    } catch (e) {
        test.fail("RemoteSystem error", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

sub main {
    eval {
        my $remoteOS = Squish::RemoteSystem-&gt;new();
        test::verify($remoteOS-&gt;download("/some/remote/path", "/some/local/path"));
    } or do {
        test::fail("RemoteSystem error", $@);
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remoteOS = RemoteSystem()
        test.verify(remoteOS.download("/some/remote/path", "/some/local/path"))
    except Exception as e:
        test.fail("RemoteSystem error", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remoteOS = RemoteSystem.new()
    Test.verify(remoteOS.download("/some/remote/path", "/some/local/path"))
  rescue Exception =&gt; e
    Test.fail("RemoteSystem error", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remoteOS [::Squish::RemoteSystem new]} result]} {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [$remoteOS download "/some/remote/path" "/some/local/path"] } result] } {
        test fail "RemoteSystem error" $result
    }
}
</pre></div><div class="funcsynopsis"><a id="RemoteSystem.copy-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">RemoteSystem.copy</b>(</code><var class="pdparam">sourcePath</var>, <var class="pdparam">destinationPath</var><code>)</code>;</p></div><p>
The <code class="function">copy</code> method can be used to copy files or folders inside the remote system.
The <em class="parameter"><code>sourcePath</code></em> parameter is used to specify the path of the source file or folder on the remote system, while the
<em class="parameter"><code>destinationPath</code></em> parameter is used to specify the path of the destination location for the file or folder on the remote system.
If you copy a single file the destination path can either be a file or folder. If you copy a folder the destination path has to be a folder,
otherwise an exception will be raised. This operation will fail if one of the files involved in a copy operation already exists in the
destination location (it will not overwrite existing files). Additionally if any of the files involved cannot be copied correctly
an exception will be raised.
</p><p>
The following example shows how to use the copy method. You will have to replace the paths if you want to try the example.
</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"></img></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>Depending on your setup this test might alter files or folders on your local or remote system.</p></td></tr></table></div><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
source(findFile('scripts', 'javascript/remotesystem.js'));

function main() {
    try {
        remoteOS = new RemoteSystem();
        test.verify(remoteOS.copy("/some/remote/path/a", "/some/remote/path/b"));
    } catch (e) {
        test.fail("RemoteSystem error", e.toString());
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
use warnings;
use strict;
use Squish::RemoteSystem;

sub main {
    eval {
        my $remoteOS = Squish::RemoteSystem-&gt;new();
        test::verify($remoteOS-&gt;copy("/some/remote/path/a", "/some/remote/path/b"));
    } or do {
        test::fail("RemoteSystem error", $@);
    };
}
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
# -*- coding: utf-8 -*-
from remotesystem import RemoteSystem

def main():
    try:
        remoteOS = RemoteSystem()
        test.verify(remoteOS.copy("/some/remote/path/a", "/some/remote/path/b"))
    except Exception as e:
        test.fail("RemoteSystem error", str(e))
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
# encoding: UTF-8
require 'squish'
require "squish/remotesystem"
include Squish

def main
  begin
    remoteOS = RemoteSystem.new()
    Test.verify(remoteOS.copy("/some/remote/path/a", "/some/remote/path/b"))
  rescue Exception =&gt; e
    Test.fail("RemoteSystem error", e.to_s)
  end
end
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
package require squish::remotesystem

proc main {} {
    if {[catch {set remoteOS [::Squish::RemoteSystem new]} result]} {
        test fail "RemoteSystem error" $result
    }

    if { [catch { test verify [$remoteOS copy "/some/remote/path/a" "/some/remote/path/b"] } result] } {
        test fail "RemoteSystem error" $result
    }
}
</pre></div><div class="funcsynopsis"><a id="RemoteSystem.close-function"></a><p><code class="funcdef">Boolean <b class="fsfunc">RemoteSystem.close</b>(</code><code>)</code>;</p></div><p>
The <code class="function">close</code> method can be used to close the connection
from an instance of <code class="classname">RemoteSystem</code> to the <span class="application">squishserver</span>.
Use this if you wish to stop using an instance and explicitly clean up its
resources.
</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rg-user.interface.types"></a>6.3.21. User Interface Types</h3></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="rgs-squish.html#rg-datetime.type">6.3.21.1. DateTime Type</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-screenpoint-object">6.3.21.2. <code class="code">UiTypes.ScreenPoint</code> Class</a></span></dt><dt><span class="section"><a href="rgs-squish.html#rgss-screenrectangle-object">6.3.21.3. <code class="code">UiTypes.ScreenRectangle</code> Class</a></span></dt></dl></div><p>
<span class="emphasis"><em>Squish</em></span> provides the <code class="code">UiTypes</code> namespace (in languages where
namespaces make sense) through which items of generic types can be
created.
</p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="rg-datetime.type"></a>6.3.21.1. DateTime Type</h4></div></div></div><p>
The <code class="code">UiTypes.DateTime</code> type (plain <code class="code">DateTime</code> in
Tcl) is capable of holding a date and time value.
</p><div class="funcsynopsis"><a id="UiTypes.DateTime-function"></a><p><code class="funcdef">DateTime <b class="fsfunc">UiTypes.DateTime</b>(</code><var class="pdparam"></var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">DateTime <b class="fsfunc">UiTypes.DateTime</b>(</code><var class="pdparam">year</var>, <var class="pdparam">month</var>, <var class="pdparam">dayOfMonth</var><code>)</code>;</p></div><div class="funcsynopsis"><p><code class="funcdef">DateTime <b class="fsfunc">UiTypes.DateTime</b>(</code><var class="pdparam">year</var>, <var class="pdparam">month</var>, <var class="pdparam">dayOfMonth</var>, <var class="pdparam">hour</var>, <var class="pdparam">minute</var>, <var class="pdparam">second</var><code>)</code>;</p></div><p>
This construction function creates a <code class="code">DateTime</code> object. If no
arguments are given all the values are set to -1 (i.e., the
<code class="code">DateTime</code> is invalid). Here is how to create a valid
<code class="code">DateTime</code>:
</p><div xmlns="" class="scriptlang"><form><select name="scriptlangcombo" onchange="javascript:changeScriptingLanguage(this)" onclick="javascript:changeScriptingLanguage(this)"><option value="all" selected>Show All</option><option value="JavaScript">Show JavaScript</option><option value="Perl">Show Perl</option><option value="Python">Show Python</option><option value="Ruby">Show Ruby</option><option value="Tcl">Show Tcl</option></select></form></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Python</span><pre class="programlisting">
moonLanding = UiTypes.DateTime(1969, 7, 20)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">JavaScript</span><pre class="programlisting">
var moonLanding = new UiTypes.DateTime(1969, 7, 20);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Perl</span><pre class="programlisting">
my $moonLanding = UiTypes::DateTime-&gt;new(1969, 7, 20);
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Ruby</span><pre class="programlisting">
moonLanding = UiTypes::DateTime.new(1969, 7, 20)
</pre></div><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
set moonLanding [construct DateTime 1969 7 20]
</pre></div><p>
The <span class="emphasis"><em>Squish</em></span> <code class="code">UiTypes</code> namespace is inside the
<code class="code">Squish</code> namespace that is automatically imported into test
scripts—except for Ruby where the script file should begin with a
<code class="code">require 'squish'</code> statement.
</p><p>
<code class="code">DateTime</code> objects have the following properties:
</p><a id="UiTypes.DateTime.year-property"></a>int
<span class="property">UiTypes.DateTime.year</span><p>
This read/write property holds the date/time's year.
</p><a id="UiTypes.DateTime.month-property"></a>int
<span class="property">UiTypes.DateTime.month</span><p>
This read/write property holds the date/time's month (1-12).
</p><a id="UiTypes.DateTime.day-property"></a>int
<span class="property">UiTypes.DateTime.day</span><p>
This read/write property holds the date/time's day of the month (1-31).
</p><a id="UiTypes.DateTime.hour-property"></a>int
<span class="property">UiTypes.DateTime.hour</span><p>
This read/write property holds the date/time's hour (0-23).
</p><a id="UiTypes.DateTime.minute-property"></a>int
<span class="property">UiTypes.DateTime.minute</span><p>
This read/write property holds the date/time's minutes (0-59).
</p><a id="UiTypes.DateTime.second-property"></a>int
<span class="property">UiTypes.DateTime.second</span><p>
This read/write property holds the date/time's seconds (0-59).
</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="rgss-screenpoint-object"></a>6.3.21.2. <code class="code">UiTypes.ScreenPoint</code> Class</h4></div></div></div><p>
A point element representing a position on screen. Objects of this type
have the following properties:
</p><a id="ScreenPoint.x-property"></a>
<span class="property">x</span><p>
Read/write property that specifies the horizontal coordinate of this point.
</p><a id="ScreenPoint.y-property"></a>
<span class="property">y</span><p>
Read/write property that specifies the vertical coordinate of this point.
</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="rgss-screenrectangle-object"></a>6.3.21.3. <code class="code">UiTypes.ScreenRectangle</code> Class</h4></div></div></div><p>
A rectangle element with screen position and size properties. Objects of this
type have the following properties:
</p><a id="ScreenRectangle.x-property"></a>
<span class="property">x</span><a id="ScreenRectangle.y-property"></a>
<span class="property">y</span><a id="ScreenRectangle.width-property"></a>
<span class="property">width</span><a id="ScreenRectangle.height-property"></a>
<span class="property">height</span><p>
</p><div class="funcsynopsis"><a id="ScreenRectangle.center-function"></a><p><code class="funcdef">ScreenPoint <b class="fsfunc">center</b>(</code><code>)</code>;</p></div><p>
Returns the center of the rectangle object as a <code class="code">ScreenPoint</code>
object.
</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-misc"></a>6.3.22. Miscellaneous Functions</h3></div></div></div><div class="funcsynopsis"><a id="findFile-function"></a><p><code class="funcdef">String <b class="fsfunc">findFile</b>(</code><var class="pdparam">where</var>, <var class="pdparam">filename</var><code>)</code>;</p></div><p>
This function returns the path of the given
<em class="parameter"><code>filename</code></em> or raises a <code class="code">LookupError</code>
exception if the file cannot be found.
</p><p>
If the <em class="parameter"><code>where</code></em> parameter is <code class="code">"scripts"</code>,
<code class="code">findFile</code> looks for the <em class="parameter"><code>filename</code></em> in
the test case's <code class="filename">scripts</code> directory. If that doesn't
contain the file the function next tries the test suite's
<code class="filename">shared/scripts</code> directory. If that doesn't contain
the file the function tries the paths in the
<code class="filename">paths.ini</code> file (see <a class="xref" href="rg-ini-files.html" title="7.6. Squish Initialization Files"><span class="emphasis"><em>Squish</em></span> Initialization Files (Section 7.6)</a>), and if it still isn't found, the function
tries all of the directories listed in the
<code class="envar">SQUISH_SCRIPT_DIR</code> environment variable (if it is
defined—see <a class="xref" href="rg-envvars.html" title="7.5. Environment Variables">Environment Variables (Section 7.5)</a>). As soon as the file is
found, the filename's path is returned; otherwise a catchable
<code class="code">LookupError</code> exception is raised.
</p><p>
If the <em class="parameter"><code>where</code></em> parameter is <code class="code">"testdata"</code>,
<code class="code">findFile</code> looks for the <em class="parameter"><code>filename</code></em> in
the test case's <code class="filename">testdata</code> directory. If that doesn't
contain the file the function next tries the test suite's
<code class="filename">shared/testdata</code> directory, and failing that the
function tries the test case's directory. As soon as the file
is found the filename with full path is returned; otherwise a catchable
<code class="code">LookupError</code> exception is raised.
</p><p>
(See also, the <a class="xref" href="rgs-squish.html#source-function"><code class="function">source</code></a> function and the <a class="xref" href="rgs-squish.html#rgss-testdata" title="6.3.10. Test Data Functions">Test Data Functions (Section 6.3.10)</a>.)
</p><div class="funcsynopsis"><a id="snooze-function"></a><p><code class="funcdef"><b class="fsfunc">snooze</b>(</code><var class="pdparam">seconds</var><code>)</code>;</p></div><p>
This function tells <span class="emphasis"><em>Squish</em></span> to sleep for the specified nominal number
of seconds. The <em class="parameter"><code>seconds</code></em> argument can be a whole
number or a floating-point number. The actual sleep time will depend on
the current <code class="code">snoozeFactor</code>. Unless you really do need to
force <span class="emphasis"><em>Squish</em></span> to sleep, it is usually more robust to use the <a class="xref" href="rgs-squish.html#waitForObject-function"><code class="function">waitForObject</code></a> function than to use
<code class="code">snooze</code>.
</p><p>
The <code class="code">snoozeFactor</code> can be set using the <span class="application">Squish IDE</span>. Click
<span class="guimenu">Window</span>|<span class="guimenuitem">Preferences</span> to invoke the <a class="xref" href="ide.dialogs.html#ide.preferences.dialog" title="8.3.17. Pref­er­ences dialog">Pref­er­ences dialog (Section 8.3.17)</a>, then click the
<span class="guilabel">Squish</span> item, and then the
<span class="guilabel">Playback</span> item and then set the <span class="guilabel">Snooze
Factor</span> value. The <code class="code">snoozeFactor</code> can also be set
by using <span class="application">squishrunner</span>'s command line options; see <a class="xref" href="rg-cmdline.html#rg-squishrunner-cli--testsuite--record" title="7.4.3.21. squishrunner --record: Recording a Test Case"><code class="option">squishrunner --record</code>: Recording a Test Case (Section 7.4.3.21)</a> and <a class="xref" href="rg-cmdline.html#rg-squishrunner-cli--testcase" title="7.4.3.25. Executing a Test Case (Advanced)">Executing a Test Case (Advanced) (Section 7.4.3.25)</a>.
</p><div class="funcsynopsis"><a id="source-function"></a><p><code class="funcdef"><b class="fsfunc">source</b>(</code><var class="pdparam">filename</var><code>)</code>;</p></div><p>
Reads and evaluates the contents of <em class="parameter"><code>filename</code></em>,
line-by-line. Unlike the scripting language's normal “<span class="quote">import</span>” mechanism,
(such as Python's <code class="code">import</code> or Perl's <code class="code">use</code>), this is more
like the C++ <code class="literal">#include</code> directive in that the statements are inserted
into your script at that location. This is one way to parse your own shared script files
rather than using the scripting language's import mechanism, which may require customization
to your environment for it to locate your own modules.
</p><p>
A common use case is to write something like
<code class="code">source(findFile("scripts", "common.js"))</code>. This uses the
<a class="xref" href="rgs-squish.html#findFile-function"><code class="function">findFile</code></a> function to produce a filename
including a path and then evaluates that file's contents as a script.
This typically results in additional functions (and even new classes and
variables) becoming available to the test script that performs this
call.
</p><p>
For Ruby, use the built-in <code class="code">require</code> method
instead—inside a function or method. For example,
<code class="code">require findFile("scripts", "common.rb"))</code>.
</p><p>
(See also, <a class="xref" href="ug-shareddata.html" title="5.23. How to Create and Use Shared Data and Shared Scripts">How to Create and Use Shared Data and Shared Scripts (Section 5.23)</a>, and the <a class="xref" href="ide.dialogs.html#ide.import.squish.resource.dialog" title="8.3.7. Import Squish Resource dialog">Import Squish Resource dialog (Section 8.3.7)</a> and the <a class="xref" href="ide.dialogs.html#ide.new.squish.test.script.dialog" title="8.3.12. New Squish Test Script dialog">New Squish Test Script dialog (Section 8.3.12)</a>.)
</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rgss-misc-low-level"></a>6.3.23. Low-Level Functions</h3></div></div></div><div class="funcsynopsis"><a id="nativeMouseClick-function"></a><p><code class="funcdef"><b class="fsfunc">nativeMouseClick</b>(</code><var class="pdparam">x</var>, <var class="pdparam">y</var>, <var class="pdparam">button</var><code>)</code>;</p></div><p>
This function simulates a native mouse click on the currently active
window. The <em class="parameter"><code>x</code></em> and <em class="parameter"><code>y</code></em>
parameters are the coordinates where the mouse click must take place in
screen coordinates. The <em class="parameter"><code>button</code></em> parameter is the
mouse button that should be used, and must be one of
<code class="constant">MouseButton.LeftButton</code>,
<code class="constant">MouseButton.MiddleButton</code> or
<code class="constant">MouseButton.RightButton</code>.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Small caveat"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Small caveat</th></tr><tr><td align="left" valign="top"><p>
In theory it is possible for a call to the <code class="code">nativeMouseClick</code>
function to go astray. For example, if a window or control unexpectedly
pops up over the window at which the mouse click was intended, the mouse
click will go to the newly active window or control rather than to the
intended one. In practice this is a very rare occurrence.
</p></td></tr></table></div><div class="funcsynopsis"><a id="nativeType-function"></a><p><code class="funcdef"><b class="fsfunc">nativeType</b>(</code><var class="pdparam">keys</var><code>)</code>;</p></div><p>
This function simulates user keyboard input using the operating system's
facilities, sending keypresses to the currently active window, i.e., to
the window with keyboard focus. On Windows, this can be used to interact
with native Windows message boxes, for example. The keyboard input will
be sent to whatever widget has the keyboard focus. The input is
case-sensitive, so <code class="code">nativeType("R")</code> is different from
<code class="code">nativeType("r")</code>.
</p><p>
This function can also simulate the input of special keys by using their
names and enclosing them in angle brackets (&lt;&gt;), and can simulate
combinations of keys by separating each key name with a <code class="code">+</code>.
Here are some examples:
</p><pre class="programlisting">
nativeType("Hello");
nativeType("&lt;Return&gt;");
nativeType("&lt;Alt+F4&gt;");
nativeType("&lt;Alt+Tab&gt;");
nativeType("&lt;Ctrl+c&gt;");
</pre><p>
This is valid in JavaScript, Perl, Python, and Ruby.
</p><div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="programlistingcontainer"><span class="programlistinglanguage">Tcl</span><pre class="programlisting">
invoke nativeType "Hello"
invoke nativeType "&lt;Return&gt;"
invoke nativeType "&lt;Alt+F4&gt;"
invoke nativeType "&lt;Alt+Tab&gt;"
invoke nativeType "&lt;Ctrl+c&gt;"
</pre></div><p>
The
<code class="code">nativeType</code> function can accept all the normal
alphanumeric characters (which are written literally), as well as the
following special keys (which must be enclosed in angle brackets):
<code class="code">&lt;Alt&gt;</code>,
<code class="code">&lt;Ctrl&gt;</code>,
<code class="code">&lt;Shift&gt;</code>,
<code class="code">&lt;Escape&gt;</code>,
<code class="code">&lt;Return&gt;</code>,
<code class="code">&lt;Space&gt;</code>,
<code class="code">&lt;Backspace&gt;</code>,
<code class="code">&lt;Tab&gt;</code>,
<code class="code">&lt;Pause&gt;</code>,
<code class="code">&lt;PageUp&gt;</code>,
<code class="code">&lt;PageDown&gt;</code>,
<code class="code">&lt;Home&gt;</code>,
<code class="code">&lt;End&gt;</code>,
<code class="code">&lt;Left&gt;</code>,
<code class="code">&lt;Right&gt;</code>,
<code class="code">&lt;Up&gt;</code>,
<code class="code">&lt;Down&gt;</code>,
<code class="code">&lt;Insert&gt;</code>,
<code class="code">&lt;Delete&gt;</code>,
<code class="code">&lt;Print&gt;</code>,
<code class="code">&lt;NumPad0&gt;</code>,
<code class="code">&lt;NumPad1&gt;</code>,
<code class="code">&lt;NumPad2&gt;</code>,
<code class="code">&lt;NumPad3&gt;</code>,
<code class="code">&lt;NumPad4&gt;</code>,
<code class="code">&lt;NumPad5&gt;</code>,
<code class="code">&lt;NumPad6&gt;</code>,
<code class="code">&lt;NumPad7&gt;</code>,
<code class="code">&lt;NumPad8&gt;</code>,
<code class="code">&lt;NumPad9&gt;</code>,
<code class="code">&lt;NumPadMultiply&gt;</code>,
<code class="code">&lt;NumPadAdd&gt;</code>,
<code class="code">&lt;NumPadSubtract&gt;</code>,
<code class="code">&lt;NumPadDivide&gt;</code>,
<code class="code">&lt;NumPadDecimal&gt;</code>,
<code class="code">&lt;MenuLeft&gt;</code>,
<code class="code">&lt;MenuRight&gt;</code>,
<code class="code">&lt;Win&gt;</code>,
<code class="code">&lt;WinLeft&gt;</code>,
<code class="code">&lt;WinRight&gt;</code>,
<code class="code">&lt;F1&gt;</code>,
<code class="code">&lt;F2&gt;</code>,
<code class="code">&lt;F3&gt;</code>,
<code class="code">&lt;F4&gt;</code>,
<code class="code">&lt;F5&gt;</code>,
<code class="code">&lt;F6&gt;</code>,
<code class="code">&lt;F7&gt;</code>,
<code class="code">&lt;F8&gt;</code>,
<code class="code">&lt;F9&gt;</code>,
<code class="code">&lt;F10&gt;</code>,
<code class="code">&lt;F11&gt;</code>,
<code class="code">&lt;F12&gt;</code>,
<code class="code">&lt;F13&gt;</code>,
<code class="code">&lt;F14&gt;</code>,
<code class="code">&lt;F15&gt;</code>,
<code class="code">&lt;F16&gt;</code>,
<code class="code">&lt;F17&gt;</code>,
<code class="code">&lt;F18&gt;</code>,
<code class="code">&lt;F19&gt;</code>,
<code class="code">&lt;F20&gt;</code>,
<code class="code">&lt;F21&gt;</code>,
<code class="code">&lt;F22&gt;</code>,
<code class="code">&lt;F23&gt;</code>,
<code class="code">&lt;F24&gt;</code>,
<code class="code">&lt;NumLock&gt;</code>,
<code class="code">&lt;ScrollLock&gt;</code>,
<code class="code">&lt;CapsLock&gt;</code>
and
<code class="code">&lt;Command&gt;</code> (macOS only)
.
</p><p>
It is usually better to use one of the toolkit-specific <a class="xref" href="rgs-qtconvenience.html#qt-type-function"><code class="function">type</code></a> functions.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Small caveat"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left">Small caveat</th></tr><tr><td align="left" valign="top"><p>
In theory it is possible for keypresses entered with the
<code class="code">nativeType</code> function to go astray. For example, if a
window unexpectedly pops up over the AUT, the keypresses will go to the
newly active window rather than to the intended one. In practice this is
a very rare occurrence.
</p></td></tr></table></div><div class="funcsynopsis"><a id="sendNativeEvent-function"></a><p><code class="funcdef"><b class="fsfunc">sendNativeEvent</b>(</code><var class="pdparam">windowName</var>, <var class="pdparam">sequence</var><code>)</code>;</p></div><p>
This function sends a <em class="parameter"><code>sequence</code></em> of low-level
native events to the window called <em class="parameter"><code>windowName</code></em>.
This function may be useful when interacting with windows from another
application or with widgets implemented with a foreign toolkit. For
interaction with standard application widgets it is best to use
the functions in <span class="emphasis"><em>Squish</em></span>'s API such as the <a class="xref" href="rgs-qtconvenience.html#qt-type-function"><code class="function">type</code></a> function.
</p><p>
Here's an example of use that is legal in JavaScript, Python, Perl, and
Ruby:
</p><pre class="programlisting">
sendNativeEvent("Login", "username");
</pre><p>
At present, the only supported types of event are simple keystrokes.
Support for complex keystrokes and for mouse events might be added in a
future version. Please contact technical support if this is an important
requirement for you.
</p></div></div><script xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" type="text/javascript" src="ScriptingLanguage.js"></script><script xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format">setScriptingLanguage();</script><div class="navfooter"><hr></hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="rgs-scripteq.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="api.man.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="rgs-qtconvenience.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">6.2. Equivalent Script API </td><td width="20%" align="center"><a accesskey="h" href="index-noframes.html">Home</a></td><td width="40%" align="right" valign="top"> 6.4. Qt Convenience API</td></tr></table></div></body>
<!-- Mirrored from rgs-squish.html by HTTrack Website Copier/3.x [XR&CO'2013], Wed, 06 Jul 2022 13:29:00 GMT -->
</html>
